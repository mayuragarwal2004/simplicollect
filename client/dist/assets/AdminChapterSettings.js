import{f,r,c as j,Q as o,j as e,B as m}from"./index.js";import{B as E}from"./Breadcrumb.js";import{I}from"./input.js";import{S as h,a as p,b as u,c as d,d as y}from"./select.js";import{S as V}from"./switch.js";import"./chevron-right.js";import"./index10.js";import"./index4.js";import"./index11.js";import"./index9.js";import"./index5.js";import"./index7.js";import"./index8.js";import"./index12.js";import"./chevron-down.js";const A=["weekly","fortnightly","monthly","bi-monthly","quarterly","6-monthly","yearly"],L=["weekly","monthly","quarterly"],O=["Lumpsum","Percentage"],B=["per-payment","per-member"],$=()=>{const{chapterSlug:i}=f(),[l,C]=r.useState(null),[k,x]=r.useState(null),[s,g]=r.useState({}),[w,F]=r.useState(!1),[S,v]=r.useState(!1);r.useEffect(()=>{i&&P()},[i]);const P=async()=>{try{const t=await j.get(`/api/admin/chapters/slug/${i}`);C(t.data),g(t.data)}catch{o.error("Failed to fetch chapter details")}},T=t=>x(t),b=()=>{g(l),x(null)},n=(t,c)=>g(a=>({...a,[t]:c})),N=async t=>{F(!0);try{const c=await j.put(`/api/chapter/${l.chapterId}`,{[t]:s[t]});C(a=>({...a,[t]:s[t]})),x(null),o.success("Chapter updated")}catch{o.error("Failed to update chapter")}finally{F(!1)}},M=async()=>{if(window.confirm("Are you sure you want to flush all transactions for this chapter? This cannot be undone.")){v(!0);try{await j.delete(`/api/admin/chapters/${l.chapterId}/flush-transactions`),o.success("All transactions flushed for this chapter.")}catch{o.error("Failed to flush transactions")}finally{v(!1)}}};return l?e.jsxs("div",{className:"space-y-6 max-w-2xl mx-auto p-4",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Chapter Settings"}),Object.entries({chapterName:"Chapter Name",chapterSlug:"Slug",meetingPeriodicity:"Meeting Periodicity",meetingPaymentType:"Meeting Payment Type",meetingDay:"Meeting Day",visitorPerMeetingFee:"Visitor Fee",weeklyFee:"Weekly Fee",monthlyFee:"Monthly Fee",quarterlyFee:"Quarterly Fee",platformFee:"Platform Fee",platformFeeType:"Platform Fee Type",platformFeeCase:"Platform Fee Case",testMode:"Test Mode",country:"Country",state:"State",city:"City"}).map(([t,c])=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-48 font-medium",children:c}),k===t?e.jsxs(e.Fragment,{children:[t==="meetingPeriodicity"?e.jsxs(h,{value:s[t],onValueChange:a=>n(t,a),children:[e.jsx(p,{children:e.jsx(u,{})}),e.jsx(d,{children:A.map(a=>e.jsx(y,{value:a,children:a},a))})]}):t==="meetingPaymentType"?e.jsxs(h,{value:s[t],onValueChange:a=>n(t,a),children:[e.jsx(p,{children:e.jsx(u,{})}),e.jsx(d,{children:L.map(a=>e.jsx(y,{value:a,children:a},a))})]}):t==="platformFeeType"?e.jsxs(h,{value:s[t],onValueChange:a=>n(t,a),children:[e.jsx(p,{children:e.jsx(u,{})}),e.jsx(d,{children:O.map(a=>e.jsx(y,{value:a,children:a},a))})]}):t==="platformFeeCase"?e.jsxs(h,{value:s[t],onValueChange:a=>n(t,a),children:[e.jsx(p,{children:e.jsx(u,{})}),e.jsx(d,{children:B.map(a=>e.jsx(y,{value:a,children:a},a))})]}):t==="testMode"?e.jsx(V,{checked:!!s[t],onCheckedChange:a=>n(t,a)}):e.jsx(I,{value:s[t]??"",onChange:a=>n(t,a.target.value)}),e.jsx(m,{size:"sm",className:"ml-2",onClick:()=>N(t),disabled:w,children:"Save"}),e.jsx(m,{size:"sm",variant:"outline",className:"ml-2",onClick:b,children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"flex-1",children:String(l[t]??"")}),e.jsx(m,{size:"sm",variant:"outline",onClick:()=>T(t),children:"Edit"})]})]},t)),e.jsx("div",{className:"mt-8",children:e.jsx(m,{variant:"destructive",onClick:M,disabled:S,children:S?"Flushing...":"Flush All Transactions"})})]}):e.jsx("div",{children:"Loading..."})},ee=()=>{const{chapterSlug:i}=f();return e.jsxs(e.Fragment,{children:[e.jsx(E,{items:[{name:"Dashboard",link:"/admin"},{name:"Chapter ",link:"/admin/chapters"},{name:"Chapter Settings",link:`/admin/chapters/${i}/settings`}]}),e.jsx($,{})]})};export{ee as default};
