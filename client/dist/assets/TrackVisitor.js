import{d as b,r as n,f as U,j as e,n as z,t as Z,v as G,w as f,B as d,c as x,Q as h}from"./index.js";import{T as J,a as K,b as u,c as p}from"./tabs2.js";import{I as r}from"./input.js";import{L as a}from"./label.js";import{T as j}from"./textarea.js";import{M as O}from"./mail.js";import"./index4.js";import"./index11.js";import"./index9.js";import"./index6.js";/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M13 8H7",key:"14i4kc"}],["path",{d:"M17 12H7",key:"16if0g"}]],Y=b("MessageSquareText",X);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]],se=b("PhoneCall",ee);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]],te=b("StickyNote",ae),ue=()=>{const[t,w]=n.useState({}),[o,N]=n.useState(!1),[v,g]=n.useState([]),c=U().visitorId,[E,B]=n.useState(""),[k,V]=n.useState(""),[H,L]=n.useState(""),[S,W]=n.useState(""),[I,_]=n.useState(""),[T,P]=n.useState(""),[$,C]=n.useState(null),[F,M]=n.useState("");n.useEffect(()=>{const s=async()=>{try{const i=await x.get(`/api/visitor/${c}`);if(!i.data)throw new Error("Failed to fetch visitor data");w(i.data)}catch{h.error("Error fetching visitor")}},l=async()=>{try{const i=await x.get(`/api/visitor-history/getHistory/${c}`);g(i.data)}catch{h.error("Error fetching history")}};c&&(s(),l())},[c]);const m=s=>{w({...t,[s.target.name]:s.target.value})},y=async(s,l)=>{try{if(!(await x.post(`/api/visitor-history/addHistory/${c}`,{type:s,...l})).data)throw new Error("Failed to save history");h.success(`${s} history saved`);const Q=await x.get(`/api/visitor-history/getHistory/${c}`);g(Q.data)}catch(i){h.error(`Error saving ${s}: ${i.message}`)}},q=async s=>{try{await x.delete(`/api/visitor-history/deleteHistory/${c}/${s}`),h.success("History deleted");const l=await x.get(`/api/visitor-history/getHistory/${c}`);g(l.data)}catch(l){h.error(`Error deleting history: ${l.message}`)}},R=async(s,l)=>{try{await x.put(`/api/visitor-history/updateHistory/${c}/${s}`,l),h.success("History updated");const i=await x.get(`/api/visitor-history/getHistory/${c}`);g(i.data)}catch(i){h.error(`Error updating history: ${i.message}`)}},D=async()=>{try{if(!(await x.put(`/api/visitor/updateVisitor/${c}`,t)).data)throw new Error("Failed to save visitor data");N(!1),h.success("Visitor updated")}catch{h.error("Error saving visitor")}},A=s=>{switch(s){case"call":return e.jsx(se,{className:"text-blue-500"});case"email":return e.jsx(O,{className:"text-red-500"});case"whatsapp":return e.jsx(Y,{className:"text-green-500"});case"note":return e.jsx(te,{className:"text-yellow-500"});default:return null}};return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4",children:[e.jsxs(z,{className:"w-full",children:[e.jsx(Z,{children:e.jsx(G,{children:"Visitor Information"})}),e.jsx(f,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"firstName",children:"First Name"}),e.jsx(r,{name:"firstName",value:t.firstName||"",onChange:m,disabled:!o})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"lastName",children:"Last Name"}),e.jsx(r,{name:"lastName",value:t.lastName||"",onChange:m,disabled:!o})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"email",children:"Email"}),e.jsx(r,{name:"email",value:t.email||"",onChange:m,disabled:!o})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"mobileNumber",children:"Phone"}),e.jsx(r,{name:"mobileNumber",value:t.mobileNumber||"",onChange:m,disabled:!o})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"invitedBy",children:"Invited By"}),e.jsx(r,{name:"invitedBy",value:t.invitedBy||"",onChange:m,disabled:!o})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"companyName",children:"Company Name"}),e.jsx(r,{name:"companyName",value:t.companyName||"",onChange:m,disabled:!o})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(a,{htmlFor:"classification",children:"Classification"}),e.jsx(r,{name:"classification",value:t.classification||"",onChange:m,disabled:!o})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"industry",children:"Industry"}),e.jsx(r,{name:"industry",value:t.industry||"",onChange:m,disabled:!o})]})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"heardAboutBni",children:"Heard About BNI"}),e.jsx(r,{name:"heardAboutBni",value:t.heardAboutBni||"",onChange:m,disabled:!o})]})]})}),e.jsx(f,{children:e.jsxs("div",{className:"space-y-4",children:[!o&&e.jsx(d,{className:"mt-4",variant:"outline",onClick:()=>N(!0),children:"Edit"}),o&&e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(d,{onClick:D,children:"Save"}),e.jsx(d,{variant:"outline",onClick:()=>N(!1),children:"Cancel"})]})]})})]}),e.jsx(z,{className:"w-full",children:e.jsx(f,{className:"mt-10",children:e.jsxs(J,{defaultValue:"history",className:"w-full",children:[e.jsxs(K,{className:"grid w-full grid-cols-5 mb-4",children:[e.jsx(u,{value:"call",children:"Call"}),e.jsx(u,{value:"note",children:"Note"}),e.jsx(u,{value:"email",children:"Email"}),e.jsx(u,{value:"whatsapp",children:"WhatsApp"}),e.jsx(u,{value:"history",children:"History"})]}),e.jsxs(p,{value:"call",children:[e.jsx(a,{children:"Phone Number"}),e.jsx(r,{value:t.mobileNumber||"",disabled:!0}),e.jsx(a,{className:"mt-2",children:"Remark"}),e.jsx(j,{placeholder:"Enter call remarks...",value:E,onChange:s=>B(s.target.value)}),e.jsx(d,{className:"mt-2",onClick:()=>y("call",{to:t.mobileNumber,content:E}),children:"Save Call Log"})]}),e.jsxs(p,{value:"note",children:[e.jsx(a,{children:"Note"}),e.jsx(j,{placeholder:"Enter note...",value:k,onChange:s=>V(s.target.value)}),e.jsx(d,{className:"mt-2",onClick:()=>y("note",{content:k}),children:"Save"})]}),e.jsxs(p,{value:"email",children:[e.jsx(a,{children:"Email"}),e.jsx(r,{value:t.email||"",disabled:!0}),e.jsx(a,{className:"mt-2",children:"Title"}),e.jsx(r,{placeholder:"Enter email title",value:H,onChange:s=>L(s.target.value)}),e.jsx(a,{className:"mt-2",children:"Subject"}),e.jsx(j,{placeholder:"Enter email subject or message...",value:S,onChange:s=>W(s.target.value)}),e.jsx(d,{className:"mt-2",onClick:()=>y("email",{to:t.email,title:H,content:S}),children:"Send Email"})]}),e.jsxs(p,{value:"whatsapp",children:[e.jsx(a,{children:"WhatsApp Number"}),e.jsx(r,{value:t.mobileNumber||"",disabled:!0}),e.jsx(a,{className:"mt-2",children:"Title"}),e.jsx(r,{placeholder:"Enter WhatsApp title",value:I,onChange:s=>_(s.target.value)}),e.jsx(a,{className:"mt-2",children:"Content"}),e.jsx(j,{placeholder:"Enter WhatsApp message content...",value:T,onChange:s=>P(s.target.value)}),e.jsx(d,{className:"mt-2",onClick:()=>y("whatsapp",{to:t.mobileNumber,title:I,content:T}),children:"Send WhatsApp"})]}),e.jsxs(p,{value:"history",children:[e.jsx("div",{className:"flex gap-4 justify-center mb-6",children:v&&v.map((s,l)=>e.jsx("div",{children:A(s.type)},l))}),e.jsx("div",{className:"space-y-6",children:v&&v.map((s,l)=>e.jsxs("div",{className:"flex flex-col gap-2 border p-2 rounded",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"pt-1",children:A(s.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium capitalize",children:s.type}),e.jsx("p",{className:"text-muted-foreground text-xs",children:s.createdAt}),$===s.historyId?e.jsx(j,{className:"mt-1",value:F,onChange:i=>M(i.target.value)}):e.jsx("p",{className:"mt-1",children:s.content||s.title})]})]}),e.jsx("div",{className:"flex gap-2 mt-2 ml-8",children:$===s.historyId?e.jsxs(e.Fragment,{children:[e.jsx(d,{size:"sm",onClick:()=>{R(s.historyId,{content:F}),C(null)},children:"Save"}),e.jsx(d,{size:"sm",variant:"outline",onClick:()=>C(null),children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{size:"sm",onClick:()=>{C(s.historyId),M(s.content||s.title)},children:"Update"}),e.jsx(d,{size:"sm",variant:"destructive",onClick:()=>q(s.historyId),children:"Delete"})]})})]},l))})]})]})})})]})};export{ue as default};
