import{j as e,B as t,u as ue,a as Z,r,c as f,Q as c}from"./index-6elQxnHd.js";import{u as pe,a as ge,b as xe,f as X,c as fe}from"./usePagination-BYw1nb5N.js";import{T as be,a as Ne,b as q,c as je,d as Ce,e as Y}from"./table-CMz5QLeZ.js";import{D as we,C as ye,a as ve,b as Pe}from"./react-icons.esm-BfHCtAcr.js";import{S as Se,a as De,b as Ie,c as Me,d as ke}from"./select-BctcFQZm.js";import{I as d}from"./input-Dp_r379b.js";import{A as Ae,a as Ee,b as Fe,c as Oe,d as Te}from"./alert-dialog-BqU3jmle.js";import{D as H,f as Re,a as B,b as L,c as $,d as z}from"./dialog-CT_lOUQb.js";import{S as qe}from"./search-bar-nO3JWK1C.js";import{B as He}from"./Breadcrumb-ME0YvNli.js";import"./index-BdQq_4o_.js";import"./index-BGKEPXry.js";import"./index-CWa4kTbH.js";import"./index-BvgCK6ys.js";import"./index-BLdKwkXj.js";import"./index-BXCPHgg9.js";import"./index-BIhwVmuG.js";import"./index-DSJunp_n.js";import"./chevron-down-BUZeX_Bt.js";import"./index-CgP8r1n9.js";import"./index-CE4AQY6s.js";import"./search-C_1baVLY.js";import"./chevron-right-DA45-pzU.js";function Be({table:a,totalRecord:x}){return e.jsxs("div",{className:"flex flex-col items-center justify-between space-y-4 px-2 lg:flex-row lg:space-y-0",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-2 sm:flex-row sm:space-x-6 sm:space-y-0",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[a.getFilteredRowModel().rows.length," row(s)."]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Rows per page"}),e.jsxs(Se,{value:`${a.getState().pagination.pageSize}`,onValueChange:h=>{a.setPageSize(Number(h))},children:[e.jsx(De,{className:"h-8 w-[70px]",children:e.jsx(Ie,{placeholder:a.getState().pagination.pageSize})}),e.jsx(Me,{side:"top",children:[5,10,20,30,40,50].map(h=>e.jsx(ke,{value:`${h}`,children:h},h))})]})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Total Record: ",x]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center justify-center text-sm font-medium",children:["Page ",a.getState().pagination.pageIndex+1," of ",a.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(t,{variant:"outline",className:"h-8 w-8 p-0",disabled:!a.getCanPreviousPage(),onClick:()=>a.setPageIndex(0),children:[e.jsx("span",{className:"sr-only",children:"Go to first page"}),e.jsx(we,{className:"h-4 w-4"})]}),e.jsxs(t,{variant:"outline",className:"h-8 w-8 p-0",disabled:!a.getCanPreviousPage(),onClick:a.previousPage,children:[e.jsx("span",{className:"sr-only",children:"Go to previous page"}),e.jsx(ye,{className:"h-4 w-4"})]}),e.jsxs(t,{variant:"outline",className:"h-8 w-8 p-0",disabled:!a.getCanNextPage(),onClick:a.nextPage,children:[e.jsx("span",{className:"sr-only",children:"Go to next page"}),e.jsx(ve,{className:"h-4 w-4"})]}),e.jsxs(t,{variant:"outline",className:"h-8 w-8 p-0",disabled:!a.getCanNextPage(),onClick:()=>a.setPageIndex(a.getPageCount()-1),children:[e.jsx("span",{className:"sr-only",children:"Go to last page"}),e.jsx(Pe,{className:"h-4 w-4"})]})]})]})]})}function Le({columns:a,data:x,searchInputField:h,filterField:w,filterFieldName:Q,filterCategoriesList:V,totalRecord:M,children:G}){var E;const b=ue(),{rows:g,onPaginationChange:k,page:y,pagination:A}=pe(),v=Z(),N=()=>{const l=new URLSearchParams(v.search),o=fe({rows:g,page:y},l);b(`?${o}`,{replace:!0})};r.useEffect(()=>{N()},[g,y]);const u=ge({data:x,columns:a,getCoreRowModel:xe(),manualPagination:!0,onPaginationChange:k,state:{pagination:A},rowCount:M}),K=r.Children.map(G,l=>r.isValidElement(l)?r.cloneElement(l,{table:u,searchInputField:h,filterField:w,filterFieldName:Q,filterCategoriesList:V}):l);return e.jsxs("div",{className:"space-y-4",children:[K,e.jsx("div",{className:"overflow-y-auto rounded-md border",children:e.jsxs(be,{children:[e.jsx(Ne,{children:u.getHeaderGroups().map(l=>e.jsx(q,{children:l.headers.map(o=>e.jsx(je,{className:"px-4 py-2 bg-newprimaryColor text-white font-raleway",colSpan:o.colSpan,children:o.isPlaceholder?null:X(o.column.columnDef.header,o.getContext())},o.id))},l.id))}),e.jsx(Ce,{className:"bg-adminBreadCrumbsBg font-raleway",children:(E=u.getRowModel().rows)!=null&&E.length?u.getRowModel().rows.map(l=>e.jsx(q,{"data-state":l.getIsSelected()&&"selected",children:l.getVisibleCells().map(o=>e.jsx(Y,{className:"px-4 py-2",children:X(o.column.columnDef.cell,o.getContext())},o.id))},l.id)):e.jsx(q,{children:e.jsx(Y,{colSpan:a.length,className:"h-24 text-center bg-adminBreadCrumbsBg font-raleway",children:"No results."})})})]})}),e.jsx(Be,{table:u,totalRecord:M})]})}const $e=[{id:"srno",header:()=>e.jsx("p",{className:!0,children:"Sr. No."}),cell:a=>e.jsx("p",{children:a.row.index+1}),enableSorting:!1,enableHiding:!1},{accessorKey:"memberName",header:()=>e.jsx("div",{className:!0,children:"Member Name"}),cell:({row:a})=>e.jsxs("p",{className:"text-sm font-medium",children:[a.original.firstName," ",a.original.lastName]}),enableSorting:!1,enableHiding:!1},{accessorKey:"email",header:()=>e.jsx("div",{className:!0,children:"Email"}),cell:({row:a})=>e.jsx("p",{className:"text-sm font-medium",children:a.original.email}),enableSorting:!1,enableHiding:!1},{accessorKey:"phoneNumber",header:()=>e.jsx("div",{className:!0,children:"Phone Number"}),cell:({row:a})=>e.jsx("p",{className:"text-sm font-medium",children:a.original.phoneNumber}),enableSorting:!1,enableHiding:!1},{accessorKey:"numberOfChapter",header:()=>e.jsx("div",{className:!0,children:"Number of Chapters"}),cell:({row:a})=>e.jsx("p",{className:"text-sm font-medium",children:a.original.numberOfChapter}),enableSorting:!1,enableHiding:!1},{id:"actions",header:()=>e.jsx("div",{className:!0,children:"Actions"}),cell:({row:a})=>e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(t,{variant:"secondary",size:"sm",onClick:()=>a.original.onView(a.original),children:"View"}),e.jsx(t,{variant:"secondary",size:"sm",onClick:()=>a.original.onEdit(a.original),className:"text-yellow-600 border-yellow-600 ",children:"Edit"}),e.jsx(t,{variant:"destructive",size:"sm",onClick:()=>a.original.onDelete(a.original.memberId),children:"Delete"}),e.jsx(t,{onClick:()=>a.original.onChangePassword(a.original.memberId),variant:"secondary",size:"sm",className:"text-green-600 border-yellow-600 ",children:"Change Password"})]}),enableSorting:!1,enableHiding:!1}],ze=()=>{const[a,x]=r.useState([{memberId:"1",firstName:"John",lastName:"Doe",email:"john.doe@example.com",phoneNumber:"123-456-7890"}]),[h,w]=r.useState(!0),[Q,V]=r.useState(!1),[M,G]=r.useState(null),[b,g]=r.useState(null),[k,y]=r.useState(0),A=Z(),v=new URLSearchParams(A.search),N=parseInt(v.get("rows"))||10,u=parseInt(v.get("page"))||0,[K,E]=r.useState([]),[l,o]=r.useState(""),[_,F]=r.useState(!1),[ee,P]=r.useState(!1),[S,D]=r.useState(null),[Qe,ae]=r.useState(!1),[U,I]=r.useState(!1),[se,re]=r.useState(null),[O,J]=r.useState({newPassword:"",confirmPassword:""}),[i,j]=r.useState({firstName:"",lastName:"",email:"",phoneNumber:""});r.useEffect(()=>{T()},[N,u,l]);const T=()=>{f.get("/api/admin/members/getandsearchmembers",{params:{searchQuery:l.trim(),rows:N,page:u+1}}).then(s=>{x(s.data.data||s.data),y(s.data.totalRecords||s.data.length),w(!1)}).catch(s=>{console.error("Error fetching members:",s),c.error("Failed to fetch members"),w(!1)})},p=s=>{const{name:n,value:m}=s.target;console.log("Input changed:",n,m),j(C=>({...C,[n]:m}))},ne=()=>{var s,n,m;return(s=i.firstName)!=null&&s.trim()?!((n=i.email)!=null&&n.trim())&&!((m=i.phoneNumber)!=null&&m.trim())?(c.error("Email is required or Phone number is required "),!1):!0:(c.error("First name is required"),!1)},te=async s=>{if(s.preventDefault(),!!ne())try{const n={firstName:i.firstName,lastName:i.lastName||null,email:i.email||null,phoneNumber:i.phoneNumber||null};S?(await f.put(`/api/admin/members/${S.memberId}`,n),c.success("Member updated successfully"),P(!1)):(await f.post("/api/admin/members",n),c.success("Member added successfully")),R(),T()}catch{c.error("Failed to submit member")}},le=s=>{g(s)},ie=async()=>{if(b){try{await f.delete(`/api/admin/members/${b}`),c.success("Member deleted successfully"),await T()}catch(s){c.error("Failed to delete member"),console.error("Error deleting member:",s)}g(null)}},oe=()=>{j({firstName:"",lastName:"",email:"",phoneNumber:""}),F(!0)},ce=async s=>{s.preventDefault();try{const n=await f.post("/api/admin/members",i);x(m=>[...m,n.data]),c.success("Member added successfully"),R()}catch{c.error("Failed to add member")}},me=(s=null)=>{s?(j({firstName:s.firstName,lastName:s.lastName,email:s.email,phoneNumber:s.phoneNumber}),D(s)):(j({firstName:"",lastName:"",email:"",phoneNumber:""}),D(null)),P(!0)},R=()=>{F(!1),ae(!1),D(null),j({firstName:"",lastName:"",email:"",phoneNumber:""})},de=s=>{re(s),J({newPassword:"",confirmPassword:""}),I(!0)},W=s=>{const{name:n,value:m}=s.target;J(C=>({...C,[n]:m}))},he=async s=>{s.preventDefault();const{newPassword:n,confirmPassword:m}=O;if(n!==m){c.error("Passwords do not match");return}try{await f.put(`/api/admin/members/updatepassword/${se}`,{password:n,confirmPassword:m}),c.success("Password changed successfully"),I(!1)}catch(C){console.error(C),c.error("Failed to change password")}};return console.log({members:a}),e.jsxs("div",{className:"rounded-2xl border border-stroke bg-white p-5 shadow-md dark:border-strokedark dark:bg-boxdark",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Super Admin Member Table"}),e.jsxs(H,{open:_,onOpenChange:F,children:[e.jsx(Re,{asChild:!0,children:e.jsx(t,{onClick:oe,children:"Add Member"})}),e.jsxs(B,{children:[e.jsx(L,{children:e.jsx($,{children:"Add Member"})}),e.jsxs("form",{onSubmit:ce,children:[e.jsx(d,{name:"firstName",placeholder:"First Name",value:i.firstName,onChange:p,className:"mb-4",required:!0}),e.jsx(d,{name:"lastName",placeholder:"Last Name",value:i.lastName,onChange:p,className:"mb-4",required:!0}),e.jsx(d,{name:"email",type:"email",placeholder:"Email",value:i.email,onChange:p,className:"mb-4",required:!0}),e.jsx(d,{name:"phoneNumber",type:"number",placeholder:"Phone Number",value:i.phoneNumber,onChange:p,className:"mb-4",required:!0}),e.jsxs(z,{children:[e.jsx(t,{variant:"secondary",onClick:R,children:"Cancel"}),e.jsx(t,{type:"submit",children:"Add"})]})]})]})]})]}),e.jsx("div",{className:"mb-4",children:e.jsx(qe,{value:l,onChange:s=>o(s.target.value),className:"mb-3 w-full",placeholder:"Search members using name, email, or phone number..."})}),h?e.jsx("p",{children:"Loading..."}):e.jsx(Le,{data:a.map(s=>({...s,membersName:`${s.firstName} ${s.lastName}`,onEdit:me,onDelete:()=>le(s.memberId),onChangePassword:()=>de(s.memberId)})),columns:$e,searchInputField:"membersName",totalRecord:k,pagination:{pageSize:parseInt(N),pageIndex:parseInt(u)}}),e.jsx(Ae,{open:!!b,onOpenChange:g,children:e.jsxs(Ee,{children:[e.jsx(Fe,{children:e.jsx(Oe,{children:"Confirm Deletion"})}),e.jsx("p",{children:"Are you sure you want to delete this member?"}),e.jsxs(Te,{children:[e.jsx(t,{variant:"secondary",onClick:()=>g(null),children:"Cancel"}),e.jsx(t,{variant:"destructive",onClick:ie,children:"Delete"})]})]})}),e.jsx(H,{open:ee,onOpenChange:P,children:e.jsxs(B,{children:[e.jsx(L,{children:e.jsx($,{children:S?"Edit Member":"Add Member"})}),e.jsxs("form",{onSubmit:te,className:"space-y-4",children:[e.jsx(d,{type:"text",name:"firstName",placeholder:"First Name",value:i.firstName,onChange:p,required:!0}),e.jsx(d,{type:"text",name:"lastName",placeholder:"Last Name",value:i.lastName,onChange:p}),e.jsx(d,{type:"email",name:"email",placeholder:"Email",value:i.email,onChange:p}),e.jsx(d,{type:"number",name:"phoneNumber",placeholder:"Phone Number",value:i.phoneNumber,onChange:p}),e.jsxs(z,{children:[e.jsx(t,{type:"button",variant:"secondary",onClick:()=>{P(!1),D(null)},children:"Cancel"}),e.jsx(t,{type:"submit",children:S?"Update":"Add"})]})]})]})}),e.jsx(H,{open:U,onOpenChange:I,children:e.jsxs(B,{children:[e.jsx(L,{children:e.jsx($,{children:"Change Password"})}),e.jsxs("form",{onSubmit:he,className:"space-y-4",children:[e.jsx(d,{type:"password",name:"newPassword",placeholder:"New Password",value:O.newPassword,onChange:W,required:!0}),e.jsx(d,{type:"password",name:"confirmPassword",placeholder:"Confirm Password",value:O.confirmPassword,onChange:W,required:!0}),e.jsxs(z,{children:[e.jsx(t,{type:"button",variant:"secondary",onClick:()=>{I(!1)},children:"Cancel"}),e.jsxs(t,{onClick:()=>U(!1),type:"submit",children:["Change Password"," "]})]})]})]})})]})},ua=()=>e.jsxs(e.Fragment,{children:[e.jsx(He,{items:[{name:"Dashboard",link:"/admin"},{name:"Members",link:"/admin/members"}]}),e.jsx(ze,{})]});export{ua as default};
