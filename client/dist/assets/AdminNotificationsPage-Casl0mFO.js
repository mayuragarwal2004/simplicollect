import{r,c as R,j as e,Q as l}from"./index-6elQxnHd.js";const $=()=>{const[g,h]=r.useState(!1),[p,I]=r.useState([]),[T,V]=r.useState(["Leader","Member","Treasurer","Secretary"]),[c,b]=r.useState(""),[u,y]=r.useState(""),[f,E]=r.useState("info"),[j,P]=r.useState("medium"),[k,M]=r.useState(!0),[o,q]=r.useState("all"),[n,v]=r.useState(""),[m,D]=r.useState(""),[x,N]=r.useState(""),[i,L]=r.useState(null);r.useEffect(()=>{A()},[]);const A=async()=>{try{const t=await R.get("/api/admin/chapters");I(t.data.chapters||[])}catch(t){console.error("Error fetching chapters:",t)}},F=async t=>{if(t.preventDefault(),!c.trim()||!u.trim()){l.error("Title and message are required");return}h(!0);try{let s={};switch(o){case"chapter":if(!n){l.error("Please select a chapter");return}s={chapterId:n};break;case"role":if(!m){l.error("Please select a role");return}s={role:m},n&&(s.chapterId=n);break;case"custom":if(!x.trim()){l.error("Please provide custom recipients");return}const H=x.split(`
`).map(a=>a.trim()).filter(a=>a),w=[],S=[],C=[];H.forEach(a=>{a.includes("@")?C.push(a):/^\d+$/.test(a)?S.push(a):w.push(a)}),s={memberIds:w,phoneNumbers:S,emails:C};break}const z={title:c,message:u,type:f,priority:j,isPersistent:k,targetType:o,targetData:s},d=await R.post("/api/notifications/send-bulk",z);d.data.success?(l.success(`Notifications sent to ${d.data.totalSent} recipients`),L(d.data),b(""),y(""),N("")):l.error(d.data.message||"Failed to send notifications")}catch(s){console.error("Error sending notifications:",s),l.error("Failed to send notifications")}finally{h(!1)}};return e.jsxs("div",{className:"mx-auto max-w-4xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Send Notifications"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Send notifications to members across your organization"})]}),e.jsxs("form",{onSubmit:F,className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg bg-white p-6 shadow-md dark:bg-gray-800",children:[e.jsx("h2",{className:"mb-4 text-lg font-semibold text-gray-900 dark:text-white",children:"Notification Content"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Title *"}),e.jsx("input",{type:"text",value:c,onChange:t=>b(t.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:outline-none dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:"Notification title",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Type"}),e.jsxs("select",{value:f,onChange:t=>E(t.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:outline-none dark:border-gray-600 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"info",children:"Info"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"warning",children:"Warning"}),e.jsx("option",{value:"error",children:"Error"}),e.jsx("option",{value:"payment",children:"Payment"}),e.jsx("option",{value:"report",children:"Report"}),e.jsx("option",{value:"marketing",children:"Marketing"})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Message *"}),e.jsx("textarea",{value:u,onChange:t=>y(t.target.value),rows:4,className:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:outline-none dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:"Notification message",required:!0})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Priority"}),e.jsxs("select",{value:j,onChange:t=>P(t.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:outline-none dark:border-gray-600 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"persistent",checked:k,onChange:t=>M(t.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"persistent",className:"ml-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Persistent Notification"})]})]})]}),e.jsxs("div",{className:"rounded-lg bg-white p-6 shadow-md dark:bg-gray-800",children:[e.jsx("h2",{className:"mb-4 text-lg font-semibold text-gray-900 dark:text-white",children:"Recipients"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Target Type"}),e.jsxs("select",{value:o,onChange:t=>q(t.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:outline-none dark:border-gray-600 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"all",children:"All Members"}),e.jsx("option",{value:"chapter",children:"Specific Chapter"}),e.jsx("option",{value:"role",children:"Specific Role"}),e.jsx("option",{value:"custom",children:"Custom List"})]})]}),o==="chapter"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Select Chapter"}),e.jsxs("select",{value:n,onChange:t=>v(t.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:outline-none dark:border-gray-600 dark:bg-gray-700 dark:text-white",required:!0,children:[e.jsx("option",{value:"",children:"Choose a chapter"}),p.map(t=>e.jsx("option",{value:t.chapterId,children:t.chapterName},t.chapterId))]})]}),o==="role"&&e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Select Role"}),e.jsxs("select",{value:m,onChange:t=>D(t.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:outline-none dark:border-gray-600 dark:bg-gray-700 dark:text-white",required:!0,children:[e.jsx("option",{value:"",children:"Choose a role"}),T.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Chapter (Optional)"}),e.jsxs("select",{value:n,onChange:t=>v(t.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:outline-none dark:border-gray-600 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"All chapters"}),p.map(t=>e.jsx("option",{value:t.chapterId,children:t.chapterName},t.chapterId))]})]})]}),o==="custom"&&e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Custom Recipients"}),e.jsx("textarea",{value:x,onChange:t=>N(t.target.value),rows:6,className:"w-full rounded-lg border border-gray-300 px-3 py-2 focus:border-blue-500 focus:outline-none dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:`Enter member IDs, phone numbers, or email addresses (one per line)
Example:
member123
+919876543210
user@example.com`}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Enter one recipient per line. You can use member IDs, phone numbers, or email addresses."})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:g,className:"flex items-center px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50",children:g?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Sending..."]}):"Send Notification"})})]}),i&&e.jsxs("div",{className:"mt-8 rounded-lg bg-green-50 p-6 dark:bg-green-900/20",children:[e.jsx("h3",{className:"text-lg font-semibold text-green-800 dark:text-green-400",children:"Notification Sent Successfully"}),e.jsxs("p",{className:"mt-2 text-green-700 dark:text-green-300",children:["Sent to ",i.totalSent," recipients"]}),e.jsxs("details",{className:"mt-4",children:[e.jsxs("summary",{className:"cursor-pointer text-green-800 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300",children:["View Recipients (",i.recipients.length,")"]}),e.jsx("div",{className:"mt-2 max-h-40 overflow-y-auto",children:e.jsx("ul",{className:"text-sm text-green-700 dark:text-green-300",children:i.recipients.map((t,s)=>e.jsxs("li",{className:"py-1",children:[t.name," (",t.email||t.phoneNumber,")"]},s))})})]})]})]})};export{$ as default};
