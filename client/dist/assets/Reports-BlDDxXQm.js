import{d as Dt,j as e,B as re,u as ft,a as ze,r as d,U as Ft,G as xt,e as Ye,g as Fe,c as le,Q as se,D as Se,n as He,t as We,w as Ve,v as ct,s as dt,R as Ut}from"./index-6elQxnHd.js";import{B as Bt}from"./Breadcrumb-ME0YvNli.js";import{S as je,a as ve,b as be,c as we,d as Ce,R as Ht,e as Ie,f as Le}from"./select-BctcFQZm.js";import{T as Ae,a as Oe,b as oe,c as V,d as Me,e as S}from"./table-CMz5QLeZ.js";import{u as gt,a as yt,b as jt,f as $e,c as vt}from"./usePagination-BYw1nb5N.js";import{D as bt,C as wt,a as Ct,b as Nt}from"./react-icons.esm-BfHCtAcr.js";import{B as Be}from"./badge-C8uzDnx2.js";import{c as $t,d as zt,e as Kt,P as qt,a as Re}from"./index-BGKEPXry.js";import{P as Gt,D as Wt}from"./index-BLdKwkXj.js";import{c as _t,C as Vt,R as Qt,A as Yt,a as Jt}from"./index-BXCPHgg9.js";import{P as Rt}from"./index-CE4AQY6s.js";import{A as Xt,b as Zt,a as es}from"./alert-wBOMEK6L.js";import{S as Pe}from"./skeleton-Dmqt5wNo.js";import{M as ts,a as ss}from"./MemberLedgerReportcolumn-Br0aG1_L.js";import{C as rs,f as as}from"./ChooseMemberPopoverCommand-sC98BC9i.js";import{C as ns}from"./checkbox-D30DXwBR.js";import"./jspdf.plugin.autotable-CMHCTxfG.js";import{D as os,f as is,a as ls,b as cs,c as ds,d as us}from"./dialog-CT_lOUQb.js";import{L as Je}from"./label-Duevo3Y3.js";import{I as Qe}from"./input-Dp_r379b.js";import{P as Xe,a as Ze,b as et}from"./popover-D0OZeFQ8.js";import{C as tt}from"./calendar-CfUOH_cJ.js";import{C as st}from"./calendar-DIJiUsoz.js";import{f as pe}from"./format-SmSpYad1.js";import{S as hs}from"./switch-0nZFpl0y.js";import"./chevron-right-DA45-pzU.js";import"./index-BdQq_4o_.js";import"./index-CWa4kTbH.js";import"./index-BvgCK6ys.js";import"./index-DSJunp_n.js";import"./chevron-down-BUZeX_Bt.js";import"./index-BIhwVmuG.js";import"./command-DbqVVo4r.js";import"./index-CgP8r1n9.js";import"./search-C_1baVLY.js";import"./chevrons-up-down-j_XmOuyD.js";import"./chevron-left-DwqZmAJ3.js";/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],ut=Dt("Info",ps);function ms({table:r,totalRecord:h}){return e.jsxs("div",{className:"flex flex-col items-center justify-between space-y-4 px-2 lg:flex-row lg:space-y-0",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-2 sm:flex-row sm:space-x-6 sm:space-y-0",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[r.getFilteredRowModel().rows.length," row(s)."]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Rows per page"}),e.jsxs(je,{value:`${r.getState().pagination.pageSize}`,onValueChange:c=>{r.setPageSize(Number(c))},children:[e.jsx(ve,{className:"h-8 w-[70px]",children:e.jsx(be,{placeholder:r.getState().pagination.pageSize})}),e.jsx(we,{side:"top",children:[5,10,20,30,40,50].map(c=>e.jsx(Ce,{value:`${c}`,children:c},c))})]})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Total Record: ",h]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center justify-center text-sm font-medium",children:["Page ",r.getState().pagination.pageIndex+1," of ",r.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(re,{variant:"outline",className:"h-8 w-8 p-0",disabled:!r.getCanPreviousPage(),onClick:()=>r.setPageIndex(0),children:[e.jsx("span",{className:"sr-only",children:"Go to first page"}),e.jsx(bt,{className:"h-4 w-4"})]}),e.jsxs(re,{variant:"outline",className:"h-8 w-8 p-0",disabled:!r.getCanPreviousPage(),onClick:r.previousPage,children:[e.jsx("span",{className:"sr-only",children:"Go to previous page"}),e.jsx(wt,{className:"h-4 w-4"})]}),e.jsxs(re,{variant:"outline",className:"h-8 w-8 p-0",disabled:!r.getCanNextPage(),onClick:r.nextPage,children:[e.jsx("span",{className:"sr-only",children:"Go to next page"}),e.jsx(Ct,{className:"h-4 w-4"})]}),e.jsxs(re,{variant:"outline",className:"h-8 w-8 p-0",disabled:!r.getCanNextPage(),onClick:()=>r.setPageIndex(r.getPageCount()-1),children:[e.jsx("span",{className:"sr-only",children:"Go to last page"}),e.jsx(Nt,{className:"h-4 w-4"})]})]})]})]})}function fs({columns:r,data:h,searchInputField:c,filterField:o,filterFieldName:p,filterCategoriesList:a,totalRecord:v,children:C}){var A;const b=ft(),{rows:i,onPaginationChange:u,page:N,pagination:y}=gt(),l=ze(),T=()=>{const j=new URLSearchParams(l.search),_=vt({rows:i,page:N},j);b(`?${_}`,{replace:!0})};d.useEffect(()=>{T()},[i,N]);const g=yt({data:h,columns:r,getCoreRowModel:jt(),manualPagination:!0,onPaginationChange:u,state:{pagination:y},rowCount:v}),P=d.Children.map(C,j=>d.isValidElement(j)?d.cloneElement(j,{table:g,searchInputField:c,filterField:o,filterFieldName:p,filterCategoriesList:a}):j);return e.jsxs("div",{className:"space-y-4",children:[P,e.jsx("div",{className:"overflow-y-auto rounded-md border",children:e.jsxs(Ae,{children:[e.jsx(Oe,{children:g.getHeaderGroups().map(j=>e.jsx(oe,{children:j.headers.map(_=>e.jsx(V,{className:"px-4 py-2 bg-newprimaryColor text-white font-raleway",colSpan:_.colSpan,children:_.isPlaceholder?null:$e(_.column.columnDef.header,_.getContext())},_.id))},j.id))}),e.jsx(Me,{className:"bg-adminBreadCrumbsBg font-raleway",children:(A=g.getRowModel().rows)!=null&&A.length?g.getRowModel().rows.map(j=>e.jsx(oe,{"data-state":j.getIsSelected()&&"selected",children:j.getVisibleCells().map(_=>e.jsx(S,{className:"px-4 py-2",children:$e(_.column.columnDef.cell,_.getContext())},_.id))},j.id)):e.jsx(oe,{children:e.jsx(S,{colSpan:r.length,className:"h-24 text-center bg-adminBreadCrumbsBg font-raleway",children:"No results."})})})]})}),e.jsx(ms,{table:g,totalRecord:v})]})}const ht=[{id:"srno",header:()=>e.jsx("p",{className:"font-semibold",children:"Sr. No."}),cell:r=>e.jsx("p",{className:"text-muted-foreground",children:r.row.index+1}),enableSorting:!1,enableHiding:!1},{accessorKey:"firstName",header:()=>e.jsx("div",{className:"font-semibold",children:"Member Name"}),cell:({row:r})=>e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("p",{className:"font-medium",children:[r.original.firstName," ",r.original.lastName]}),r.original.email&&e.jsx("p",{className:"text-sm text-muted-foreground",children:r.original.email})]}),enableSorting:!1,enableHiding:!1}];var[Ke,Ir]=$t("Tooltip",[_t]),qe=_t(),St="TooltipProvider",xs=700,rt="tooltip.open",[gs,nt]=Ke(St),kt=r=>{const{__scopeTooltip:h,delayDuration:c=xs,skipDelayDuration:o=300,disableHoverableContent:p=!1,children:a}=r,v=d.useRef(!0),C=d.useRef(!1),b=d.useRef(0);return d.useEffect(()=>{const i=b.current;return()=>window.clearTimeout(i)},[]),e.jsx(gs,{scope:h,isOpenDelayedRef:v,delayDuration:c,onOpen:d.useCallback(()=>{window.clearTimeout(b.current),v.current=!1},[]),onClose:d.useCallback(()=>{window.clearTimeout(b.current),b.current=window.setTimeout(()=>v.current=!0,o)},[o]),isPointerInTransitRef:C,onPointerInTransitChange:d.useCallback(i=>{C.current=i},[]),disableHoverableContent:p,children:a})};kt.displayName=St;var De="Tooltip",[ys,Ue]=Ke(De),Et=r=>{const{__scopeTooltip:h,children:c,open:o,defaultOpen:p,onOpenChange:a,disableHoverableContent:v,delayDuration:C}=r,b=nt(De,r.__scopeTooltip),i=qe(h),[u,N]=d.useState(null),y=zt(),l=d.useRef(0),T=v??b.disableHoverableContent,g=C??b.delayDuration,P=d.useRef(!1),[A,j]=Kt({prop:o,defaultProp:p??!1,onChange:x=>{x?(b.onOpen(),document.dispatchEvent(new CustomEvent(rt))):b.onClose(),a==null||a(x)},caller:De}),_=d.useMemo(()=>A?P.current?"delayed-open":"instant-open":"closed",[A]),Y=d.useCallback(()=>{window.clearTimeout(l.current),l.current=0,P.current=!1,j(!0)},[j]),ce=d.useCallback(()=>{window.clearTimeout(l.current),l.current=0,j(!1)},[j]),ee=d.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>{P.current=!0,j(!0),l.current=0},g)},[g,j]);return d.useEffect(()=>()=>{l.current&&(window.clearTimeout(l.current),l.current=0)},[]),e.jsx(Qt,{...i,children:e.jsx(ys,{scope:h,contentId:y,open:A,stateAttribute:_,trigger:u,onTriggerChange:N,onTriggerEnter:d.useCallback(()=>{b.isOpenDelayedRef.current?ee():Y()},[b.isOpenDelayedRef,ee,Y]),onTriggerLeave:d.useCallback(()=>{T?ce():(window.clearTimeout(l.current),l.current=0)},[ce,T]),onOpen:Y,onClose:ce,disableHoverableContent:T,children:c})})};Et.displayName=De;var at="TooltipTrigger",Tt=d.forwardRef((r,h)=>{const{__scopeTooltip:c,...o}=r,p=Ue(at,c),a=nt(at,c),v=qe(c),C=d.useRef(null),b=xt(h,C,p.onTriggerChange),i=d.useRef(!1),u=d.useRef(!1),N=d.useCallback(()=>i.current=!1,[]);return d.useEffect(()=>()=>document.removeEventListener("pointerup",N),[N]),e.jsx(Yt,{asChild:!0,...v,children:e.jsx(qt.button,{"aria-describedby":p.open?p.contentId:void 0,"data-state":p.stateAttribute,...o,ref:b,onPointerMove:Re(r.onPointerMove,y=>{y.pointerType!=="touch"&&!u.current&&!a.isPointerInTransitRef.current&&(p.onTriggerEnter(),u.current=!0)}),onPointerLeave:Re(r.onPointerLeave,()=>{p.onTriggerLeave(),u.current=!1}),onPointerDown:Re(r.onPointerDown,()=>{p.open&&p.onClose(),i.current=!0,document.addEventListener("pointerup",N,{once:!0})}),onFocus:Re(r.onFocus,()=>{i.current||p.onOpen()}),onBlur:Re(r.onBlur,p.onClose),onClick:Re(r.onClick,p.onClose)})})});Tt.displayName=at;var ot="TooltipPortal",[js,vs]=Ke(ot,{forceMount:void 0}),Pt=r=>{const{__scopeTooltip:h,forceMount:c,children:o,container:p}=r,a=Ue(ot,h);return e.jsx(js,{scope:h,forceMount:c,children:e.jsx(Rt,{present:c||a.open,children:e.jsx(Gt,{asChild:!0,container:p,children:o})})})};Pt.displayName=ot;var ke="TooltipContent",It=d.forwardRef((r,h)=>{const c=vs(ke,r.__scopeTooltip),{forceMount:o=c.forceMount,side:p="top",...a}=r,v=Ue(ke,r.__scopeTooltip);return e.jsx(Rt,{present:o||v.open,children:v.disableHoverableContent?e.jsx(Lt,{side:p,...a,ref:h}):e.jsx(bs,{side:p,...a,ref:h})})}),bs=d.forwardRef((r,h)=>{const c=Ue(ke,r.__scopeTooltip),o=nt(ke,r.__scopeTooltip),p=d.useRef(null),a=xt(h,p),[v,C]=d.useState(null),{trigger:b,onClose:i}=c,u=p.current,{onPointerInTransitChange:N}=o,y=d.useCallback(()=>{C(null),N(!1)},[N]),l=d.useCallback((T,g)=>{const P=T.currentTarget,A={x:T.clientX,y:T.clientY},j=Rs(A,P.getBoundingClientRect()),_=Ss(A,j),Y=ks(g.getBoundingClientRect()),ce=Ts([..._,...Y]);C(ce),N(!0)},[N]);return d.useEffect(()=>()=>y(),[y]),d.useEffect(()=>{if(b&&u){const T=P=>l(P,u),g=P=>l(P,b);return b.addEventListener("pointerleave",T),u.addEventListener("pointerleave",g),()=>{b.removeEventListener("pointerleave",T),u.removeEventListener("pointerleave",g)}}},[b,u,l,y]),d.useEffect(()=>{if(v){const T=g=>{const P=g.target,A={x:g.clientX,y:g.clientY},j=(b==null?void 0:b.contains(P))||(u==null?void 0:u.contains(P)),_=!Es(A,v);j?y():_&&(y(),i())};return document.addEventListener("pointermove",T),()=>document.removeEventListener("pointermove",T)}},[b,u,v,i,y]),e.jsx(Lt,{...r,ref:a})}),[ws,Cs]=Ke(De,{isInside:!1}),Ns=Ft("TooltipContent"),Lt=d.forwardRef((r,h)=>{const{__scopeTooltip:c,children:o,"aria-label":p,onEscapeKeyDown:a,onPointerDownOutside:v,...C}=r,b=Ue(ke,c),i=qe(c),{onClose:u}=b;return d.useEffect(()=>(document.addEventListener(rt,u),()=>document.removeEventListener(rt,u)),[u]),d.useEffect(()=>{if(b.trigger){const N=y=>{const l=y.target;l!=null&&l.contains(b.trigger)&&u()};return window.addEventListener("scroll",N,{capture:!0}),()=>window.removeEventListener("scroll",N,{capture:!0})}},[b.trigger,u]),e.jsx(Wt,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:a,onPointerDownOutside:v,onFocusOutside:N=>N.preventDefault(),onDismiss:u,children:e.jsxs(Vt,{"data-state":b.stateAttribute,...i,...C,ref:h,style:{...C.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(Ns,{children:o}),e.jsx(ws,{scope:c,isInside:!0,children:e.jsx(Ht,{id:b.contentId,role:"tooltip",children:p||o})})]})})});It.displayName=ke;var At="TooltipArrow",_s=d.forwardRef((r,h)=>{const{__scopeTooltip:c,...o}=r,p=qe(c);return Cs(At,c).isInside?null:e.jsx(Jt,{...p,...o,ref:h})});_s.displayName=At;function Rs(r,h){const c=Math.abs(h.top-r.y),o=Math.abs(h.bottom-r.y),p=Math.abs(h.right-r.x),a=Math.abs(h.left-r.x);switch(Math.min(c,o,p,a)){case a:return"left";case p:return"right";case c:return"top";case o:return"bottom";default:throw new Error("unreachable")}}function Ss(r,h,c=5){const o=[];switch(h){case"top":o.push({x:r.x-c,y:r.y+c},{x:r.x+c,y:r.y+c});break;case"bottom":o.push({x:r.x-c,y:r.y-c},{x:r.x+c,y:r.y-c});break;case"left":o.push({x:r.x+c,y:r.y-c},{x:r.x+c,y:r.y+c});break;case"right":o.push({x:r.x-c,y:r.y-c},{x:r.x-c,y:r.y+c});break}return o}function ks(r){const{top:h,right:c,bottom:o,left:p}=r;return[{x:p,y:h},{x:c,y:h},{x:c,y:o},{x:p,y:o}]}function Es(r,h){const{x:c,y:o}=r;let p=!1;for(let a=0,v=h.length-1;a<h.length;v=a++){const C=h[a],b=h[v],i=C.x,u=C.y,N=b.x,y=b.y;u>o!=y>o&&c<(N-i)*(o-u)/(y-u)+i&&(p=!p)}return p}function Ts(r){const h=r.slice();return h.sort((c,o)=>c.x<o.x?-1:c.x>o.x?1:c.y<o.y?-1:c.y>o.y?1:0),Ps(h)}function Ps(r){if(r.length<=1)return r.slice();const h=[];for(let o=0;o<r.length;o++){const p=r[o];for(;h.length>=2;){const a=h[h.length-1],v=h[h.length-2];if((a.x-v.x)*(p.y-v.y)>=(a.y-v.y)*(p.x-v.x))h.pop();else break}h.push(p)}h.pop();const c=[];for(let o=r.length-1;o>=0;o--){const p=r[o];for(;c.length>=2;){const a=c[c.length-1],v=c[c.length-2];if((a.x-v.x)*(p.y-v.y)>=(a.y-v.y)*(p.x-v.x))c.pop();else break}c.push(p)}return c.pop(),h.length===1&&c.length===1&&h[0].x===c[0].x&&h[0].y===c[0].y?h:h.concat(c)}var Is=kt,Ls=Et,As=Tt,Os=Pt,Ot=It;const Ms=Is,Ds=Ls,Fs=As,Mt=d.forwardRef(({className:r,sideOffset:h=4,...c},o)=>e.jsx(Os,{children:e.jsx(Ot,{ref:o,sideOffset:h,className:Ye("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",r),...c})}));Mt.displayName=Ot.displayName;const Us=()=>{const r=ze(),[h,c]=d.useState([]),{chapterData:o}=Fe(),[p,a]=d.useState(null),v=new URLSearchParams(r.search),[C,b]=d.useState([]),[i,u]=d.useState([]),[N,y]=d.useState([]),[l,T]=d.useState(""),[g,P]=d.useState(""),A=v.get("rows")||10,j=v.get("page")||0,_=ht.map(({accessorKey:t,header:s})=>({label:s().props.children,key:t})),[Y,ce]=d.useState(_.map(({label:t})=>t)),ee=t=>{switch(t==null?void 0:t.toLowerCase()){case"approved":return e.jsx(Be,{className:"bg-green-500 text-white",children:t});case"rejected":return e.jsx(Be,{className:"bg-red-500 text-white",children:t});case"pending":return e.jsx(Be,{className:"bg-yellow-500 text-white",children:"Pending Approval"});default:return e.jsx(Be,{className:"bg-gray-500 text-white",children:"N/A"})}},x=()=>{o!=null&&o.chapterId&&(!l||!g||le.get(`/api/report/${o.chapterId}/package-summary?rows=${A}&page=${j}`,{params:{chapterId:o.chapterId,rows:A,page:j,...l&&{termId:l}}}).then(t=>{var m;const s=(t.data.data||[]).map(R=>({...R,packageData:(R.packageData||[]).filter($=>$.packageParent===g)}));c(s);const n=((m=s[0])==null?void 0:m.packageData)||[],f=[];for(let R=0;R<n.length;R++)f.push({accessorKey:`packageData_${R}`,header:()=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:n[R].packageName}),e.jsx(Ms,{children:e.jsxs(Ds,{children:[e.jsx(Fs,{children:e.jsx(ut,{className:"w-4 h-4 text-muted-foreground"})}),e.jsxs(Mt,{children:[e.jsxs("p",{children:["Package: ",n[R].packageName]}),e.jsx("p",{children:"Status indicates approval state"})]})]})})]}),cell:({row:$})=>{var ie,O,K;const U=$.original.packageData[R];return e.jsx("div",{className:"flex flex-col gap-1",children:U!=null&&U.status?ee(U.status):(ie=U==null?void 0:U.calculatedResult)!=null&&ie.totalAmount?e.jsxs("span",{className:"font-medium",children:["₹",U.calculatedResult.totalAmount]}):((O=U==null?void 0:U.calculatedResult)==null?void 0:O.message)==="Package has overlapping payments"?e.jsx("span",{className:"text-green-500",children:"✔️"}):e.jsx("span",{className:"text-muted-foreground",children:((K=U==null?void 0:U.calculatedResult)==null?void 0:K.message)||"N/A"})})},enableSorting:!1,enableHiding:!1});b([...ht,...f]),a(t.data.totalRecords)}).catch(t=>{console.error(t)}))};return d.useEffect(()=>{o!=null&&o.chapterId&&le.get(`/api/term/chapter/${o.chapterId}`).then(t=>u(t.data)).catch(()=>u([]))},[o]),d.useEffect(()=>{if(!(o!=null&&o.chapterId)||!l){y([]),P("");return}le.get(`/api/packages/parents/${o.chapterId}?termId=${l}`).then(t=>y(t.data)).catch(()=>y([]))},[o,l]),d.useEffect(()=>{x()},[o,A,j,r.search,l,g]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Member Due Summary Report"})}),e.jsxs(Xt,{variant:"info",className:"mb-6",children:[e.jsx(ut,{className:"h-4 w-4"}),e.jsx(Zt,{children:"Report Information"}),e.jsx(es,{children:e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"This report shows member package statuses. Approved packages are marked in green, rejected in red, and pending approvals in yellow."}),e.jsx("li",{children:"The package data includes the package name, status, and total amount if applicable."}),e.jsx("li",{children:"The amount shows the total for each package if available if the respective user chooses to pay for the package."}),e.jsx("li",{children:"N/A indicates no data available for that package as the user need not pay for the package."})]})})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(je,{value:l,onValueChange:T,children:[e.jsx(ve,{className:"w-[180px]",children:e.jsx(be,{placeholder:"Select Term"})}),e.jsx(we,{children:e.jsxs(Ie,{children:[e.jsx(Le,{children:"Term"}),i.map(t=>e.jsx(Ce,{value:t.termId||t.id,children:t.termName||t.name||t.termId},t.termId||t.id))]})})]}),e.jsxs(je,{value:g,onValueChange:P,children:[e.jsx(ve,{className:"w-[180px]",children:e.jsx(be,{placeholder:"Select Package Parent"})}),e.jsx(we,{children:e.jsxs(Ie,{children:[e.jsx(Le,{children:"Package Parent"}),N.map(t=>e.jsx(Ce,{value:t,children:t},t))]})})]}),e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",onClick:async()=>{if(!(!(o!=null&&o.chapterId)||!l))try{const t=await le.get(`/api/report/${o.chapterId}/all-members-excel?termId=${l}`,{responseType:"blob"}),s=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=s,n.setAttribute("download","all-members-report.xlsx"),document.body.appendChild(n),n.click(),n.parentNode.removeChild(n),window.URL.revokeObjectURL(s)}catch(t){console.error("Failed to download Excel file:",t)}},disabled:!l,children:"Export to Excel"})]}),C&&e.jsx("div",{className:"rounded-md border",children:e.jsx(fs,{data:h,columns:C,searchInputField:"firstName",totalRecord:p,pagination:{pageSize:A,pageIndex:j},state:{pagination:{pageSize:A,pageIndex:j}}})})]})},Bs=()=>{const{chapterData:r}=Fe(),[h,c]=d.useState([]),[o,p]=d.useState([]),[a,v]=d.useState(null),[C,b]=d.useState(!1),[i,u]=d.useState(""),[N,y]=d.useState([]),[l,T]=d.useState(!1),g=async()=>{try{const j=await le.get("/api/member/all",{params:{chapterId:r==null?void 0:r.chapterId}});c(j.data),p(j.data)}catch{se.error("Error fetching members")}};d.useEffect(()=>{r!=null&&r.chapterId&&g()},[r]),d.useEffect(()=>{a&&A()},[a]);const P=async()=>{if(!a){se.error("Please select a member");return}try{const j=await le.get(`/api/report/${r==null?void 0:r.chapterId}/member-ledger`,{params:{memberId:a.value},responseType:"blob"});if(j.status!==200){se.error("Error exporting data");return}se.success("Data exported successfully");const _=window.URL.createObjectURL(new Blob([j.data])),Y=document.createElement("a");Y.href=_,Y.setAttribute("download",`${a.label} - ${new Date().toLocaleString()} - Member Ledger.xlsx`),document.body.appendChild(Y),Y.click(),Y.remove()}catch(j){se.error("Error exporting data"),console.error("Error exporting data:",j)}},A=async()=>{if(a){T(!0),y([]);try{const j=await le.get(`/api/report/${r==null?void 0:r.chapterId}/member-ledger-json`,{params:{memberId:a.value}});y(j.data),T(!1)}catch{se.error("Error fetching ledger data"),T(!1)}}};return!r||!(r!=null&&r.chapterId)?null:e.jsxs("div",{className:"flex flex-col gap-4 mt-5",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(rs,{members:h,selectedMember:a,setSelectedMember:v}),e.jsx(re,{onClick:P,children:"Export Data"})]}),l?e.jsx(Pe,{className:"h-10 w-full mb-4"}):a?e.jsx(ts,{data:N,columns:ss,searchInputField:"firstName",totalRecord:0,pagination:{pageSize:10,pageIndex:0},state:{pagination:{pageSize:10,pageIndex:0}}}):null]})};function Hs({table:r,totalRecord:h}){return e.jsxs("div",{className:"flex flex-col items-center justify-between space-y-4 px-2 lg:flex-row lg:space-y-0",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-2 sm:flex-row sm:space-x-6 sm:space-y-0",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[r.getFilteredRowModel().rows.length," row(s)."]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Rows per page"}),e.jsxs(je,{value:`${r.getState().pagination.pageSize}`,onValueChange:c=>{r.setPageSize(Number(c))},children:[e.jsx(ve,{className:"h-8 w-[70px]",children:e.jsx(be,{placeholder:r.getState().pagination.pageSize})}),e.jsx(we,{side:"top",children:[5,10,20,30,40,50].map(c=>e.jsx(Ce,{value:`${c}`,children:c},c))})]})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Total Record: ",h]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center justify-center text-sm font-medium",children:["Page ",r.getState().pagination.pageIndex+1," of ",r.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(re,{variant:"outline",className:"h-8 w-8 p-0",disabled:!r.getCanPreviousPage(),onClick:()=>r.setPageIndex(0),children:[e.jsx("span",{className:"sr-only",children:"Go to first page"}),e.jsx(bt,{className:"h-4 w-4"})]}),e.jsxs(re,{variant:"outline",className:"h-8 w-8 p-0",disabled:!r.getCanPreviousPage(),onClick:r.previousPage,children:[e.jsx("span",{className:"sr-only",children:"Go to previous page"}),e.jsx(wt,{className:"h-4 w-4"})]}),e.jsxs(re,{variant:"outline",className:"h-8 w-8 p-0",disabled:!r.getCanNextPage(),onClick:r.nextPage,children:[e.jsx("span",{className:"sr-only",children:"Go to next page"}),e.jsx(Ct,{className:"h-4 w-4"})]}),e.jsxs(re,{variant:"outline",className:"h-8 w-8 p-0",disabled:!r.getCanNextPage(),onClick:()=>r.setPageIndex(r.getPageCount()-1),children:[e.jsx("span",{className:"sr-only",children:"Go to last page"}),e.jsx(Nt,{className:"h-4 w-4"})]})]})]})]})}function $s({columns:r,data:h,searchInputField:c,filterField:o,filterFieldName:p,filterCategoriesList:a,totalRecord:v,children:C}){var A;const b=ft(),{rows:i,onPaginationChange:u,page:N,pagination:y}=gt(),l=ze(),T=()=>{const j=new URLSearchParams(l.search),_=vt({rows:i,page:N},j);b(`?${_}`,{replace:!0})};d.useEffect(()=>{T()},[i,N]);const g=yt({data:h,columns:r,getCoreRowModel:jt(),manualPagination:!0,onPaginationChange:u,state:{pagination:y},rowCount:v}),P=d.Children.map(C,j=>d.isValidElement(j)?d.cloneElement(j,{table:g,searchInputField:c,filterField:o,filterFieldName:p,filterCategoriesList:a}):j);return e.jsxs("div",{className:"space-y-4",children:[P,e.jsx("div",{className:"overflow-y-auto rounded-md border",children:e.jsxs(Ae,{children:[e.jsx(Oe,{children:g.getHeaderGroups().map(j=>e.jsx(oe,{children:j.headers.map(_=>e.jsx(V,{className:"px-4 py-2 bg-newprimaryColor text-white font-raleway",colSpan:_.colSpan,children:_.isPlaceholder?null:$e(_.column.columnDef.header,_.getContext())},_.id))},j.id))}),e.jsx(Me,{className:"bg-adminBreadCrumbsBg font-raleway",children:(A=g.getRowModel().rows)!=null&&A.length?g.getRowModel().rows.map(j=>e.jsx(oe,{"data-state":j.getIsSelected()&&"selected",children:j.getVisibleCells().map(_=>e.jsx(S,{className:"px-4 py-2",children:$e(_.column.columnDef.cell,_.getContext())},_.id))},j.id)):e.jsx(oe,{children:e.jsx(S,{colSpan:r.length,className:"h-24 text-center bg-adminBreadCrumbsBg font-raleway",children:"No results."})})})]})}),e.jsx(Hs,{table:g,totalRecord:v})]})}const pt=[{id:"srno",header:()=>e.jsx("p",{className:!0,children:"Sr. No."}),cell:r=>e.jsx("p",{children:r.row.index+1}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:()=>e.jsx("div",{className:!0,children:"Member Name"}),cell:({row:r})=>e.jsxs("p",{className:"text-sm font-medium",children:[r.original.firstName," ",r.original.lastName]}),enableSorting:!1,enableHiding:!1},{accessorKey:"paidAmount",header:()=>e.jsx("div",{className:!0,children:"Amount Paid"}),cell:({row:r})=>e.jsx("p",{className:"text-sm font-medium",children:r.original.paidAmount}),enableSorting:!1,enableHiding:!1},{accessorKey:"balanceAmount",header:()=>e.jsx("div",{className:!0,children:"Balance"}),cell:({row:r})=>e.jsx("p",{className:"text-sm font-medium",children:r.original.balanceAmount}),enableSorting:!1,enableHiding:!1},{accessorKey:"packageName",header:()=>e.jsx("div",{className:!0,children:"Package Name"}),cell:({row:r})=>e.jsx("p",{className:"text-sm font-medium",children:r.original.packageName}),enableSorting:!1,enableHiding:!1},{accessorKey:"paymentType",header:()=>e.jsx("div",{className:!0,children:"Payment Type"}),cell:({row:r})=>e.jsx("p",{className:"text-sm font-medium",children:r.original.paymentType}),enableSorting:!1,enableHiding:!1},{accessorKey:"paymentReceivedByName",header:()=>e.jsx("div",{className:!0,children:"Collected By"}),cell:({row:r})=>e.jsx("p",{className:"text-sm font-medium",children:r.original.paymentReceivedByName}),enableSorting:!1,enableHiding:!1},{accessorKey:"approvedByName",header:()=>e.jsx("div",{className:!0,children:"Approved By"}),cell:({row:r})=>e.jsx("p",{className:"text-sm font-medium",children:r.original.approvedByName}),enableSorting:!1,enableHiding:!1},{accessorKey:"transactionDate",header:()=>e.jsx("div",{className:!0,children:"Date"}),cell:({row:r})=>{const h=new Date(r.original.transactionDate);return e.jsx("p",{className:"text-sm font-medium",children:as(h)})},enableSorting:!1,enableHiding:!1},{accessorKey:"approvalStatus",header:()=>e.jsx("div",{className:!0,children:"Approval Status"}),cell:({row:r})=>e.jsx("p",{className:"text-sm font-medium",children:r.original.approvalStatus})}];var zs={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(r,h){((c,o)=>{r.exports=o()})(Se,function c(){var o=typeof self<"u"?self:typeof window<"u"?window:o!==void 0?o:{},p,a=!o.document&&!!o.postMessage,v=o.IS_PAPA_WORKER||!1,C={},b=0,i={};function u(t){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(s){var n=ce(s);n.chunkSize=parseInt(n.chunkSize),s.step||s.chunk||(n.chunkSize=null),this._handle=new g(n),(this._handle.streamer=this)._config=n}).call(this,t),this.parseChunk=function(s,n){var f=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<f){let R=this._config.newline;R||(m=this._config.quoteChar||'"',R=this._handle.guessLineEndings(s,m)),s=[...s.split(R).slice(f)].join(R)}this.isFirstChunk&&x(this._config.beforeFirstChunk)&&(m=this._config.beforeFirstChunk(s))!==void 0&&(s=m),this.isFirstChunk=!1,this._halted=!1;var f=this._partialLine+s,m=(this._partialLine="",this._handle.parse(f,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(s=m.meta.cursor,f=(this._finished||(this._partialLine=f.substring(s-this._baseIndex),this._baseIndex=s),m&&m.data&&(this._rowCount+=m.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),v)o.postMessage({results:m,workerId:i.WORKER_ID,finished:f});else if(x(this._config.chunk)&&!n){if(this._config.chunk(m,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=m=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(m.data),this._completeResults.errors=this._completeResults.errors.concat(m.errors),this._completeResults.meta=m.meta),this._completed||!f||!x(this._config.complete)||m&&m.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),f||m&&m.meta.paused||this._nextChunk(),m}this._halted=!0},this._sendError=function(s){x(this._config.error)?this._config.error(s):v&&this._config.error&&o.postMessage({workerId:i.WORKER_ID,error:s,finished:!1})}}function N(t){var s;(t=t||{}).chunkSize||(t.chunkSize=i.RemoteChunkSize),u.call(this,t),this._nextChunk=a?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(n){this._input=n,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(s=new XMLHttpRequest,this._config.withCredentials&&(s.withCredentials=this._config.withCredentials),a||(s.onload=ee(this._chunkLoaded,this),s.onerror=ee(this._chunkError,this)),s.open(this._config.downloadRequestBody?"POST":"GET",this._input,!a),this._config.downloadRequestHeaders){var n,f=this._config.downloadRequestHeaders;for(n in f)s.setRequestHeader(n,f[n])}var m;this._config.chunkSize&&(m=this._start+this._config.chunkSize-1,s.setRequestHeader("Range","bytes="+this._start+"-"+m));try{s.send(this._config.downloadRequestBody)}catch(R){this._chunkError(R.message)}a&&s.status===0&&this._chunkError()}},this._chunkLoaded=function(){s.readyState===4&&(s.status<200||400<=s.status?this._chunkError():(this._start+=this._config.chunkSize||s.responseText.length,this._finished=!this._config.chunkSize||this._start>=(n=>(n=n.getResponseHeader("Content-Range"))!==null?parseInt(n.substring(n.lastIndexOf("/")+1)):-1)(s),this.parseChunk(s.responseText)))},this._chunkError=function(n){n=s.statusText||n,this._sendError(new Error(n))}}function y(t){(t=t||{}).chunkSize||(t.chunkSize=i.LocalChunkSize),u.call(this,t);var s,n,f=typeof FileReader<"u";this.stream=function(m){this._input=m,n=m.slice||m.webkitSlice||m.mozSlice,f?((s=new FileReader).onload=ee(this._chunkLoaded,this),s.onerror=ee(this._chunkError,this)):s=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var m=this._input,R=(this._config.chunkSize&&(R=Math.min(this._start+this._config.chunkSize,this._input.size),m=n.call(m,this._start,R)),s.readAsText(m,this._config.encoding));f||this._chunkLoaded({target:{result:R}})},this._chunkLoaded=function(m){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(m.target.result)},this._chunkError=function(){this._sendError(s.error)}}function l(t){var s;u.call(this,t=t||{}),this.stream=function(n){return s=n,this._nextChunk()},this._nextChunk=function(){var n,f;if(!this._finished)return n=this._config.chunkSize,s=n?(f=s.substring(0,n),s.substring(n)):(f=s,""),this._finished=!s,this.parseChunk(f)}}function T(t){u.call(this,t=t||{});var s=[],n=!0,f=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(m){this._input=m,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){f&&s.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),s.length?this.parseChunk(s.shift()):n=!0},this._streamData=ee(function(m){try{s.push(typeof m=="string"?m:m.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(s.shift()))}catch(R){this._streamError(R)}},this),this._streamError=ee(function(m){this._streamCleanUp(),this._sendError(m)},this),this._streamEnd=ee(function(){this._streamCleanUp(),f=!0,this._streamData("")},this),this._streamCleanUp=ee(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function g(t){var s,n,f,m,R=Math.pow(2,53),$=-R,U=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,ie=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,O=this,K=0,k=0,ae=!1,I=!1,M=[],w={data:[],errors:[],meta:{}};function J(D){return t.skipEmptyLines==="greedy"?D.join("").trim()==="":D.length===1&&D[0].length===0}function Q(){if(w&&f&&(ue("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+i.DefaultDelimiter+"'"),f=!1),t.skipEmptyLines&&(w.data=w.data.filter(function(E){return!J(E)})),te()){let E=function(W,X){x(t.transformHeader)&&(W=t.transformHeader(W,X)),M.push(W)};if(w)if(Array.isArray(w.data[0])){for(var D=0;te()&&D<w.data.length;D++)w.data[D].forEach(E);w.data.splice(0,1)}else w.data.forEach(E)}function B(E,W){for(var X=t.header?{}:[],H=0;H<E.length;H++){var z=H,F=E[H],F=((he,L)=>(q=>(t.dynamicTypingFunction&&t.dynamicTyping[q]===void 0&&(t.dynamicTyping[q]=t.dynamicTypingFunction(q)),(t.dynamicTyping[q]||t.dynamicTyping)===!0))(he)?L==="true"||L==="TRUE"||L!=="false"&&L!=="FALSE"&&((q=>{if(U.test(q)&&(q=parseFloat(q),$<q&&q<R))return 1})(L)?parseFloat(L):ie.test(L)?new Date(L):L===""?null:L):L)(z=t.header?H>=M.length?"__parsed_extra":M[H]:z,F=t.transform?t.transform(F,z):F);z==="__parsed_extra"?(X[z]=X[z]||[],X[z].push(F)):X[z]=F}return t.header&&(H>M.length?ue("FieldMismatch","TooManyFields","Too many fields: expected "+M.length+" fields but parsed "+H,k+W):H<M.length&&ue("FieldMismatch","TooFewFields","Too few fields: expected "+M.length+" fields but parsed "+H,k+W)),X}var G;w&&(t.header||t.dynamicTyping||t.transform)&&(G=1,!w.data.length||Array.isArray(w.data[0])?(w.data=w.data.map(B),G=w.data.length):w.data=B(w.data,0),t.header&&w.meta&&(w.meta.fields=M),k+=G)}function te(){return t.header&&M.length===0}function ue(D,B,G,E){D={type:D,code:B,message:G},E!==void 0&&(D.row=E),w.errors.push(D)}x(t.step)&&(m=t.step,t.step=function(D){w=D,te()?Q():(Q(),w.data.length!==0&&(K+=D.data.length,t.preview&&K>t.preview?n.abort():(w.data=w.data[0],m(w,O))))}),this.parse=function(D,B,G){var E=t.quoteChar||'"',E=(t.newline||(t.newline=this.guessLineEndings(D,E)),f=!1,t.delimiter?x(t.delimiter)&&(t.delimiter=t.delimiter(D),w.meta.delimiter=t.delimiter):((E=((W,X,H,z,F)=>{var he,L,q,ye;F=F||[",","	","|",";",i.RECORD_SEP,i.UNIT_SEP];for(var Ne=0;Ne<F.length;Ne++){for(var me,Ee=F[Ne],ne=0,fe=0,Z=0,de=(q=void 0,new A({comments:z,delimiter:Ee,newline:X,preview:10}).parse(W)),ge=0;ge<de.data.length;ge++)H&&J(de.data[ge])?Z++:(me=de.data[ge].length,fe+=me,q===void 0?q=me:0<me&&(ne+=Math.abs(me-q),q=me));0<de.data.length&&(fe/=de.data.length-Z),(L===void 0||ne<=L)&&(ye===void 0||ye<fe)&&1.99<fe&&(L=ne,he=Ee,ye=fe)}return{successful:!!(t.delimiter=he),bestDelimiter:he}})(D,t.newline,t.skipEmptyLines,t.comments,t.delimitersToGuess)).successful?t.delimiter=E.bestDelimiter:(f=!0,t.delimiter=i.DefaultDelimiter),w.meta.delimiter=t.delimiter),ce(t));return t.preview&&t.header&&E.preview++,s=D,n=new A(E),w=n.parse(s,B,G),Q(),ae?{meta:{paused:!0}}:w||{meta:{paused:!1}}},this.paused=function(){return ae},this.pause=function(){ae=!0,n.abort(),s=x(t.chunk)?"":s.substring(n.getCharIndex())},this.resume=function(){O.streamer._halted?(ae=!1,O.streamer.parseChunk(s,!0)):setTimeout(O.resume,3)},this.aborted=function(){return I},this.abort=function(){I=!0,n.abort(),w.meta.aborted=!0,x(t.complete)&&t.complete(w),s=""},this.guessLineEndings=function(W,E){W=W.substring(0,1048576);var E=new RegExp(P(E)+"([^]*?)"+P(E),"gm"),G=(W=W.replace(E,"")).split("\r"),E=W.split(`
`),W=1<E.length&&E[0].length<G[0].length;if(G.length===1||W)return`
`;for(var X=0,H=0;H<G.length;H++)G[H][0]===`
`&&X++;return X>=G.length/2?`\r
`:"\r"}}function P(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function A(t){var s=(t=t||{}).delimiter,n=t.newline,f=t.comments,m=t.step,R=t.preview,$=t.fastMode,U=null,ie=!1,O=t.quoteChar==null?'"':t.quoteChar,K=O;if(t.escapeChar!==void 0&&(K=t.escapeChar),(typeof s!="string"||-1<i.BAD_DELIMITERS.indexOf(s))&&(s=","),f===s)throw new Error("Comment character same as delimiter");f===!0?f="#":(typeof f!="string"||-1<i.BAD_DELIMITERS.indexOf(f))&&(f=!1),n!==`
`&&n!=="\r"&&n!==`\r
`&&(n=`
`);var k=0,ae=!1;this.parse=function(I,M,w){if(typeof I!="string")throw new Error("Input must be a string");var J=I.length,Q=s.length,te=n.length,ue=f.length,D=x(m),B=[],G=[],E=[],W=k=0;if(!I)return ne();if($||$!==!1&&I.indexOf(O)===-1){for(var X=I.split(n),H=0;H<X.length;H++){if(E=X[H],k+=E.length,H!==X.length-1)k+=n.length;else if(w)return ne();if(!f||E.substring(0,ue)!==f){if(D){if(B=[],ye(E.split(s)),fe(),ae)return ne()}else ye(E.split(s));if(R&&R<=H)return B=B.slice(0,R),ne(!0)}}return ne()}for(var z=I.indexOf(s,k),F=I.indexOf(n,k),he=new RegExp(P(K)+P(O),"g"),L=I.indexOf(O,k);;)if(I[k]===O)for(L=k,k++;;){if((L=I.indexOf(O,L+1))===-1)return w||G.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:B.length,index:k}),me();if(L===J-1)return me(I.substring(k,L).replace(he,O));if(O===K&&I[L+1]===K)L++;else if(O===K||L===0||I[L-1]!==K){z!==-1&&z<L+1&&(z=I.indexOf(s,L+1));var q=Ne((F=F!==-1&&F<L+1?I.indexOf(n,L+1):F)===-1?z:Math.min(z,F));if(I.substr(L+1+q,Q)===s){E.push(I.substring(k,L).replace(he,O)),I[k=L+1+q+Q]!==O&&(L=I.indexOf(O,k)),z=I.indexOf(s,k),F=I.indexOf(n,k);break}if(q=Ne(F),I.substring(L+1+q,L+1+q+te)===n){if(E.push(I.substring(k,L).replace(he,O)),Ee(L+1+q+te),z=I.indexOf(s,k),L=I.indexOf(O,k),D&&(fe(),ae))return ne();if(R&&B.length>=R)return ne(!0);break}G.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:B.length,index:k}),L++}}else if(f&&E.length===0&&I.substring(k,k+ue)===f){if(F===-1)return ne();k=F+te,F=I.indexOf(n,k),z=I.indexOf(s,k)}else if(z!==-1&&(z<F||F===-1))E.push(I.substring(k,z)),k=z+Q,z=I.indexOf(s,k);else{if(F===-1)break;if(E.push(I.substring(k,F)),Ee(F+te),D&&(fe(),ae))return ne();if(R&&B.length>=R)return ne(!0)}return me();function ye(Z){B.push(Z),W=k}function Ne(Z){var de=0;return de=Z!==-1&&(Z=I.substring(L+1,Z))&&Z.trim()===""?Z.length:de}function me(Z){return w||(Z===void 0&&(Z=I.substring(k)),E.push(Z),k=J,ye(E),D&&fe()),ne()}function Ee(Z){k=Z,ye(E),E=[],F=I.indexOf(n,k)}function ne(Z){if(t.header&&!M&&B.length&&!ie){var de=B[0],ge=Object.create(null),Ge=new Set(de);let it=!1;for(let _e=0;_e<de.length;_e++){let xe=de[_e];if(ge[xe=x(t.transformHeader)?t.transformHeader(xe,_e):xe]){let Te,lt=ge[xe];for(;Te=xe+"_"+lt,lt++,Ge.has(Te););Ge.add(Te),de[_e]=Te,ge[xe]++,it=!0,(U=U===null?{}:U)[Te]=xe}else ge[xe]=1,de[_e]=xe;Ge.add(xe)}it&&console.warn("Duplicate headers found and renamed."),ie=!0}return{data:B,errors:G,meta:{delimiter:s,linebreak:n,aborted:ae,truncated:!!Z,cursor:W+(M||0),renamedHeaders:U}}}function fe(){m(ne()),B=[],G=[]}},this.abort=function(){ae=!0},this.getCharIndex=function(){return k}}function j(t){var s=t.data,n=C[s.workerId],f=!1;if(s.error)n.userError(s.error,s.file);else if(s.results&&s.results.data){var m={abort:function(){f=!0,_(s.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Y,resume:Y};if(x(n.userStep)){for(var R=0;R<s.results.data.length&&(n.userStep({data:s.results.data[R],errors:s.results.errors,meta:s.results.meta},m),!f);R++);delete s.results}else x(n.userChunk)&&(n.userChunk(s.results,m,s.file),delete s.results)}s.finished&&!f&&_(s.workerId,s.results)}function _(t,s){var n=C[t];x(n.userComplete)&&n.userComplete(s),n.terminate(),delete C[t]}function Y(){throw new Error("Not implemented.")}function ce(t){if(typeof t!="object"||t===null)return t;var s,n=Array.isArray(t)?[]:{};for(s in t)n[s]=ce(t[s]);return n}function ee(t,s){return function(){t.apply(s,arguments)}}function x(t){return typeof t=="function"}return i.parse=function(t,s){var n=(s=s||{}).dynamicTyping||!1;if(x(n)&&(s.dynamicTypingFunction=n,n={}),s.dynamicTyping=n,s.transform=!!x(s.transform)&&s.transform,!s.worker||!i.WORKERS_SUPPORTED)return n=null,i.NODE_STREAM_INPUT,typeof t=="string"?(t=(f=>f.charCodeAt(0)!==65279?f:f.slice(1))(t),n=new(s.download?N:l)(s)):t.readable===!0&&x(t.read)&&x(t.on)?n=new T(s):(o.File&&t instanceof File||t instanceof Object)&&(n=new y(s)),n.stream(t);(n=(()=>{var f;return!!i.WORKERS_SUPPORTED&&(f=(()=>{var m=o.URL||o.webkitURL||null,R=c.toString();return i.BLOB_URL||(i.BLOB_URL=m.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",R,")();"],{type:"text/javascript"})))})(),(f=new o.Worker(f)).onmessage=j,f.id=b++,C[f.id]=f)})()).userStep=s.step,n.userChunk=s.chunk,n.userComplete=s.complete,n.userError=s.error,s.step=x(s.step),s.chunk=x(s.chunk),s.complete=x(s.complete),s.error=x(s.error),delete s.worker,n.postMessage({input:t,config:s,workerId:n.id})},i.unparse=function(t,s){var n=!1,f=!0,m=",",R=`\r
`,$='"',U=$+$,ie=!1,O=null,K=!1,k=((()=>{if(typeof s=="object"){if(typeof s.delimiter!="string"||i.BAD_DELIMITERS.filter(function(M){return s.delimiter.indexOf(M)!==-1}).length||(m=s.delimiter),typeof s.quotes!="boolean"&&typeof s.quotes!="function"&&!Array.isArray(s.quotes)||(n=s.quotes),typeof s.skipEmptyLines!="boolean"&&typeof s.skipEmptyLines!="string"||(ie=s.skipEmptyLines),typeof s.newline=="string"&&(R=s.newline),typeof s.quoteChar=="string"&&($=s.quoteChar),typeof s.header=="boolean"&&(f=s.header),Array.isArray(s.columns)){if(s.columns.length===0)throw new Error("Option columns is empty");O=s.columns}s.escapeChar!==void 0&&(U=s.escapeChar+$),s.escapeFormulae instanceof RegExp?K=s.escapeFormulae:typeof s.escapeFormulae=="boolean"&&s.escapeFormulae&&(K=/^[=+\-@\t\r].*$/)}})(),new RegExp(P($),"g"));if(typeof t=="string"&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return ae(null,t,ie);if(typeof t[0]=="object")return ae(O||Object.keys(t[0]),t,ie)}else if(typeof t=="object")return typeof t.data=="string"&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields||O),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:typeof t.data[0]=="object"?Object.keys(t.data[0]):[]),Array.isArray(t.data[0])||typeof t.data[0]=="object"||(t.data=[t.data])),ae(t.fields||[],t.data||[],ie);throw new Error("Unable to serialize unrecognized input");function ae(M,w,J){var Q="",te=(typeof M=="string"&&(M=JSON.parse(M)),typeof w=="string"&&(w=JSON.parse(w)),Array.isArray(M)&&0<M.length),ue=!Array.isArray(w[0]);if(te&&f){for(var D=0;D<M.length;D++)0<D&&(Q+=m),Q+=I(M[D],D);0<w.length&&(Q+=R)}for(var B=0;B<w.length;B++){var G=(te?M:w[B]).length,E=!1,W=te?Object.keys(w[B]).length===0:w[B].length===0;if(J&&!te&&(E=J==="greedy"?w[B].join("").trim()==="":w[B].length===1&&w[B][0].length===0),J==="greedy"&&te){for(var X=[],H=0;H<G;H++){var z=ue?M[H]:H;X.push(w[B][z])}E=X.join("").trim()===""}if(!E){for(var F=0;F<G;F++){0<F&&!W&&(Q+=m);var he=te&&ue?M[F]:F;Q+=I(w[B][he],F)}B<w.length-1&&(!J||0<G&&!W)&&(Q+=R)}}return Q}function I(M,w){var J,Q;return M==null?"":M.constructor===Date?JSON.stringify(M).slice(1,25):(Q=!1,K&&typeof M=="string"&&K.test(M)&&(M="'"+M,Q=!0),J=M.toString().replace(k,U),(Q=Q||n===!0||typeof n=="function"&&n(M,w)||Array.isArray(n)&&n[w]||((te,ue)=>{for(var D=0;D<ue.length;D++)if(-1<te.indexOf(ue[D]))return!0;return!1})(J,i.BAD_DELIMITERS)||-1<J.indexOf(m)||J.charAt(0)===" "||J.charAt(J.length-1)===" ")?$+J+$:J)}},i.RECORD_SEP="",i.UNIT_SEP="",i.BYTE_ORDER_MARK="\uFEFF",i.BAD_DELIMITERS=["\r",`
`,'"',i.BYTE_ORDER_MARK],i.WORKERS_SUPPORTED=!a&&!!o.Worker,i.NODE_STREAM_INPUT=1,i.LocalChunkSize=10485760,i.RemoteChunkSize=5242880,i.DefaultDelimiter=",",i.Parser=A,i.ParserHandle=g,i.NetworkStreamer=N,i.FileStreamer=y,i.StringStreamer=l,i.ReadableStreamStreamer=T,o.jQuery&&((p=o.jQuery).fn.parse=function(t){var s=t.config||{},n=[];return this.each(function(R){if(!(p(this).prop("tagName").toUpperCase()==="INPUT"&&p(this).attr("type").toLowerCase()==="file"&&o.FileReader)||!this.files||this.files.length===0)return!0;for(var $=0;$<this.files.length;$++)n.push({file:this.files[$],inputElem:this,instanceConfig:p.extend({},s)})}),f(),this;function f(){if(n.length===0)x(t.complete)&&t.complete();else{var R,$,U,ie,O=n[0];if(x(t.before)){var K=t.before(O.file,O.inputElem);if(typeof K=="object"){if(K.action==="abort")return R="AbortError",$=O.file,U=O.inputElem,ie=K.reason,void(x(t.error)&&t.error({name:R},$,U,ie));if(K.action==="skip")return void m();typeof K.config=="object"&&(O.instanceConfig=p.extend(O.instanceConfig,K.config))}else if(K==="skip")return void m()}var k=O.instanceConfig.complete;O.instanceConfig.complete=function(ae){x(k)&&k(ae,O.file,O.inputElem),m()},i.parse(O.file,O.instanceConfig)}}function m(){n.splice(0,1),f()}}),v&&(o.onmessage=function(t){t=t.data,i.WORKER_ID===void 0&&t&&(i.WORKER_ID=t.workerId),typeof t.input=="string"?o.postMessage({workerId:i.WORKER_ID,results:i.parse(t.input,t.config),finished:!0}):(o.File&&t.input instanceof File||t.input instanceof Object)&&(t=i.parse(t.input,t.config))&&o.postMessage({workerId:i.WORKER_ID,results:t,finished:!0})}),(N.prototype=Object.create(u.prototype)).constructor=N,(y.prototype=Object.create(u.prototype)).constructor=y,(l.prototype=Object.create(l.prototype)).constructor=l,(T.prototype=Object.create(u.prototype)).constructor=T,i})})(zs);const Ks=()=>{const r=ze(),[h,c]=d.useState([]),[o,p]=d.useState(!0),{chapterData:a}=Fe(),v=new URLSearchParams(r.search),[C,b]=d.useState(null),i=v.get("rows")||5,u=v.get("page")||1,[N,y]=d.useState(!1),[l,T]=d.useState(null),[g,P]=d.useState(null),A=pt.map(({accessorKey:t,header:s})=>({label:s().props.children,key:t})),[j,_]=d.useState(A.map(({label:t})=>t));d.useEffect(()=>{console.log("helo"),a&&Y()},[a,i,u,r.search]);const Y=()=>{a.chapterId&&(console.log("helo 2"),le.get(`/api/report/${a.chapterId}/member-transactions-json-report?rows=${i}&page=${u}  `,{params:{chapterId:a.chapterId,rows:i,page:u}}).then(t=>{c(t.data.data),b(t.data.totalRecords),p(!1)}).catch(t=>{console.error("Error fetching reports:",t),p(!1)}))},ce=t=>{_(s=>s.includes(t)?s.filter(n=>n!==t):[...s,t])},ee=async()=>{const t=A.filter(({label:s})=>j.includes(s)).map(({key:s})=>s);try{const s=await le.post(`/api/report/${a.chapterId}/member-transactions-report`,{startDate:l,endDate:g,type:"excel",selectedColumns:t,chapterId:a.chapterId},{responseType:"blob"}),n=new Blob([s.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),f=window.URL.createObjectURL(n),m=document.createElement("a");m.href=f,m.setAttribute("download",`Member Transactions Report ${pe(new Date(l),"dd/MM/yyyy")} - ${pe(new Date(g),"dd/MM/yyyy")}.xlsx`),document.body.appendChild(m),m.click(),document.body.removeChild(m),window.URL.revokeObjectURL(f),se.success("Excel file downloaded successfully.")}catch(s){console.error("Error exporting Excel:",s),se.error("Failed to export Excel. Please try again later.")}},x=async()=>{var n,f;y(!1);const t=A.filter(({label:m})=>j.includes(m)).map(({key:m})=>m),s={startDate:l,endDate:g,type:"pdf",selectedColumns:t,chapterId:a.chapterId};try{const m=await le.post(`/api/report/${a.chapterId}/member-transactions-report`,s,{responseType:"blob"}),R=new Blob([m.data],{type:"application/pdf"}),$=window.URL.createObjectURL(R),U=document.createElement("a");U.href=$,U.setAttribute("download",`Member Transactions Report ${pe(new Date(l),"dd/MM/yyyy")} - ${pe(new Date(g),"dd/MM/yyyy")}.pdf`),document.body.appendChild(U),U.click(),document.body.removeChild(U),window.URL.revokeObjectURL($),se.success("PDF file downloaded successfully.")}catch(m){console.error("Error exporting PDF:",m),se.error(((f=(n=m.response)==null?void 0:n.data)==null?void 0:f.error)||"Failed to export PDF")}};return e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Member Transactions Report"}),e.jsxs("div",{className:"mb-4 p-4 border rounded-md bg-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Select Columns to Export"}),e.jsx("div",{className:"flex flex-wrap gap-4",children:A.map(({label:t})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ns,{checked:j.includes(t),onCheckedChange:()=>ce(t)}),e.jsx("label",{className:"text-sm",children:t})]},t))})]}),e.jsx("div",{className:"flex gap-4 mb-4",children:e.jsxs(os,{open:N,onOpenChange:y,children:[e.jsx(is,{asChild:!0,children:e.jsx(re,{className:"bg-blue-600 text-white",children:"Export"})}),e.jsxs(ls,{children:[e.jsx(cs,{children:e.jsx(ds,{children:"Export Options"})}),e.jsxs("div",{className:"flex flex-col gap-4 py-4",children:[e.jsxs("div",{children:[e.jsx(Je,{htmlFor:"fromDate",children:"From Date"}),e.jsxs(Xe,{children:[e.jsx(Ze,{asChild:!0,children:e.jsxs(re,{variant:"outline",className:Ye("w-full justify-start text-left font-normal",!l&&"text-muted-foreground"),children:[e.jsx(st,{className:"mr-2 h-4 w-4"}),l?pe(new Date(l),"PPP"):"Pick a date"]})}),e.jsx(et,{className:"w-auto p-0",children:e.jsx(tt,{mode:"single",selected:l,onSelect:T,initialFocus:!0,disabled:t=>t>new Date})})]})]}),e.jsxs("div",{children:[e.jsx(Je,{htmlFor:"toDate",children:"To Date"}),e.jsxs(Xe,{children:[e.jsx(Ze,{asChild:!0,children:e.jsxs(re,{variant:"outline",className:Ye("w-full justify-start text-left font-normal",!g&&"text-muted-foreground"),children:[e.jsx(st,{className:"mr-2 h-4 w-4"}),g?pe(new Date(g),"PPP"):"Pick a date"]})}),e.jsx(et,{className:"w-auto p-0",children:e.jsx(tt,{mode:"single",selected:g,onSelect:P,initialFocus:!0,disabled:t=>t>new Date})})]})]})]}),e.jsxs(us,{className:"flex justify-between gap-2",children:[e.jsx(re,{onClick:x,className:"bg-red-500 text-white",disabled:!l||!g,children:"Export PDF"}),e.jsx(re,{onClick:()=>{y(!1),ee()},className:"bg-green-700 text-white",disabled:!l||!g,children:"Export Excel"})]})]})]})}),o?e.jsx("p",{className:"text-gray-600",children:"Loading..."}):h.length===0?e.jsx("p",{className:"text-gray-600",children:"No reports available."}):e.jsx($s,{data:h,columns:pt,searchInputField:"firstName",totalRecord:C,pagination:{pageSize:i,pageIndex:u},state:{pagination:{pageSize:i,pageIndex:u}}})]})},qs=()=>{const{chapterData:r}=Fe(),[h,c]=d.useState(new Date),[o,p]=d.useState(!1),[a,v]=d.useState(null),[C,b]=d.useState(!1),[i,u]=d.useState(null),N=async()=>{try{b(!0),u(null);const l=pe(h,"yyyy-MM-dd"),T=await le.get(`/api/report/${r==null?void 0:r.chapterId}/receiver-daywise-json-report`,{params:{date:l}});v(T.data)}catch(l){u(l.message||"An unknown error occurred"),se.error("Error fetching data")}finally{b(!1)}},y=async()=>{try{const l=pe(h,"yyyy-MM-dd"),T=await le.get(`/api/report/${r==null?void 0:r.chapterId}/receiver-daywise-report`,{params:{date:l},responseType:"blob"});if(T.status!==200){se.error("Error exporting data");return}se.success("Data exported successfully");const g=window.URL.createObjectURL(new Blob([T.data])),P=document.createElement("a");P.href=g,P.setAttribute("download",`ReceiverDaywiseReport-${l}.xlsx`),document.body.appendChild(P),P.click(),P.remove()}catch(l){se.error("Error exporting data"),console.error("Error exporting data:",l)}};return d.useEffect(()=>{r!=null&&r.chapterId&&N()},[h,r]),e.jsxs("div",{className:"flex flex-col gap-4 mt-5",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(Xe,{open:o,onOpenChange:p,children:[e.jsx(Ze,{asChild:!0,children:e.jsxs(re,{variant:"outline",className:"w-[200px] justify-start text-left font-normal",children:[e.jsx(st,{className:"mr-2 h-4 w-4"}),h?pe(h,"PPP"):e.jsx("span",{children:"Select date"})]})}),e.jsx(et,{className:"w-auto p-0",children:e.jsx(tt,{mode:"single",selected:h,onSelect:l=>{c(l||new Date),p(!1)},disabled:l=>l>new Date})})]}),e.jsx(re,{onClick:y,disabled:(a==null?void 0:a.data.transactions.length)===0,children:"Export Data"})]}),C&&e.jsx("div",{className:"space-y-4",children:[...Array(4)].map((l,T)=>e.jsxs(He,{children:[e.jsx(We,{children:e.jsx(Pe,{className:"h-6 w-[200px]"})}),e.jsx(Ve,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(Pe,{className:"h-4 w-full"}),e.jsx(Pe,{className:"h-4 w-full"}),e.jsx(Pe,{className:"h-4 w-full"})]})})]},T))}),i&&e.jsxs("div",{className:"text-red-500",children:["Error: ",i]}),a&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("h1",{className:"text-2xl font-bold",children:["Transaction Report for ",a==null?void 0:a.data.date]}),(a==null?void 0:a.data.transactions.length)===0&&e.jsx("div",{className:"text-center text-lg font-semibold text-gray-500",children:"No transactions found for the selected date."}),a==null?void 0:a.data.transactions.map((l,T)=>e.jsxs(He,{children:[e.jsx(We,{children:e.jsxs(ct,{children:[l.receiverName," (",l.paymentType,")"]})}),e.jsx(Ve,{children:e.jsxs(Ae,{children:[e.jsx(Oe,{children:e.jsxs(oe,{children:[e.jsx(V,{children:"Sr No"}),e.jsx(V,{children:"Receiver Name"}),e.jsx(V,{children:"Member Name"}),e.jsx(V,{children:"Payment Type"}),e.jsx(V,{children:"Paid Amount"}),e.jsx(V,{children:"Receiver Fee"}),e.jsx(V,{children:"Platform Fee"}),e.jsx(V,{children:"Penalty Amount"}),e.jsx(V,{children:"Discount Amount"}),e.jsx(V,{children:"Status"})]})}),e.jsxs(Me,{children:[l.data.map((g,P)=>e.jsxs(oe,{children:[e.jsx(S,{children:P+1}),e.jsx(S,{children:l.receiverName}),e.jsx(S,{children:g.membername}),e.jsx(S,{children:g.paymentType}),e.jsx(S,{children:g.paidAmount}),e.jsx(S,{children:g.receiverFee}),e.jsx(S,{children:g.platformFee}),e.jsx(S,{children:g.penaltyAmount}),e.jsx(S,{children:g.discountAmount}),e.jsx(S,{children:g.status})]},g.memberid)),e.jsxs(oe,{className:"font-bold bg-muted/50",children:[e.jsx(S,{colSpan:3,children:"Total:"}),e.jsx(S,{children:l.paymentType}),e.jsx(S,{children:l.totals.amountPaid}),e.jsx(S,{children:l.totals.receiverFee}),e.jsx(S,{children:l.totals.platformFee}),e.jsx(S,{children:l.totals.penaltyAmount}),e.jsx(S,{children:l.totals.discountAmount}),e.jsx(S,{})]})]})]})})]},`${l.receiverName}-${l.paymentType}-${T}`)),(a==null?void 0:a.data.transactions.length)>0&&e.jsxs(He,{children:[e.jsx(We,{children:e.jsx(ct,{children:"Grand Totals"})}),e.jsx(Ve,{children:e.jsxs(Ae,{children:[e.jsx(Oe,{children:e.jsxs(oe,{children:[e.jsx(V,{children:"Payment Type"}),e.jsx(V,{children:"Paid Amount"}),e.jsx(V,{children:"Receiver Fee"}),e.jsx(V,{children:"Platform Fee"}),e.jsx(V,{children:"Penalty Amount"}),e.jsx(V,{children:"Discount Amount"})]})}),e.jsxs(Me,{children:[e.jsxs(oe,{children:[e.jsx(S,{children:"Cash"}),e.jsx(S,{children:a==null?void 0:a.data.totals.cash.amountPaid}),e.jsx(S,{children:a==null?void 0:a.data.totals.cash.receiverFee}),e.jsx(S,{children:a==null?void 0:a.data.totals.cash.platformFee}),e.jsx(S,{children:a==null?void 0:a.data.totals.cash.penaltyAmount}),e.jsx(S,{children:a==null?void 0:a.data.totals.cash.discountAmount})]}),e.jsxs(oe,{children:[e.jsx(S,{children:"Online"}),e.jsx(S,{children:a==null?void 0:a.data.totals.online.amountPaid}),e.jsx(S,{children:a==null?void 0:a.data.totals.online.receiverFee}),e.jsx(S,{children:a==null?void 0:a.data.totals.online.platformFee}),e.jsx(S,{children:a==null?void 0:a.data.totals.online.penaltyAmount}),e.jsx(S,{children:a==null?void 0:a.data.totals.online.discountAmount})]}),e.jsxs(oe,{className:"font-bold bg-muted/50",children:[e.jsx(S,{children:"Grand Total"}),e.jsx(S,{children:a==null?void 0:a.data.totals.grand.amountPaid}),e.jsx(S,{children:a==null?void 0:a.data.totals.grand.receiverFee}),e.jsx(S,{children:a==null?void 0:a.data.totals.grand.platformFee}),e.jsx(S,{children:a==null?void 0:a.data.totals.grand.penaltyAmount}),e.jsx(S,{children:a==null?void 0:a.data.totals.grand.discountAmount})]})]})]})})]})]})]})};var Gs={exports:{}};(function(r,h){(function(c,o){o()})(Se,function(){function c(i,u){return typeof u>"u"?u={autoBom:!1}:typeof u!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),u={autoBom:!u}),u.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}function o(i,u,N){var y=new XMLHttpRequest;y.open("GET",i),y.responseType="blob",y.onload=function(){b(y.response,u,N)},y.onerror=function(){console.error("could not download file")},y.send()}function p(i){var u=new XMLHttpRequest;u.open("HEAD",i,!1);try{u.send()}catch{}return 200<=u.status&&299>=u.status}function a(i){try{i.dispatchEvent(new MouseEvent("click"))}catch{var u=document.createEvent("MouseEvents");u.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),i.dispatchEvent(u)}}var v=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Se=="object"&&Se.global===Se?Se:void 0,C=v.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),b=v.saveAs||(typeof window!="object"||window!==v?function(){}:"download"in HTMLAnchorElement.prototype&&!C?function(i,u,N){var y=v.URL||v.webkitURL,l=document.createElement("a");u=u||i.name||"download",l.download=u,l.rel="noopener",typeof i=="string"?(l.href=i,l.origin===location.origin?a(l):p(l.href)?o(i,u,N):a(l,l.target="_blank")):(l.href=y.createObjectURL(i),setTimeout(function(){y.revokeObjectURL(l.href)},4e4),setTimeout(function(){a(l)},0))}:"msSaveOrOpenBlob"in navigator?function(i,u,N){if(u=u||i.name||"download",typeof i!="string")navigator.msSaveOrOpenBlob(c(i,N),u);else if(p(i))o(i,u,N);else{var y=document.createElement("a");y.href=i,y.target="_blank",setTimeout(function(){a(y)})}}:function(i,u,N,y){if(y=y||open("","_blank"),y&&(y.document.title=y.document.body.innerText="downloading..."),typeof i=="string")return o(i,u,N);var l=i.type==="application/octet-stream",T=/constructor/i.test(v.HTMLElement)||v.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||l&&T||C)&&typeof FileReader<"u"){var P=new FileReader;P.onloadend=function(){var _=P.result;_=g?_:_.replace(/^data:[^;]*;/,"data:attachment/file;"),y?y.location.href=_:location=_,y=null},P.readAsDataURL(i)}else{var A=v.URL||v.webkitURL,j=A.createObjectURL(i);y?y.location=j:location.href=j,y=null,setTimeout(function(){A.revokeObjectURL(j)},4e4)}});v.saveAs=b.saveAs=b,r.exports=b})})(Gs);const Ws=[{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"},{value:"3monthly",label:"3 Monthly"}],Vs=()=>{const{chapterData:r}=Fe(),[h,c]=d.useState([]),[o,p]=d.useState(""),[a,v]=d.useState("monthly"),[C,b]=d.useState(null),[i,u]=d.useState(!1),[N,y]=d.useState(!1),[l,T]=d.useState(""),[g,P]=d.useState(!1),[A,j]=d.useState(""),[_,Y]=d.useState("");d.useEffect(()=>{r!=null&&r.chapterId&&le.get(`/api/term/chapter/${r.chapterId}`).then(x=>c(x.data)).catch(()=>c([]))},[r]),d.useEffect(()=>{if(!(r!=null&&r.chapterId)||!o&&!g)return;u(!0);const x={period:a,...o&&!g?{termId:o}:{},...g?{startDate:A,endDate:_}:{}};le.get(`/api/report/${r.chapterId}/member-payment-summary-report`,{params:x}).then(t=>b(t.data)).catch(()=>b(null)).finally(()=>u(!1))},[r,o,a,g,A,_]);const ce=C==null?void 0:C.members.map((x,t)=>({...x,idx:t})).filter(x=>x.name.toLowerCase().includes(l.toLowerCase())),ee=async()=>{y(!0);try{const x={period:a,...o&&!g?{termId:o}:{},...g?{startDate:A,endDate:_}:{}},t=await le.get(`/api/report/${r.chapterId}/member-payment-summary-report/export`,{params:x,responseType:"blob"});if(t.status!==200){se.error("Error exporting data");return}se.success("Data exported successfully");const s=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=s,n.setAttribute("download","Member_Payment_Summary_Report.xlsx"),document.body.appendChild(n),n.click(),n.remove()}catch(x){se.error("Error exporting data"),console.error("Error exporting data:",x)}finally{y(!1)}};return e.jsxs("div",{className:"space-y-6 max-w-7xl mx-auto",children:[e.jsx("h2",{className:"text-title-md2 font-semibold text-black dark:text-white",children:"Member Payment Summary Report"}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 items-center",children:[e.jsxs(je,{value:o,onValueChange:p,disabled:g,children:[e.jsx(ve,{className:"w-[180px]",children:e.jsx(be,{placeholder:"Select Term"})}),e.jsx(we,{children:e.jsxs(Ie,{children:[e.jsx(Le,{children:"Term"}),h.map(x=>e.jsx(Ce,{value:x.termId||x.id,children:x.termName||x.name||x.termId},x.termId||x.id))]})})]}),e.jsxs(je,{value:a,onValueChange:v,children:[e.jsx(ve,{className:"w-[180px]",children:e.jsx(be,{placeholder:"Select Period"})}),e.jsx(we,{children:e.jsxs(Ie,{children:[e.jsx(Le,{children:"Period"}),Ws.map(x=>e.jsx(Ce,{value:x.value,children:x.label},x.value))]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Je,{htmlFor:"customRange",children:"Custom Date?"}),e.jsx(hs,{id:"customRange",checked:g,onCheckedChange:P})]}),g&&e.jsxs(e.Fragment,{children:[e.jsx(Qe,{type:"date",value:A,onChange:x=>j(x.target.value)}),e.jsx(Qe,{type:"date",value:_,onChange:x=>Y(x.target.value)})]}),C&&C.periodLabels&&e.jsx("div",{className:"mb-4 flex justify-end",children:e.jsx(re,{variant:"outline",onClick:ee,disabled:N,children:N?e.jsxs(e.Fragment,{children:[e.jsx(dt,{className:"animate-spin w-4 h-4 mr-2 inline"})," ","Exporting..."]}):"Export to Excel"})})]}),e.jsx(Qe,{type:"text",placeholder:"Search member...",value:l,onChange:x=>T(x.target.value),className:"w-full max-w-md"}),i?e.jsxs("div",{className:"flex justify-center items-center py-16 text-muted-foreground",children:[e.jsx(dt,{className:"animate-spin w-6 h-6 mr-2"}),"Loading report..."]}):C&&C.periodLabels?e.jsxs(He,{className:"overflow-auto p-4",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4",children:["Total Transactions (",C.period,")"]}),e.jsx("div",{className:"overflow-y-auto rounded-md border",children:e.jsxs(Ae,{className:"text-sm",children:[e.jsx(Oe,{children:e.jsxs(oe,{children:[e.jsx(V,{children:"Member"}),C.periodLabels.map((x,t)=>{var s;return e.jsx(V,{className:"text-right",children:x.includes("-")?x:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{children:x}),e.jsx("span",{className:"text-xs text-gray-400",children:((s=C.periodDates)==null?void 0:s[t])&&`(${pe(new Date(C.periodDates[t].start),"d MMM")} - ${pe(new Date(C.periodDates[t].end),"d MMM")})`})]})},t)}),e.jsx(V,{className:"text-right font-bold",children:"Total"})]})}),e.jsxs(Me,{children:[(ce??[]).map(({memberId:x,name:t,idx:s})=>e.jsxs(oe,{children:[e.jsx(S,{className:"font-medium",children:t}),C.matrix[s].map((n,f)=>e.jsxs(S,{className:"text-right",children:["₹",n]},f)),e.jsxs(S,{className:"text-right font-bold",children:["₹",C.totals[s]]})]},x)),!l&&e.jsxs(oe,{className:"bg-muted/40 font-semibold",children:[e.jsx(S,{children:"Grand Total"}),C.periodLabels.map((x,t)=>{const s=C.matrix.reduce((n,f)=>n+(f[t]||0),0);return e.jsxs(S,{className:"text-right",children:["₹",s]},t)}),e.jsxs(S,{className:"text-right text-primary",children:["₹",C.grandTotal]})]})]})]})})]}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No data to display. Please select a term or date range and period."})]})},mt=[{label:"Member Wise Report",reports:[{value:"member_due_summary",label:"Member Due Summary Report",component:Us},{value:"member_ledger",label:"Member Ledger",component:Bs},{value:"member_payment_summary_report",label:"Member Payment Summary Report",component:Vs}]},{label:"Chapter Report",reports:[{value:"all_transactions",label:"All Transactions",component:Ks},{value:"receiver_daywise_report",label:"Receiver Daily Report",component:qs}]}],Lr=()=>{const[r,h]=Ut.useState(""),o=mt.flatMap(p=>p.reports).find(p=>p.value===r);return e.jsxs(e.Fragment,{children:[e.jsx(Bt,{items:[{name:"Reports"}]}),e.jsxs("div",{className:"rounded-sm border border-stroke bg-white p-3 shadow-default dark:border-strokedark dark:bg-boxdark sm:px-7.5 xl:pb-1",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h2",{className:"text-lg font-medium dark:text-white",children:"View Your Chapter's Reports"})}),e.jsx("div",{children:e.jsxs(je,{value:r,onValueChange:p=>h(p),className:"w-full",children:[e.jsx(ve,{className:"w-[280px]",children:e.jsx(be,{placeholder:"Select a report type you want to view"})}),e.jsx(we,{children:mt.map(p=>e.jsxs(Ie,{children:[e.jsx(Le,{children:p.label}),p.reports.map(a=>e.jsx(Ce,{value:a.value,children:a.label},a.value))]},p.label))})]})}),o&&e.jsx(o.component,{})]})]})};export{Lr as default};
