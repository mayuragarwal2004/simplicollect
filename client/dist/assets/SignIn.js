import{u as z,a as G,b as R,r as a,j as e,L as U,B as u,c as _}from"./index.js";import{B as H}from"./Breadcrumb.js";import{L as J}from"./logo-dark.js";import{L as K}from"./logo.js";import{P as Q}from"./phone-input.js";import{I as L}from"./input.js";import{L as T}from"./label.js";import{E as V}from"./eye-off.js";import{E as W}from"./eye.js";import"./chevron-right.js";import"./index2.js";import"./command.js";import"./index3.js";import"./index4.js";import"./index5.js";import"./index6.js";import"./dialog.js";import"./search.js";import"./popover.js";import"./index7.js";import"./index8.js";import"./scroll-area.js";import"./index9.js";import"./index10.js";import"./chevrons-up-down.js";const je=()=>{var P;const h=z(),d=G(),{isAuthenticated:y,login:F}=R(),[m,v]=a.useState(((P=d.state)==null?void 0:P.identifier)||""),[c,k]=a.useState(""),[j,N]=a.useState("IN"),[w,x]=a.useState(""),[I,O]=a.useState(!1),[g,p]=a.useState(!1),[A,f]=a.useState(""),[S,n]=a.useState(""),[o,b]=a.useState(!1),[r,B]=a.useState("email");a.useEffect(()=>{var t,s;if(y){const i=((s=(t=d.state)==null?void 0:t.from)==null?void 0:s.pathname)||"/member/fee";h(i,{replace:!0})}},[y,d,h]);const C=t=>{B(t),v(""),k(""),N("IN"),n(""),b(!1),x("")},M=()=>{b(!1),x(""),n("")},q=async t=>{var s;t.preventDefault(),p(!0),n("");try{const i=r==="phone"?c.slice(1):m;if(!i){n("Please enter a valid email or phone number."),p(!1);return}const l=await _.post("/api/auth/check-member",{identifier:i});l.data.exists?l.data.defaultOTP?(f("Sending OTP..."),h("/auth/otp-verification",{state:{identifier:r==="phone"?c:m,from:(s=d.state)==null?void 0:s.from,inputType:r,selectedCountry:j}})):l.data.exists&&!l.data.defaultOTP&&b(!0):n("User does not exist!")}catch{n("Error checking user.")}finally{p(!1),f("")}},D=async()=>{var t;try{p(!0),f("Sending OTP..."),h("/auth/otp-verification",{state:{identifier:r==="phone"?c:m,from:(t=d.state)==null?void 0:t.from,inputType:r,selectedCountry:j}})}catch{n("Error sending OTP.")}finally{p(!1)}},$=async t=>{t.preventDefault();try{const s=r==="phone"?c.slice(1):m;await F(s,w,()=>{var l,E;const i=((E=(l=d.state)==null?void 0:l.from)==null?void 0:E.pathname)||"/member/fee";h(i,{replace:!0})})}catch{n("Invalid email/phone or password.")}};return e.jsxs(e.Fragment,{children:[e.jsx(H,{items:[{name:"Authentication",link:"/auth"},{name:"Sign In"}]}),e.jsxs("div",{className:" flex items-center justify-center flex-col",children:[e.jsx("div",{className:"rounded-sm border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark p-8 max-w-md mx-auto",children:e.jsxs("div",{className:"flex flex-wrap items-center",children:[e.jsxs("div",{className:"w-full text-center mb-6",children:[e.jsxs(U,{to:"/",children:[e.jsx("img",{className:"hidden dark:block mx-auto",src:K,alt:"Logo"}),e.jsx("img",{className:"dark:hidden mx-auto",src:J,alt:"Logo"})]}),e.jsx("p",{className:"mt-3 text-gray-500",children:"Collect and manage meeting fees with ease"})]}),e.jsxs("form",{className:"w-full",onSubmit:o?$:q,children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex rounded-md border border-stroke dark:border-strokedark overflow-hidden",children:[e.jsx(u,{type:"button",variant:"ghost",className:`flex-1 rounded-none transition-colors ${r==="email"?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-50 text-gray-700 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600"}`,onClick:()=>C("email"),disabled:o,children:"Email"}),e.jsx(u,{type:"button",variant:"ghost",className:`flex-1 rounded-none transition-colors ${r==="phone"?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-50 text-gray-700 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600"}`,onClick:()=>C("phone"),disabled:o,children:"Phone"})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx(T,{htmlFor:"identifier",className:"block text-gray-700 dark:text-gray-300 mb-2",children:r==="email"?"Email Address":"Phone Number"}),o&&e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:r==="email"?m:c}),e.jsx(u,{type:"button",variant:"link",className:"h-auto p-0 text-blue-500 hover:underline",onClick:M,children:"Edit"})]}),r==="email"?e.jsx(L,{type:"email",id:"identifier",value:m,onChange:t=>v(t.target.value),placeholder:"Enter your email address",required:!0,disabled:o,autoComplete:"username"}):e.jsx("div",{children:e.jsx(Q,{defaultCountry:"IN",value:c,onChange:t=>k(t||""),onCountryChange:t=>{N(t||"IN")},placeholder:"Enter your phone number",disabled:o,autoComplete:"username"})})]}),o&&e.jsxs("div",{className:"mb-6",children:[e.jsx(T,{htmlFor:"password",className:"block text-gray-700 dark:text-gray-300 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{type:I?"text":"password",id:"password",value:w,onChange:t=>x(t.target.value),className:"pr-10",required:!0,autoComplete:"current-password"}),e.jsx(u,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>O(t=>!t),tabIndex:-1,children:I?e.jsx(V,{className:"h-4 w-4"}):e.jsx(W,{className:"h-4 w-4"})})]})]}),S&&e.jsx("div",{className:"mb-4 p-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md dark:text-red-400 dark:bg-red-900/20 dark:border-red-800",children:S}),e.jsx(u,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white",disabled:g,children:g?A||"Checking...":o?"Sign In":"Continue"})]}),o&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx(u,{type:"button",variant:"link",className:"text-blue-500 hover:underline",disabled:g,onClick:D,children:"Forgot Password?"})})]})}),e.jsxs("div",{className:"mt-6 text-center flex text-gray-500 dark:text-gray-400",children:["A Product by",e.jsx("div",{className:"text-blue-500 hover:underline ml-1",children:e.jsx("a",{href:"https://simpliumtechnologies.com",target:"_blank",rel:"noopener noreferrer",children:"Simplium Technologies"})})]})]})]})};export{je as default};
