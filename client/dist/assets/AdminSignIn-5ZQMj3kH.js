import{u as N,a as y,b as L,r as t,j as e,L as h,c as g}from"./index-eKwCJLll.js";import{B as S}from"./Breadcrumb-kGt-xtkX.js";import{L as P}from"./logo-dark-BHjl3cne.js";import{L as E}from"./logo-ajku0Xcj.js";import"./chevron-right-B55Ri9eq.js";const q=()=>{var x;const i=N(),b=y(),{isAuthenticated:n,login:f}=L(),[r,p]=t.useState(((x=b.state)==null?void 0:x.identifier)||""),[l,k]=t.useState(""),[c,m]=t.useState(!1),[u,d]=t.useState(""),[o,w]=t.useState(!1);t.useEffect(()=>{n&&i("/admin")},[n]);const j=async a=>{a.preventDefault(),m(!0),d("");try{const s=await g.post("/api/auth/check-member",{identifier:r});console.log("Backend response:",s.data),s.data.exists?s.data.defaultOTP?(await g.post("/api/auth/send-otp",{identifier:r}),i("/auth/otp-verification",{state:{identifier:r}})):s.data.exists&&!s.data.defaultOTP&&w(!0):d("User does not exist!")}catch(s){console.error("Error:",s),d("Error checking user.")}finally{m(!1)}},v=async a=>{a.preventDefault();try{await f(r,l,()=>{console.log("Logged in successfully! as admin"),i("/admin")})}catch{d("Invalid email/phone or password.")}};return e.jsxs(e.Fragment,{children:[e.jsx(S,{items:[{name:"Authentication",link:"/auth"},{name:"Admin Sign In"}]}),e.jsx("div",{className:"rounded-sm border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark p-8 max-w-md mx-auto",children:e.jsxs("div",{className:"flex flex-wrap items-center",children:[e.jsxs("div",{className:"w-full text-center mb-6",children:[e.jsxs(h,{to:"/",children:[e.jsx("img",{className:"hidden dark:block mx-auto",src:E,alt:"Logo"}),e.jsx("img",{className:"dark:hidden mx-auto",src:P,alt:"Logo"})]}),e.jsx("p",{className:"mt-3 text-gray-500",children:"Collect and manage meeting fees with ease"})]}),e.jsxs("form",{className:"w-full",onSubmit:o?v:j,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 dark:text-gray-300 mb-2",htmlFor:"identifier",children:"Email or Phone"}),e.jsx("input",{type:"text",id:"identifier",className:"w-full p-3 border border-stroke rounded-md dark:border-strokedark dark:bg-boxdark",value:r,onChange:a=>p(a.target.value),required:!0,disabled:o})]}),o&&e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 dark:text-gray-300 mb-2",htmlFor:"password",children:"Password"}),e.jsx("input",{type:"password",id:"password",className:"w-full p-3 border border-stroke rounded-md dark:border-strokedark dark:bg-boxdark",value:l,onChange:a=>k(a.target.value),required:!0})]}),u&&e.jsx("p",{className:"text-red-500 text-sm mb-4",children:u}),e.jsx("button",{type:"submit",className:"w-full py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition",disabled:c,children:c?"Checking...":o?"Sign In":"Continue"})]}),o&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx(h,{to:"/auth/forgot-password",className:"text-blue-500 hover:underline",children:"Forgot Password?"})})]})})]})};export{q as default};
