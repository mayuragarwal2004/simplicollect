import{d as ee,j as e,B as g,u as ie,a as se,r,f as _,c as P,Q as u,o as oe,D as V,e as ce,n as ae,X as de}from"./index-eKwCJLll.js";import{B as me}from"./Breadcrumb-kGt-xtkX.js";import{u as ue,a as he,b as pe,f as J,c as xe}from"./usePagination-CgXDuylC.js";import{T as fe,a as ge,b as Q,c as je,d as be,e as X}from"./table-B33a0yXU.js";import{D as ye,C as Ne,a as ve,b as Se}from"./react-icons.esm-DA5-1IUQ.js";import{S as Ce,a as we,b as De,c as ke,d as Me}from"./select-D6qXgB-2.js";import{D as O,f as F,a as $,c as A,e as U,d as L,b as G}from"./dialog-B-Dd4jtF.js";import{I as H}from"./input-BhMSVbBI.js";import{C as Re}from"./checkbox-BmJP8vxX.js";import{M as te}from"./multiSelect-BZFC1eeq.js";import{C as Ie}from"./calendar-K8ZV1Djl.js";import{P as Pe,a as Te,b as Ee}from"./popover-SP_ZoDj-.js";import{C as re}from"./calendar-BARg84S1.js";import{f as Oe}from"./format-SmSpYad1.js";import"./separator-CTOkHAe5.js";import{S as $e}from"./scroll-area-C2UZZ45V.js";import{S as q}from"./search-6lUvAzAk.js";import{S as Ae}from"./search-bar-BIh9mDP5.js";import{D as Be}from"./download-BmdnjggT.js";import{U as Fe}from"./upload-94Veaai2.js";import"./chevron-right-B55Ri9eq.js";import"./index-BdQq_4o_.js";import"./index-p0A_8czo.js";import"./index-DBSIu3jP.js";import"./index-Bn6wwOXp.js";import"./index-D9_AVXgF.js";import"./index-Irvr_6j-.js";import"./index-DCu9mJZ4.js";import"./index-CzuTh-Sf.js";import"./chevron-down-G1SJ-oEn.js";import"./index-Jch0bHuG.js";import"./index-CMxenybS.js";import"./badge-Cc92_WeI.js";import"./command-CwJtseYa.js";import"./chevron-left-Bxolz191.js";/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Ue=ee("UserPlus",Le);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]],He=ee("UserRound",Ve);function _e({table:s,totalRecord:a}){return e.jsxs("div",{className:"flex flex-col items-center justify-between space-y-4 px-2 lg:flex-row lg:space-y-0",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-2 sm:flex-row sm:space-x-6 sm:space-y-0",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.getFilteredRowModel().rows.length," row(s)."]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Rows per page"}),e.jsxs(Ce,{value:`${s.getState().pagination.pageSize}`,onValueChange:i=>s.setPageSize(Number(i)),children:[e.jsx(we,{className:"h-8 w-[70px]",children:e.jsx(De,{placeholder:s.getState().pagination.pageSize})}),e.jsx(ke,{side:"top",children:[5,10,20,30,40,50].map(i=>e.jsx(Me,{value:`${i}`,children:i},i))})]})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Total Records: ",a]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center justify-center text-sm font-medium",children:["Page ",s.getState().pagination.pageIndex+1," of ",s.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(g,{variant:"outline",className:"h-8 w-8 p-0",disabled:!s.getCanPreviousPage(),onClick:()=>s.setPageIndex(0),children:[e.jsx("span",{className:"sr-only",children:"Go to first page"}),e.jsx(ye,{className:"h-4 w-4"})]}),e.jsxs(g,{variant:"outline",className:"h-8 w-8 p-0",disabled:!s.getCanPreviousPage(),onClick:s.previousPage,children:[e.jsx("span",{className:"sr-only",children:"Go to previous page"}),e.jsx(Ne,{className:"h-4 w-4"})]}),e.jsxs(g,{variant:"outline",className:"h-8 w-8 p-0",disabled:!s.getCanNextPage(),onClick:s.nextPage,children:[e.jsx("span",{className:"sr-only",children:"Go to next page"}),e.jsx(ve,{className:"h-4 w-4"})]}),e.jsxs(g,{variant:"outline",className:"h-8 w-8 p-0",disabled:!s.getCanNextPage(),onClick:()=>s.setPageIndex(s.getPageCount()-1),children:[e.jsx("span",{className:"sr-only",children:"Go to last page"}),e.jsx(Se,{className:"h-4 w-4"})]})]})]})]})}function ze({columns:s,data:a,searchInputField:i,filterField:v,filterFieldName:p,filterCategoriesList:j,totalRecord:x,children:d}){var l;const S=ie(),{rows:b,onPaginationChange:M,page:w,pagination:R}=ue(),I=se(),y=()=>{const t=new URLSearchParams(I.search),n=xe({rows:b,page:w},t);S(`?${n}`,{replace:!0})};r.useEffect(()=>{y()},[b,w]);const N=he({data:a,columns:s,getCoreRowModel:pe(),manualPagination:!0,onPaginationChange:M,state:{pagination:R},rowCount:x}),f=r.Children.map(d,t=>r.isValidElement(t)?r.cloneElement(t,{table:N,searchInputField:i,filterField:v,filterFieldName:p,filterCategoriesList:j}):t);return e.jsxs("div",{className:"space-y-4",children:[f,e.jsx("div",{className:"overflow-y-auto rounded-md border",children:e.jsxs(fe,{children:[e.jsx(ge,{children:N.getHeaderGroups().map(t=>e.jsx(Q,{children:t.headers.map(n=>e.jsx(je,{className:"px-4 py-2 bg-newprimaryColor text-white font-raleway",colSpan:n.colSpan,children:n.isPlaceholder?null:J(n.column.columnDef.header,n.getContext())},n.id))},t.id))}),e.jsx(be,{className:"bg-adminBreadCrumbsBg font-raleway",children:(l=N.getRowModel().rows)!=null&&l.length?N.getRowModel().rows.map(t=>e.jsx(Q,{"data-state":t.getIsSelected()&&"selected",children:t.getVisibleCells().map(n=>e.jsx(X,{className:"px-4 py-2",children:J(n.column.columnDef.cell,n.getContext())},n.id))},t.id)):e.jsx(Q,{children:e.jsx(X,{colSpan:s.length,className:"h-24 text-center bg-adminBreadCrumbsBg font-raleway",children:"No results."})})})]})}),e.jsx(_e,{table:N,totalRecord:x})]})}const Qe=s=>[{accessorKey:"name",header:()=>e.jsx("div",{children:"Name"}),cell:({row:a})=>e.jsxs("p",{className:"text-sm font-medium",children:[a.original.firstName," ",a.original.lastName]}),enableSorting:!1,enableHiding:!1},{accessorKey:"phoneNumber",header:()=>e.jsx("div",{children:"Phone Number"}),cell:({row:a})=>e.jsx("p",{className:"text-sm",children:a.original.phoneNumber}),enableSorting:!1,enableHiding:!1},{accessorKey:"email",header:()=>e.jsx("div",{children:"Email"}),cell:({row:a})=>e.jsx("p",{className:"text-sm",children:a.original.email}),enableSorting:!1,enableHiding:!1},{accessorKey:"role",header:()=>e.jsx("div",{children:"Role"}),cell:({row:a})=>e.jsx("p",{className:"text-sm",children:a.original.roleNames}),enableSorting:!1,enableHiding:!1},{accessorKey:"balanceAmount",header:()=>e.jsx("div",{children:"Balance Amount"}),cell:({row:a})=>e.jsxs("p",{className:"text-sm font-medium text-green-600",children:["â‚¹",a.original.balance]}),enableSorting:!0,enableHiding:!1},{accessorKey:"actions",header:()=>e.jsx("div",{children:"Actions"}),cell:({row:a})=>{const{chapterSlug:i}=_(),[v,p]=r.useState(""),[j,x]=r.useState([]),[d,S]=r.useState(a.original.balance),[b,M]=r.useState(!1),[w,R]=r.useState(!1),[I,y]=r.useState(!1),[N,f]=r.useState(!1),[l,t]=r.useState(!1),n=()=>{P.put(`/api/admin/chapter-member-list/${i}/members/${a.original.memberId}/role`,{role:j.join(",")}).then(()=>{u.success("Role updated successfully"),a.original.fetchMembers(),R(!1)}).catch(()=>u.error("Failed to update role"))},m=()=>{P.put(`/api/admin/chapter-member-list/${i}/members/${a.original.memberId}/balance`,{balance:d,addToTransaction:b}).then(()=>{u.success("Balance updated successfully"),a.original.fetchMembers(),y(!1)}).catch(()=>u.error("Failed to update balance"))},o=()=>{P.put(`/api/admin/chapter-member-list/${i}/members/${a.original.memberId}/remove`,{leaveDate:v}).then(()=>{u.success("Member removed successfully"),a.original.fetchMembers(),f(!1)}).catch(()=>u.error("Failed to remove member"))},c=()=>{P.delete(`/api/admin/chapter-member-list/${i}/members/${a.original.memberId}`).then(()=>{u.success("Member deleted successfully"),a.original.fetchMembers(),t(!1)}).catch(()=>u.error("Failed to delete member"))},C=k=>{x(k)},D=(a.original.roleIds??"").split(",").map(k=>k.trim()).filter(k=>k!=="");return e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(O,{open:w,onOpenChange:R,children:[e.jsx(F,{asChild:!0,children:e.jsx(g,{variant:"secondary",size:"sm",onClick:()=>R(!0),children:"Change Role"})}),e.jsxs($,{children:[e.jsx(A,{children:"Set Role"}),e.jsx(U,{children:"Select a new role for the user."}),e.jsx(te,{options:s.map(k=>({label:k.roleName,value:k.roleId.toString()})),onValueChange:C,defaultValue:D.map(String),placeholder:"Select Rights",maxCount:5}),e.jsx(L,{children:e.jsx(g,{onClick:n,children:"Confirm"})})]})]}),e.jsxs(O,{open:I,onOpenChange:y,children:[e.jsx(F,{asChild:!0,children:e.jsx(g,{variant:"secondary",size:"sm",onClick:()=>y(!0),children:"Update Balance"})}),e.jsxs($,{children:[e.jsx(A,{children:"Edit Balance"}),e.jsx(H,{type:"number",value:d,onChange:k=>S(k.target.value)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Re,{onCheckedChange:M}),e.jsx("span",{children:"Add to transaction"})]}),e.jsx(L,{children:e.jsx(g,{onClick:m,children:"Save"})})]})]}),e.jsxs(O,{open:N,onOpenChange:f,children:[e.jsx(F,{asChild:!0,children:e.jsx(g,{variant:"secondary",size:"sm",className:"text-yellow-600 border-yellow-600",onClick:()=>f(!0),children:"Remove"})}),e.jsxs($,{children:[e.jsx(A,{children:"Remove Member"}),e.jsx(U,{children:"Enter leave date to remove this member."}),e.jsx(H,{type:"date",value:v,onChange:k=>p(k.target.value)}),e.jsx(L,{children:e.jsx(g,{onClick:o,children:"Confirm"})})]})]}),e.jsxs(O,{open:l,onOpenChange:t,children:[e.jsx(F,{asChild:!0,children:e.jsx(g,{variant:"destructive",size:"sm",onClick:()=>t(!0),children:"Delete"})}),e.jsxs($,{children:[e.jsx(A,{children:"Delete User"}),e.jsx(U,{children:"Are you sure? This action is irreversible."}),e.jsx(L,{children:e.jsx(g,{variant:"destructive",onClick:c,children:"Delete"})})]})]})]})}}];var We="Expected a function",Y=NaN,Ge="[object Symbol]",Ke=/^\s+|\s+$/g,Je=/^[-+]0x[0-9a-f]+$/i,Xe=/^0b[01]+$/i,qe=/^0o[0-7]+$/i,Ye=parseInt,Ze=typeof V=="object"&&V&&V.Object===Object&&V,es=typeof self=="object"&&self&&self.Object===Object&&self,ss=Ze||es||Function("return this")(),as=Object.prototype,ts=as.toString,rs=Math.max,ns=Math.min,W=function(){return ss.Date.now()};function ls(s,a,i){var v,p,j,x,d,S,b=0,M=!1,w=!1,R=!0;if(typeof s!="function")throw new TypeError(We);a=Z(a)||0,K(i)&&(M=!!i.leading,w="maxWait"in i,j=w?rs(Z(i.maxWait)||0,a):j,R="trailing"in i?!!i.trailing:R);function I(c){var C=v,D=p;return v=p=void 0,b=c,x=s.apply(D,C),x}function y(c){return b=c,d=setTimeout(l,a),M?I(c):x}function N(c){var C=c-S,D=c-b,k=a-C;return w?ns(k,j-D):k}function f(c){var C=c-S,D=c-b;return S===void 0||C>=a||C<0||w&&D>=j}function l(){var c=W();if(f(c))return t(c);d=setTimeout(l,N(c))}function t(c){return d=void 0,R&&v?I(c):(v=p=void 0,x)}function n(){d!==void 0&&clearTimeout(d),b=0,v=S=p=d=void 0}function m(){return d===void 0?x:t(W())}function o(){var c=W(),C=f(c);if(v=arguments,p=this,S=c,C){if(d===void 0)return y(S);if(w)return d=setTimeout(l,a),I(S)}return d===void 0&&(d=setTimeout(l,a)),x}return o.cancel=n,o.flush=m,o}function K(s){var a=typeof s;return!!s&&(a=="object"||a=="function")}function is(s){return!!s&&typeof s=="object"}function os(s){return typeof s=="symbol"||is(s)&&ts.call(s)==Ge}function Z(s){if(typeof s=="number")return s;if(os(s))return Y;if(K(s)){var a=typeof s.valueOf=="function"?s.valueOf():s;s=K(a)?a+"":a}if(typeof s!="string")return s===0?s:+s;s=s.replace(Ke,"");var i=Xe.test(s);return i||qe.test(s)?Ye(s.slice(2),i?2:8):Je.test(s)?Y:+s}var cs=ls;const ds=oe(cs);function ms(){const[s,a]=r.useState();return e.jsxs(Pe,{children:[e.jsx(Te,{asChild:!0,children:e.jsxs(g,{variant:"outline",className:ce("w-[240px] justify-start text-left font-normal",!s&&"text-muted-foreground"),children:[e.jsx(re,{}),s?Oe(s,"PPP"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(Ee,{className:"w-auto p-0",align:"start",children:e.jsx(Ie,{mode:"single",selected:s,onSelect:a,initialFocus:!0})})]})}const us=({isOpen:s,onClose:a,chapterSlug:i,fetchMembers:v})=>{const[p,j]=r.useState(""),[x,d]=r.useState([]),[S,b]=r.useState(!1),[M,w]=r.useState(1),[R,I]=r.useState(!0),[y,N]=r.useState(null),[f,l]=r.useState([]),[t,n]=r.useState([]),[m,o]=r.useState(new Date);console.log({selectedRoles:t});const c=async(h,T=1,B=!1)=>{if(h){b(!0);try{const E=(await P.get(`/api/admin/chapter-member-list/searchmemberstoadd?searchQuery=${h}&chapterSlug=${i}&page=${T}&limit=10`)).data||[];d(le=>B?E:[...new Set([...le,...E])]),I(E.length===10)}catch{u.error("Failed to fetch search results")}finally{b(!1)}}},C=r.useCallback(ds(h=>c(h,1,!0),500),[]);r.useEffect(()=>{w(1),d([]),I(!0),C(p)},[p,C]);const D=h=>{h.target.scrollHeight-h.target.scrollTop===h.target.clientHeight&&!S&&R&&(c(p,M+1),w(T=>T+1))};r.useEffect(()=>{y&&(async()=>{try{const B=(await P.get(`/api/admin/chapters/${i}/roles`)).data;l(B);const z=B.filter(E=>!!E.default).map(E=>E.roleId.toString());n([]),setTimeout(()=>n(z),0)}catch{u.error("Failed to fetch roles")}})()},[y,i]);const k=h=>{N(h)},ne=async()=>{var h,T;if(!t.length||!m){u.error("Please provide all details");return}try{await P.post(`/api/admin/chapter-member-list/${i}/members/${y.memberId}/addmember`,{role:t.join(","),joinDate:m.toISOString().split("T")[0]}),u.success("Member added successfully"),v(),a(),N(null),n([]),o(new Date)}catch(B){u.error(((T=(h=B.response)==null?void 0:h.data)==null?void 0:T.error)||"Failed to add member")}};return e.jsx(O,{open:s,onOpenChange:a,children:e.jsxs($,{className:"sm:max-w-[600px]",children:[e.jsxs(G,{children:[e.jsxs(A,{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"w-5 h-5"}),"Add New Member"]}),e.jsx(U,{children:"Search and add members to your chapter"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(H,{placeholder:"Search by name or phone number...",value:p,onChange:h=>j(h.target.value),className:"pl-9 mb-4"})]}),e.jsxs($e,{className:"h-[300px] rounded-md border p-2",children:[S&&e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}),x.length>0?e.jsx("div",{className:"space-y-2",onScroll:D,children:x.map(h=>e.jsx(ae,{className:"p-3 hover:bg-accent/50 transition-colors",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-primary/10 p-2 rounded-full",children:e.jsx(He,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:h.fullName}),e.jsx("p",{className:"text-sm text-muted-foreground",children:h.phoneNumber})]})]}),h.isInChapter===0&&e.jsx(g,{size:"sm",variant:"outline",onClick:()=>k(h),children:"Add Member"})]})},h.memberId))}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[e.jsx(q,{className:"w-8 h-8 mb-2"}),e.jsx("p",{children:"No members found"})]})]}),e.jsx(O,{open:y!==null,onOpenChange:()=>N(null),children:e.jsxs($,{className:"sm:max-w-[425px]",children:[e.jsxs(G,{children:[e.jsx(A,{children:"Member Details"}),e.jsx(U,{children:y&&`Adding ${y.fullName} to chapter`})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Roles"}),e.jsx(te,{options:f.map(h=>({label:h.roleName,value:h.roleId.toString()})),onValueChange:n,defaultValue:t,placeholder:"Select member roles",maxCount:5,className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),"Join Date"]}),e.jsx(ms,{selected:m,onChange:o,className:"w-full",dateFormat:"yyyy-MM-dd",placeholderText:"Select join date"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(g,{variant:"outline",onClick:()=>N(null),children:"Cancel"}),e.jsx(g,{onClick:ne,children:"Add Member"})]})]})]})})]})})};function hs({isAddDialogOpen:s,onClose:a,fetchMembers:i}){const[v,p]=r.useState(""),[j,x]=r.useState(null),[d,S]=r.useState(!1),{chapterSlug:b}=_(),M=r.useRef(null),w=()=>{p(""),x(null)},R=async()=>{try{const l=await P.get(`/api/admin/chapters/${b}/bulk-members-add-get-template`,{responseType:"blob"}),t=new Blob([l.data],{type:l.headers["content-type"]}),n=URL.createObjectURL(t),m=document.createElement("a");m.href=n,m.setAttribute("download","members_template.xlsx"),document.body.appendChild(m),m.click(),document.body.removeChild(m)}catch(l){u.error("Failed to download the Excel template."),console.error("Template download error:",l)}},I=l=>{var m;const t=(m=l.target.files)==null?void 0:m[0];if(!t)return;if(!(t.name.endsWith(".xlsx")||t.name.endsWith(".xls"))){u.error("Only Excel files (.xlsx, .xls) are allowed."),p("");return}p(t.name),x(null),u.success(`Selected file: ${t.name}`)},y=async()=>{var n,m;const l=(m=(n=M.current)==null?void 0:n.files)==null?void 0:m[0];if(!l){u.error("Please select an Excel file to validate.");return}const t=new FormData;t.append("excelFile",l);try{const o=await P.post(`/api/admin/chapters/${b}/bulk-members-add-check-format`,t,{headers:{"Content-Type":"multipart/form-data"},responseType:"blob",validateStatus:()=>!0});if(o.status===200)u.success("Excel file validated successfully.");else{const c=new Blob([o.data],{type:o.headers["content-type"]}),C=URL.createObjectURL(c),D=document.createElement("a");D.href=C,D.setAttribute("download","validation_result.xlsx"),document.body.appendChild(D),D.click(),document.body.removeChild(D),u.error("Validation failed. Please check the downloaded file for details.")}}catch(o){u.error("Validation failed. Please check the file contents."),console.error("Validation error:",o)}},N=async()=>{var n,m;const l=(m=(n=M.current)==null?void 0:n.files)==null?void 0:m[0];if(!l){u.error("Please select an Excel file to submit.");return}S(!0);const t=new FormData;t.append("excelFile",l);try{const o=await P.post(`/api/admin/chapters/${b}/add-bulk-members`,t,{headers:{"Content-Type":"multipart/form-data"},validateStatus:()=>!0});o.status===200?(u.success("Members added successfully!"),p(""),x(null),a(),i()):(x(o.data.errorDetails),u.error("Submission failed. Please fix the errors below."))}catch(o){u.error("Submission failed. Please try again."),console.error("Submission error:",o)}finally{S(!1)}},f=(l,t)=>!t||t.length===0?null:e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-medium text-red-600",children:l}),e.jsx("ul",{className:"list-disc list-inside pl-4 mt-1 space-y-1",children:t.map((n,m)=>e.jsx("li",{className:"text-sm text-red-500",children:n.message},m))})]});return e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Super Admin Member Table"}),e.jsxs(O,{open:s,onOpenChange:a,children:[e.jsx(F,{asChild:!0,children:e.jsx(g,{onClick:w,children:"Add Bulk Member"})}),e.jsxs($,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(G,{children:[e.jsx(A,{className:"text-lg font-semibold",children:"Add Bulk Member"}),j&&e.jsxs("button",{onClick:()=>x(null),className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[e.jsx(de,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]}),j?e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-red-800",children:"Validation Errors Found"}),e.jsx("p",{className:"text-sm text-red-600 mt-1",children:"Please fix the following errors in your Excel file and try again."}),f("Duplicate Emails",j.duplicateEmail),f("Duplicate Phone Numbers",j.duplicatePhoneNumber),f("Missing First Names",j.noFirstName),f("Missing Contact Info",j.noPhoneAndEmail),f("Invalid Role Names",j.invalidRoleName),f("Missing Join Dates",j.noJoinDate),f("Missing Last Names",j.noLastName),e.jsx(g,{variant:"outline",className:"mt-4 w-full",onClick:()=>x(null),children:"Back to Upload"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-muted-foreground mt-2",children:[e.jsx("li",{children:"Download the template"}),e.jsx("li",{children:"Edit the template carefully"}),e.jsx("li",{children:"Upload the completed file"})]}),e.jsxs(g,{onClick:R,variant:"outline",className:"w-full mt-4 flex items-center justify-center gap-2",children:[e.jsx(Be,{className:"w-4 h-4"}),"Download Excel template"]}),e.jsxs("div",{onClick:()=>{var l;return(l=M.current)==null?void 0:l.click()},className:"border-2 border-dashed border-gray-300 rounded-xl p-6 mt-4 text-center cursor-pointer hover:bg-gray-50",children:[e.jsx(Fe,{className:"mx-auto h-6 w-6 text-muted-foreground mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:v?`Selected: ${v}`:"No file chosen"}),e.jsx(H,{type:"file",accept:".xlsx, .xls",ref:M,onChange:I,className:"hidden"})]}),e.jsxs(L,{className:"mt-6 flex justify-end gap-2",children:[e.jsx(g,{variant:"secondary",onClick:y,disabled:d,children:d?"Validating...":"Validate"}),e.jsx(g,{onClick:N,disabled:d,children:d?"Submitting...":"Submit"})]})]})]})]})]})}const ps=()=>{const[s,a]=r.useState([]),[i,v]=r.useState(!0),[p,j]=r.useState(""),[x,d]=r.useState(!1),[S,b]=r.useState(!1),[M,w]=r.useState(0),R=se(),I=new URLSearchParams(R.search),y=parseInt(I.get("rows"))||10,N=parseInt(I.get("page"))||0,{chapterSlug:f}=_(),[l,t]=r.useState([{roleId:1,roleName:"Admin",roleDescription:"Administrator role with full access",rights:"all",removable:!1},{roleId:2,roleName:"Editor",roleDescription:"Editor role with limited access",rights:"edit",removable:!0},{roleId:3,roleName:"Viewer",roleDescription:"Viewer role with read-only access",rights:"view",removable:!0},{roleId:6,roleName:"Member",roleDescription:"Member role with limited access",rights:"view",removable:!0}]);r.useEffect(()=>{n(),m()},[y,N,f,p]);const n=()=>{P.get(`/api/admin/chapter-member-list/${f}/members?rows=${y}&page=${N+1}&searchQuery=${p}`).then(o=>{const c=o.data.data.map(C=>({...C,onRoleEdit:()=>{handleRoleSelection(C.memberId,C.roles.map(D=>D.roleId),l)}}));a(c),w(o.data.totalRecords||o.data.length),v(!1)}).catch(()=>{u.error("Failed to fetch Members"),v(!1)})},m=()=>{P.get(`/api/admin/chapters/${f}/roles`).then(o=>{t(o.data)}).catch(()=>{u.error("Failed to fetch roles")})};return e.jsxs(ae,{className:"p-5 shadow-md",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Super Admin Chapter Member Table"}),e.jsxs("div",{className:"flex gap-2 flex-wrap sm:gap-5",children:[e.jsx(g,{onClick:()=>d(!0),children:"Add Member"}),e.jsx(g,{onClick:()=>b(!0),children:"Add Bulk Member"})]})]}),e.jsx("div",{className:"mt-2",children:e.jsx(Ae,{onChange:o=>j(o.target.value),value:p,placeholder:"Search by member name, email, phone number or role",className:"mb-3 w-full"})})]}),i?e.jsx("p",{children:"Loading..."}):e.jsx(ze,{data:s.map(o=>({...o,fetchMembers:n})),columns:Qe(l),searchInputField:"memberName",totalRecord:M,pagination:{pageSize:parseInt(y),pageIndex:parseInt(N)}}),e.jsx(us,{isOpen:x,onClose:()=>d(!1),chapterSlug:f,fetchMembers:n}),e.jsx(hs,{isAddDialogOpen:S,onClose:()=>b(!1),fetchMembers:n})]})},Xs=()=>{const{chapterSlug:s}=_();return e.jsxs(e.Fragment,{children:[e.jsx(me,{items:[{name:"Dashboard",link:"/admin"},{name:"Chapter ",link:"/admin/chapters"},{name:"Chapter Members",link:`/admin/chapters/${s}/member`}]}),e.jsx(ps,{})]})};export{Xs as default};
