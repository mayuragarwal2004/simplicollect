import{e as x,f as T,u as U,r,c as h,Q as c,j as e,B as t,C as Q,g as R,h as W,i as q,k as G}from"./index.js";import{B as J}from"./Breadcrumb.js";import{D as f,f as K,a as D,b as v,c as y,e as w,d as k,g as b}from"./dialog.js";import{I as A}from"./input.js";import{L as m}from"./label.js";import{T as S}from"./textarea.js";import{A as V,a as X,b as Y,c as Z,f as ee,d as se,g as ae,h as te}from"./alert-dialog.js";import{U as F}from"./users.js";import{T as re}from"./trash-2.js";import"./chevron-right.js";import"./index3.js";import"./index4.js";import"./index5.js";import"./index6.js";/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],ie=x("CirclePlus",le);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],ne=x("Pencil",ce);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],oe=x("Table",de),he=()=>{const{chapterSlug:l}=T(),g=U(),[$,I]=r.useState([]),[E,j]=r.useState(!1),[M,u]=r.useState(!1),[P,C]=r.useState(null),[_,p]=r.useState(!1),[a,N]=r.useState(null),[i,n]=r.useState({clusterName:"",description:""});r.useEffect(()=>{d()},[l]);const d=async()=>{try{const s=await h.get(`/api/clusters/${l}`);I(s.data)}catch{c.error("Failed to fetch clusters")}},o=s=>{n({...i,[s.target.name]:s.target.value})},z=async()=>{try{await h.post(`/api/clusters/${l}`,i),c.success("Cluster created successfully"),j(!1),n({clusterName:"",description:""}),d()}catch{c.error("Failed to create cluster")}},B=async()=>{try{await h.put(`/api/clusters/${P.clusterId}`,i),c.success("Cluster updated successfully"),u(!1),C(null),n({clusterName:"",description:""}),d()}catch{c.error("Failed to update cluster")}},L=s=>{N(s),p(!0)},H=async()=>{if(a)try{await h.delete(`/api/clusters/${a.clusterId}`),c.success("Cluster deleted successfully"),p(!1),N(null),d()}catch{c.error("Failed to delete cluster")}},O=s=>{C(s),n({clusterName:s.clusterName,description:s.description||""}),u(!0)};return e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Chapter Clusters"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(t,{variant:"outline",onClick:()=>g(`/admin/chapters/${l}/clusters/manage`),children:[e.jsx(oe,{className:"mr-2 h-4 w-4"}),"Manage Clusters"]}),e.jsxs(f,{open:E,onOpenChange:j,children:[e.jsx(K,{asChild:!0,children:e.jsxs(t,{children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Add Cluster"]})}),e.jsxs(D,{children:[e.jsxs(v,{children:[e.jsx(y,{children:"Add New Cluster"}),e.jsx(w,{children:"Create a new cluster for this chapter."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"clusterName",children:"Cluster Name"}),e.jsx(A,{id:"clusterName",name:"clusterName",value:i.clusterName,onChange:o})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"description",children:"Description"}),e.jsx(S,{id:"description",name:"description",value:i.description,onChange:o})]})]}),e.jsxs(k,{children:[e.jsx(b,{asChild:!0,children:e.jsx(t,{variant:"outline",children:"Cancel"})}),e.jsx(t,{onClick:z,children:"Add Cluster"})]})]})]})]})]}),"      ",e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:$.map(s=>e.jsxs(Q,{children:[e.jsxs(R,{children:[e.jsx(W,{children:s.clusterName}),e.jsx(q,{children:s.description})]}),e.jsx(G,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(F,{className:"mr-2 h-4 w-4"}),e.jsxs("span",{children:[s.memberCount," Members"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(t,{variant:"outline",size:"icon",onClick:()=>g(`/admin/chapters/${l}/clusters/${s.clusterId}`),children:e.jsx(F,{className:"h-4 w-4"})}),e.jsx(t,{variant:"outline",size:"icon",onClick:()=>O(s),children:e.jsx(ne,{className:"h-4 w-4"})}),e.jsx(t,{variant:"outline",size:"icon",onClick:()=>L(s),children:e.jsx(re,{className:"h-4 w-4"})})]})]})})]},s.clusterId))}),e.jsx(V,{open:_,onOpenChange:p,children:e.jsxs(X,{children:[e.jsxs(Y,{children:[e.jsx(Z,{children:"Are you absolutely sure?"}),e.jsxs(ee,{children:['This action will delete the cluster "',a==null?void 0:a.clusterName,'". This action cannot be undone.',(a==null?void 0:a.memberCount)>0&&e.jsxs("p",{className:"mt-2 text-red-500",children:["Warning: This cluster has ",a.memberCount," members. Deleting it will remove these members from the cluster."]})]})]}),e.jsxs(se,{children:[e.jsx(ae,{children:"Cancel"}),e.jsx(te,{onClick:H,className:"bg-red-600 hover:bg-red-700",children:"Delete Cluster"})]})]})}),e.jsx(f,{open:M,onOpenChange:u,children:e.jsxs(D,{children:[e.jsxs(v,{children:[e.jsx(y,{children:"Edit Cluster"}),e.jsx(w,{children:"Update cluster information."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"edit-clusterName",children:"Cluster Name"}),e.jsx(A,{id:"edit-clusterName",name:"clusterName",value:i.clusterName,onChange:o})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"edit-description",children:"Description"}),e.jsx(S,{id:"edit-description",name:"description",value:i.description,onChange:o})]})]}),e.jsxs(k,{children:[e.jsx(b,{asChild:!0,children:e.jsx(t,{variant:"outline",children:"Cancel"})}),e.jsx(t,{onClick:B,children:"Save Changes"})]})]})})]})},be=()=>{const{chapterSlug:l}=T();return e.jsxs(e.Fragment,{children:[e.jsx(J,{items:[{name:"Dashboard",link:"/admin"},{name:"Chapter ",link:"/admin/chapters"},{name:"Chapter Clusters",link:`/admin/chapters/${l}/clusters`}]}),e.jsx(he,{})]})};export{be as default};
