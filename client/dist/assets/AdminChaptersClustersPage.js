import{e as k,u as M,r as t,c as h,Q as n,j as e,B as r,C as Q,f as R,g as W,h as q,i as G}from"./index.js";import{B as J}from"./Breadcrumb.js";import{D as N,f as K,a as f,b as D,c as v,e as w,d as b,g as A}from"./dialog.js";import{I as y}from"./input.js";import{L as m}from"./label.js";import{T as S}from"./textarea.js";import{A as V,a as X,b as Y,c as Z,f as _,d as ee,g as se,h as ae}from"./alert-dialog.js";import{T as re,C as te,P as le}from"./table.js";import{U as F}from"./users.js";import{T as ie}from"./trash-2.js";import"./chevron-right.js";import"./index3.js";import"./index4.js";import"./index5.js";import"./index6.js";const ne=()=>{const{chapterSlug:l}=k(),p=M(),[T,E]=t.useState([]),[I,j]=t.useState(!1),[$,u]=t.useState(!1),[P,g]=t.useState(null),[B,x]=t.useState(!1),[a,C]=t.useState(null),[i,c]=t.useState({clusterName:"",description:""});t.useEffect(()=>{d()},[l]);const d=async()=>{try{const s=await h.get(`/api/clusters/${l}`);E(s.data)}catch{n.error("Failed to fetch clusters")}},o=s=>{c({...i,[s.target.name]:s.target.value})},z=async()=>{try{await h.post(`/api/clusters/${l}`,i),n.success("Cluster created successfully"),j(!1),c({clusterName:"",description:""}),d()}catch{n.error("Failed to create cluster")}},H=async()=>{try{await h.put(`/api/clusters/${P.clusterId}`,i),n.success("Cluster updated successfully"),u(!1),g(null),c({clusterName:"",description:""}),d()}catch{n.error("Failed to update cluster")}},O=s=>{C(s),x(!0)},U=async()=>{if(a)try{await h.delete(`/api/clusters/${a.clusterId}`),n.success("Cluster deleted successfully"),x(!1),C(null),d()}catch{n.error("Failed to delete cluster")}},L=s=>{g(s),c({clusterName:s.clusterName,description:s.description||""}),u(!0)};return e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Chapter Clusters"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{variant:"outline",onClick:()=>p(`/admin/chapters/${l}/clusters/manage`),children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Manage Clusters"]}),e.jsxs(N,{open:I,onOpenChange:j,children:[e.jsx(K,{asChild:!0,children:e.jsxs(r,{children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),"Add Cluster"]})}),e.jsxs(f,{children:[e.jsxs(D,{children:[e.jsx(v,{children:"Add New Cluster"}),e.jsx(w,{children:"Create a new cluster for this chapter."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"clusterName",children:"Cluster Name"}),e.jsx(y,{id:"clusterName",name:"clusterName",value:i.clusterName,onChange:o})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"description",children:"Description"}),e.jsx(S,{id:"description",name:"description",value:i.description,onChange:o})]})]}),e.jsxs(b,{children:[e.jsx(A,{asChild:!0,children:e.jsx(r,{variant:"outline",children:"Cancel"})}),e.jsx(r,{onClick:z,children:"Add Cluster"})]})]})]})]})]}),"      ",e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:T.map(s=>e.jsxs(Q,{children:[e.jsxs(R,{children:[e.jsx(W,{children:s.clusterName}),e.jsx(q,{children:s.description})]}),e.jsx(G,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(F,{className:"mr-2 h-4 w-4"}),e.jsxs("span",{children:[s.memberCount," Members"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{variant:"outline",size:"icon",onClick:()=>p(`/admin/chapters/${l}/clusters/${s.clusterId}`),children:e.jsx(F,{className:"h-4 w-4"})}),e.jsx(r,{variant:"outline",size:"icon",onClick:()=>L(s),children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(r,{variant:"outline",size:"icon",onClick:()=>O(s),children:e.jsx(ie,{className:"h-4 w-4"})})]})]})})]},s.clusterId))}),e.jsx(V,{open:B,onOpenChange:x,children:e.jsxs(X,{children:[e.jsxs(Y,{children:[e.jsx(Z,{children:"Are you absolutely sure?"}),e.jsxs(_,{children:['This action will delete the cluster "',a==null?void 0:a.clusterName,'". This action cannot be undone.',(a==null?void 0:a.memberCount)>0&&e.jsxs("p",{className:"mt-2 text-red-500",children:["Warning: This cluster has ",a.memberCount," members. Deleting it will remove these members from the cluster."]})]})]}),e.jsxs(ee,{children:[e.jsx(se,{children:"Cancel"}),e.jsx(ae,{onClick:U,className:"bg-red-600 hover:bg-red-700",children:"Delete Cluster"})]})]})}),e.jsx(N,{open:$,onOpenChange:u,children:e.jsxs(f,{children:[e.jsxs(D,{children:[e.jsx(v,{children:"Edit Cluster"}),e.jsx(w,{children:"Update cluster information."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"edit-clusterName",children:"Cluster Name"}),e.jsx(y,{id:"edit-clusterName",name:"clusterName",value:i.clusterName,onChange:o})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"edit-description",children:"Description"}),e.jsx(S,{id:"edit-description",name:"description",value:i.description,onChange:o})]})]}),e.jsxs(b,{children:[e.jsx(A,{asChild:!0,children:e.jsx(r,{variant:"outline",children:"Cancel"})}),e.jsx(r,{onClick:H,children:"Save Changes"})]})]})})]})},we=()=>{const{chapterSlug:l}=k();return e.jsxs(e.Fragment,{children:[e.jsx(J,{items:[{name:"Dashboard",link:"/admin"},{name:"Chapter ",link:"/admin/chapters"},{name:"Chapter Clusters",link:`/admin/chapters/${l}/clusters`}]}),e.jsx(ne,{})]})};export{we as default};
