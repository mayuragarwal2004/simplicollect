import{j as e,B as g,u as le,a as ee,r,e as z,c as P,Q as u,w as ie,F as V,d as oe,C as se,X as ce}from"./index.js";import{B as de}from"./Breadcrumb.js";import{u as me,a as ue,f as J}from"./index14.js";import{T as he,a as pe,b as W,c as xe,d as fe,e as X}from"./table2.js";import{u as ge,c as je}from"./usePagination.js";import{D as be,C as Ne,a as ve,b as ye}from"./react-icons.esm.js";import{S as Se,a as Ce,b as we,c as De,d as Re}from"./select.js";import{D as O,f as B,a as A,c as $,e as U,d as L,b as K}from"./dialog.js";import{I as H}from"./input.js";import{C as ke}from"./checkbox.js";import{M as ae}from"./multiSelect.js";import{C as Me}from"./calendar2.js";import{P as Ie,a as Pe,b as Te}from"./popover.js";import{C as te}from"./calendar.js";import{f as Ee}from"./format.js";import"./separator.js";import{S as Oe}from"./scroll-area.js";import{U as Ae,a as $e}from"./user-round.js";import{S as q}from"./search.js";import{S as Fe}from"./search-bar.js";import{D as Be}from"./download.js";import{U as Le}from"./upload.js";import"./chevron-right.js";import"./index10.js";import"./index4.js";import"./index11.js";import"./index9.js";import"./index5.js";import"./index7.js";import"./index8.js";import"./index12.js";import"./chevron-down.js";import"./check.js";import"./chevron-up.js";import"./index3.js";import"./index6.js";import"./badge.js";import"./command.js";import"./wand-sparkles.js";import"./chevron-left.js";function Ue({table:s,totalRecord:a}){return e.jsxs("div",{className:"flex flex-col items-center justify-between space-y-4 px-2 lg:flex-row lg:space-y-0",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-2 sm:flex-row sm:space-x-6 sm:space-y-0",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.getFilteredRowModel().rows.length," row(s)."]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Rows per page"}),e.jsxs(Se,{value:`${s.getState().pagination.pageSize}`,onValueChange:i=>s.setPageSize(Number(i)),children:[e.jsx(Ce,{className:"h-8 w-[70px]",children:e.jsx(we,{placeholder:s.getState().pagination.pageSize})}),e.jsx(De,{side:"top",children:[5,10,20,30,40,50].map(i=>e.jsx(Re,{value:`${i}`,children:i},i))})]})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Total Records: ",a]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center justify-center text-sm font-medium",children:["Page ",s.getState().pagination.pageIndex+1," of ",s.getPageCount()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(g,{variant:"outline",className:"h-8 w-8 p-0",disabled:!s.getCanPreviousPage(),onClick:()=>s.setPageIndex(0),children:[e.jsx("span",{className:"sr-only",children:"Go to first page"}),e.jsx(be,{className:"h-4 w-4"})]}),e.jsxs(g,{variant:"outline",className:"h-8 w-8 p-0",disabled:!s.getCanPreviousPage(),onClick:s.previousPage,children:[e.jsx("span",{className:"sr-only",children:"Go to previous page"}),e.jsx(Ne,{className:"h-4 w-4"})]}),e.jsxs(g,{variant:"outline",className:"h-8 w-8 p-0",disabled:!s.getCanNextPage(),onClick:s.nextPage,children:[e.jsx("span",{className:"sr-only",children:"Go to next page"}),e.jsx(ve,{className:"h-4 w-4"})]}),e.jsxs(g,{variant:"outline",className:"h-8 w-8 p-0",disabled:!s.getCanNextPage(),onClick:()=>s.setPageIndex(s.getPageCount()-1),children:[e.jsx("span",{className:"sr-only",children:"Go to last page"}),e.jsx(ye,{className:"h-4 w-4"})]})]})]})]})}function Ve({columns:s,data:a,searchInputField:i,filterField:y,filterFieldName:p,filterCategoriesList:j,totalRecord:x,children:d}){var l;const S=le(),{rows:b,onPaginationChange:k,page:w,pagination:M}=ge(),I=ee(),N=()=>{const t=new URLSearchParams(I.search),n=je({rows:b,page:w},t);S(`?${n}`,{replace:!0})};r.useEffect(()=>{N()},[b,w]);const v=me({data:a,columns:s,getCoreRowModel:ue(),manualPagination:!0,onPaginationChange:k,state:{pagination:M},rowCount:x}),f=r.Children.map(d,t=>r.isValidElement(t)?r.cloneElement(t,{table:v,searchInputField:i,filterField:y,filterFieldName:p,filterCategoriesList:j}):t);return e.jsxs("div",{className:"space-y-4",children:[f,e.jsx("div",{className:"overflow-y-auto rounded-md border",children:e.jsxs(he,{children:[e.jsx(pe,{children:v.getHeaderGroups().map(t=>e.jsx(W,{children:t.headers.map(n=>e.jsx(xe,{className:"px-4 py-2 bg-newprimaryColor text-white font-raleway",colSpan:n.colSpan,children:n.isPlaceholder?null:J(n.column.columnDef.header,n.getContext())},n.id))},t.id))}),e.jsx(fe,{className:"bg-adminBreadCrumbsBg font-raleway",children:(l=v.getRowModel().rows)!=null&&l.length?v.getRowModel().rows.map(t=>e.jsx(W,{"data-state":t.getIsSelected()&&"selected",children:t.getVisibleCells().map(n=>e.jsx(X,{className:"px-4 py-2",children:J(n.column.columnDef.cell,n.getContext())},n.id))},t.id)):e.jsx(W,{children:e.jsx(X,{colSpan:s.length,className:"h-24 text-center bg-adminBreadCrumbsBg font-raleway",children:"No results."})})})]})}),e.jsx(Ue,{table:v,totalRecord:x})]})}const He=s=>[{accessorKey:"name",header:()=>e.jsx("div",{children:"Name"}),cell:({row:a})=>e.jsxs("p",{className:"text-sm font-medium",children:[a.original.firstName," ",a.original.lastName]}),enableSorting:!1,enableHiding:!1},{accessorKey:"phoneNumber",header:()=>e.jsx("div",{children:"Phone Number"}),cell:({row:a})=>e.jsx("p",{className:"text-sm",children:a.original.phoneNumber}),enableSorting:!1,enableHiding:!1},{accessorKey:"email",header:()=>e.jsx("div",{children:"Email"}),cell:({row:a})=>e.jsx("p",{className:"text-sm",children:a.original.email}),enableSorting:!1,enableHiding:!1},{accessorKey:"role",header:()=>e.jsx("div",{children:"Role"}),cell:({row:a})=>e.jsx("p",{className:"text-sm",children:a.original.roleNames}),enableSorting:!1,enableHiding:!1},{accessorKey:"balanceAmount",header:()=>e.jsx("div",{children:"Balance Amount"}),cell:({row:a})=>e.jsxs("p",{className:"text-sm font-medium text-green-600",children:["â‚¹",a.original.balance]}),enableSorting:!0,enableHiding:!1},{accessorKey:"actions",header:()=>e.jsx("div",{children:"Actions"}),cell:({row:a})=>{const{chapterSlug:i}=z(),[y,p]=r.useState(""),[j,x]=r.useState([]),[d,S]=r.useState(a.original.balance),[b,k]=r.useState(!1),[w,M]=r.useState(!1),[I,N]=r.useState(!1),[v,f]=r.useState(!1),[l,t]=r.useState(!1),n=()=>{P.put(`/api/admin/chapter-member-list/${i}/members/${a.original.memberId}/role`,{role:j.join(",")}).then(()=>{u.success("Role updated successfully"),a.original.fetchMembers(),M(!1)}).catch(()=>u.error("Failed to update role"))},m=()=>{P.put(`/api/admin/chapter-member-list/${i}/members/${a.original.memberId}/balance`,{balance:d,addToTransaction:b}).then(()=>{u.success("Balance updated successfully"),a.original.fetchMembers(),N(!1)}).catch(()=>u.error("Failed to update balance"))},o=()=>{P.put(`/api/admin/chapter-member-list/${i}/members/${a.original.memberId}/remove`,{leaveDate:y}).then(()=>{u.success("Member removed successfully"),a.original.fetchMembers(),f(!1)}).catch(()=>u.error("Failed to remove member"))},c=()=>{P.delete(`/api/admin/chapter-member-list/${i}/members/${a.original.memberId}`).then(()=>{u.success("Member deleted successfully"),a.original.fetchMembers(),t(!1)}).catch(()=>u.error("Failed to delete member"))},C=R=>{x(R)},D=(a.original.roleIds??"").split(",").map(R=>R.trim()).filter(R=>R!=="");return e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(O,{open:w,onOpenChange:M,children:[e.jsx(B,{asChild:!0,children:e.jsx(g,{variant:"secondary",size:"sm",onClick:()=>M(!0),children:"Change Role"})}),e.jsxs(A,{children:[e.jsx($,{children:"Set Role"}),e.jsx(U,{children:"Select a new role for the user."}),e.jsx(ae,{options:s.map(R=>({label:R.roleName,value:R.roleId.toString()})),onValueChange:C,defaultValue:D.map(String),placeholder:"Select Rights",maxCount:5}),e.jsx(L,{children:e.jsx(g,{onClick:n,children:"Confirm"})})]})]}),e.jsxs(O,{open:I,onOpenChange:N,children:[e.jsx(B,{asChild:!0,children:e.jsx(g,{variant:"secondary",size:"sm",onClick:()=>N(!0),children:"Update Balance"})}),e.jsxs(A,{children:[e.jsx($,{children:"Edit Balance"}),e.jsx(H,{type:"number",value:d,onChange:R=>S(R.target.value)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{onCheckedChange:k}),e.jsx("span",{children:"Add to transaction"})]}),e.jsx(L,{children:e.jsx(g,{onClick:m,children:"Save"})})]})]}),e.jsxs(O,{open:v,onOpenChange:f,children:[e.jsx(B,{asChild:!0,children:e.jsx(g,{variant:"secondary",size:"sm",className:"text-yellow-600 border-yellow-600",onClick:()=>f(!0),children:"Remove"})}),e.jsxs(A,{children:[e.jsx($,{children:"Remove Member"}),e.jsx(U,{children:"Enter leave date to remove this member."}),e.jsx(H,{type:"date",value:y,onChange:R=>p(R.target.value)}),e.jsx(L,{children:e.jsx(g,{onClick:o,children:"Confirm"})})]})]}),e.jsxs(O,{open:l,onOpenChange:t,children:[e.jsx(B,{asChild:!0,children:e.jsx(g,{variant:"destructive",size:"sm",onClick:()=>t(!0),children:"Delete"})}),e.jsxs(A,{children:[e.jsx($,{children:"Delete User"}),e.jsx(U,{children:"Are you sure? This action is irreversible."}),e.jsx(L,{children:e.jsx(g,{variant:"destructive",onClick:c,children:"Delete"})})]})]})]})}}];var ze="Expected a function",Y=NaN,Qe="[object Symbol]",We=/^\s+|\s+$/g,Ge=/^[-+]0x[0-9a-f]+$/i,Ke=/^0b[01]+$/i,_e=/^0o[0-7]+$/i,Je=parseInt,Xe=typeof V=="object"&&V&&V.Object===Object&&V,qe=typeof self=="object"&&self&&self.Object===Object&&self,Ye=Xe||qe||Function("return this")(),Ze=Object.prototype,es=Ze.toString,ss=Math.max,as=Math.min,G=function(){return Ye.Date.now()};function ts(s,a,i){var y,p,j,x,d,S,b=0,k=!1,w=!1,M=!0;if(typeof s!="function")throw new TypeError(ze);a=Z(a)||0,_(i)&&(k=!!i.leading,w="maxWait"in i,j=w?ss(Z(i.maxWait)||0,a):j,M="trailing"in i?!!i.trailing:M);function I(c){var C=y,D=p;return y=p=void 0,b=c,x=s.apply(D,C),x}function N(c){return b=c,d=setTimeout(l,a),k?I(c):x}function v(c){var C=c-S,D=c-b,R=a-C;return w?as(R,j-D):R}function f(c){var C=c-S,D=c-b;return S===void 0||C>=a||C<0||w&&D>=j}function l(){var c=G();if(f(c))return t(c);d=setTimeout(l,v(c))}function t(c){return d=void 0,M&&y?I(c):(y=p=void 0,x)}function n(){d!==void 0&&clearTimeout(d),b=0,y=S=p=d=void 0}function m(){return d===void 0?x:t(G())}function o(){var c=G(),C=f(c);if(y=arguments,p=this,S=c,C){if(d===void 0)return N(S);if(w)return d=setTimeout(l,a),I(S)}return d===void 0&&(d=setTimeout(l,a)),x}return o.cancel=n,o.flush=m,o}function _(s){var a=typeof s;return!!s&&(a=="object"||a=="function")}function rs(s){return!!s&&typeof s=="object"}function ns(s){return typeof s=="symbol"||rs(s)&&es.call(s)==Qe}function Z(s){if(typeof s=="number")return s;if(ns(s))return Y;if(_(s)){var a=typeof s.valueOf=="function"?s.valueOf():s;s=_(a)?a+"":a}if(typeof s!="string")return s===0?s:+s;s=s.replace(We,"");var i=Ke.test(s);return i||_e.test(s)?Je(s.slice(2),i?2:8):Ge.test(s)?Y:+s}var ls=ts;const is=ie(ls);function os(){const[s,a]=r.useState();return e.jsxs(Ie,{children:[e.jsx(Pe,{asChild:!0,children:e.jsxs(g,{variant:"outline",className:oe("w-[240px] justify-start text-left font-normal",!s&&"text-muted-foreground"),children:[e.jsx(te,{}),s?Ee(s,"PPP"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(Te,{className:"w-auto p-0",align:"start",children:e.jsx(Me,{mode:"single",selected:s,onSelect:a,initialFocus:!0})})]})}const cs=({isOpen:s,onClose:a,chapterSlug:i,fetchMembers:y})=>{const[p,j]=r.useState(""),[x,d]=r.useState([]),[S,b]=r.useState(!1),[k,w]=r.useState(1),[M,I]=r.useState(!0),[N,v]=r.useState(null),[f,l]=r.useState([]),[t,n]=r.useState([]),[m,o]=r.useState(new Date);console.log({selectedRoles:t});const c=async(h,T=1,F=!1)=>{if(h){b(!0);try{const E=(await P.get(`/api/admin/chapter-member-list/searchmemberstoadd?searchQuery=${h}&chapterSlug=${i}&page=${T}&limit=10`)).data||[];d(ne=>F?E:[...new Set([...ne,...E])]),I(E.length===10)}catch{u.error("Failed to fetch search results")}finally{b(!1)}}},C=r.useCallback(is(h=>c(h,1,!0),500),[]);r.useEffect(()=>{w(1),d([]),I(!0),C(p)},[p,C]);const D=h=>{h.target.scrollHeight-h.target.scrollTop===h.target.clientHeight&&!S&&M&&(c(p,k+1),w(T=>T+1))};r.useEffect(()=>{N&&(async()=>{try{const F=(await P.get(`/api/admin/chapters/${i}/roles`)).data;l(F);const Q=F.filter(E=>!!E.default).map(E=>E.roleId.toString());n([]),setTimeout(()=>n(Q),0)}catch{u.error("Failed to fetch roles")}})()},[N,i]);const R=h=>{v(h)},re=async()=>{var h,T;if(!t.length||!m){u.error("Please provide all details");return}try{await P.post(`/api/admin/chapter-member-list/${i}/members/${N.memberId}/addmember`,{role:t.join(","),joinDate:m.toISOString().split("T")[0]}),u.success("Member added successfully"),y(),a(),v(null),n([]),o(new Date)}catch(F){u.error(((T=(h=F.response)==null?void 0:h.data)==null?void 0:T.error)||"Failed to add member")}};return e.jsx(O,{open:s,onOpenChange:a,children:e.jsxs(A,{className:"sm:max-w-[600px]",children:[e.jsxs(K,{children:[e.jsxs($,{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5"}),"Add New Member"]}),e.jsx(U,{children:"Search and add members to your chapter"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(H,{placeholder:"Search by name or phone number...",value:p,onChange:h=>j(h.target.value),className:"pl-9 mb-4"})]}),e.jsxs(Oe,{className:"h-[300px] rounded-md border p-2",children:[S&&e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}),x.length>0?e.jsx("div",{className:"space-y-2",onScroll:D,children:x.map(h=>e.jsx(se,{className:"p-3 hover:bg-accent/50 transition-colors",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-primary/10 p-2 rounded-full",children:e.jsx($e,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:h.fullName}),e.jsx("p",{className:"text-sm text-muted-foreground",children:h.phoneNumber})]})]}),h.isInChapter===0&&e.jsx(g,{size:"sm",variant:"outline",onClick:()=>R(h),children:"Add Member"})]})},h.memberId))}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[e.jsx(q,{className:"w-8 h-8 mb-2"}),e.jsx("p",{children:"No members found"})]})]}),e.jsx(O,{open:N!==null,onOpenChange:()=>v(null),children:e.jsxs(A,{className:"sm:max-w-[425px]",children:[e.jsxs(K,{children:[e.jsx($,{children:"Member Details"}),e.jsx(U,{children:N&&`Adding ${N.fullName} to chapter`})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Roles"}),e.jsx(ae,{options:f.map(h=>({label:h.roleName,value:h.roleId.toString()})),onValueChange:n,defaultValue:t,placeholder:"Select member roles",maxCount:5,className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),"Join Date"]}),e.jsx(os,{selected:m,onChange:o,className:"w-full",dateFormat:"yyyy-MM-dd",placeholderText:"Select join date"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(g,{variant:"outline",onClick:()=>v(null),children:"Cancel"}),e.jsx(g,{onClick:re,children:"Add Member"})]})]})]})})]})})};function ds({isAddDialogOpen:s,onClose:a,fetchMembers:i}){const[y,p]=r.useState(""),[j,x]=r.useState(null),[d,S]=r.useState(!1),{chapterSlug:b}=z(),k=r.useRef(null),w=()=>{p(""),x(null)},M=async()=>{try{const l=await P.get(`/api/admin/chapters/${b}/bulk-members-add-get-template`,{responseType:"blob"}),t=new Blob([l.data],{type:l.headers["content-type"]}),n=URL.createObjectURL(t),m=document.createElement("a");m.href=n,m.setAttribute("download","members_template.xlsx"),document.body.appendChild(m),m.click(),document.body.removeChild(m)}catch(l){u.error("Failed to download the Excel template."),console.error("Template download error:",l)}},I=l=>{var m;const t=(m=l.target.files)==null?void 0:m[0];if(!t)return;if(!(t.name.endsWith(".xlsx")||t.name.endsWith(".xls"))){u.error("Only Excel files (.xlsx, .xls) are allowed."),p("");return}p(t.name),x(null),u.success(`Selected file: ${t.name}`)},N=async()=>{var n,m;const l=(m=(n=k.current)==null?void 0:n.files)==null?void 0:m[0];if(!l){u.error("Please select an Excel file to validate.");return}const t=new FormData;t.append("excelFile",l);try{const o=await P.post(`/api/admin/chapters/${b}/bulk-members-add-check-format`,t,{headers:{"Content-Type":"multipart/form-data"},responseType:"blob",validateStatus:()=>!0});if(o.status===200)u.success("Excel file validated successfully.");else{const c=new Blob([o.data],{type:o.headers["content-type"]}),C=URL.createObjectURL(c),D=document.createElement("a");D.href=C,D.setAttribute("download","validation_result.xlsx"),document.body.appendChild(D),D.click(),document.body.removeChild(D),u.error("Validation failed. Please check the downloaded file for details.")}}catch(o){u.error("Validation failed. Please check the file contents."),console.error("Validation error:",o)}},v=async()=>{var n,m;const l=(m=(n=k.current)==null?void 0:n.files)==null?void 0:m[0];if(!l){u.error("Please select an Excel file to submit.");return}S(!0);const t=new FormData;t.append("excelFile",l);try{const o=await P.post(`/api/admin/chapters/${b}/add-bulk-members`,t,{headers:{"Content-Type":"multipart/form-data"},validateStatus:()=>!0});o.status===200?(u.success("Members added successfully!"),p(""),x(null),a(),i()):(x(o.data.errorDetails),u.error("Submission failed. Please fix the errors below."))}catch(o){u.error("Submission failed. Please try again."),console.error("Submission error:",o)}finally{S(!1)}},f=(l,t)=>!t||t.length===0?null:e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-medium text-red-600",children:l}),e.jsx("ul",{className:"list-disc list-inside pl-4 mt-1 space-y-1",children:t.map((n,m)=>e.jsx("li",{className:"text-sm text-red-500",children:n.message},m))})]});return e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Super Admin Member Table"}),e.jsxs(O,{open:s,onOpenChange:a,children:[e.jsx(B,{asChild:!0,children:e.jsx(g,{onClick:w,children:"Add Bulk Member"})}),e.jsxs(A,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(K,{children:[e.jsx($,{className:"text-lg font-semibold",children:"Add Bulk Member"}),j&&e.jsxs("button",{onClick:()=>x(null),className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]}),j?e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-red-800",children:"Validation Errors Found"}),e.jsx("p",{className:"text-sm text-red-600 mt-1",children:"Please fix the following errors in your Excel file and try again."}),f("Duplicate Emails",j.duplicateEmail),f("Duplicate Phone Numbers",j.duplicatePhoneNumber),f("Missing First Names",j.noFirstName),f("Missing Contact Info",j.noPhoneAndEmail),f("Invalid Role Names",j.invalidRoleName),f("Missing Join Dates",j.noJoinDate),f("Missing Last Names",j.noLastName),e.jsx(g,{variant:"outline",className:"mt-4 w-full",onClick:()=>x(null),children:"Back to Upload"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-muted-foreground mt-2",children:[e.jsx("li",{children:"Download the template"}),e.jsx("li",{children:"Edit the template carefully"}),e.jsx("li",{children:"Upload the completed file"})]}),e.jsxs(g,{onClick:M,variant:"outline",className:"w-full mt-4 flex items-center justify-center gap-2",children:[e.jsx(Be,{className:"w-4 h-4"}),"Download Excel template"]}),e.jsxs("div",{onClick:()=>{var l;return(l=k.current)==null?void 0:l.click()},className:"border-2 border-dashed border-gray-300 rounded-xl p-6 mt-4 text-center cursor-pointer hover:bg-gray-50",children:[e.jsx(Le,{className:"mx-auto h-6 w-6 text-muted-foreground mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:y?`Selected: ${y}`:"No file chosen"}),e.jsx(H,{type:"file",accept:".xlsx, .xls",ref:k,onChange:I,className:"hidden"})]}),e.jsxs(L,{className:"mt-6 flex justify-end gap-2",children:[e.jsx(g,{variant:"secondary",onClick:N,disabled:d,children:d?"Validating...":"Validate"}),e.jsx(g,{onClick:v,disabled:d,children:d?"Submitting...":"Submit"})]})]})]})]})]})}const ms=()=>{const[s,a]=r.useState([]),[i,y]=r.useState(!0),[p,j]=r.useState(""),[x,d]=r.useState(!1),[S,b]=r.useState(!1),[k,w]=r.useState(0),M=ee(),I=new URLSearchParams(M.search),N=parseInt(I.get("rows"))||10,v=parseInt(I.get("page"))||0,{chapterSlug:f}=z(),[l,t]=r.useState([{roleId:1,roleName:"Admin",roleDescription:"Administrator role with full access",rights:"all",removable:!1},{roleId:2,roleName:"Editor",roleDescription:"Editor role with limited access",rights:"edit",removable:!0},{roleId:3,roleName:"Viewer",roleDescription:"Viewer role with read-only access",rights:"view",removable:!0},{roleId:6,roleName:"Member",roleDescription:"Member role with limited access",rights:"view",removable:!0}]);r.useEffect(()=>{n(),m()},[N,v,f,p]);const n=()=>{P.get(`/api/admin/chapter-member-list/${f}/members?rows=${N}&page=${v+1}&searchQuery=${p}`).then(o=>{const c=o.data.data.map(C=>({...C,onRoleEdit:()=>{handleRoleSelection(C.memberId,C.roles.map(D=>D.roleId),l)}}));a(c),w(o.data.totalRecords||o.data.length),y(!1)}).catch(()=>{u.error("Failed to fetch Members"),y(!1)})},m=()=>{P.get(`/api/admin/chapters/${f}/roles`).then(o=>{t(o.data)}).catch(()=>{u.error("Failed to fetch roles")})};return e.jsxs(se,{className:"p-5 shadow-md",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Super Admin Chapter Member Table"}),e.jsxs("div",{className:"flex gap-2 flex-wrap sm:gap-5",children:[e.jsx(g,{onClick:()=>d(!0),children:"Add Member"}),e.jsx(g,{onClick:()=>b(!0),children:"Add Bulk Member"})]})]}),e.jsx("div",{className:"mt-2",children:e.jsx(Fe,{onChange:o=>j(o.target.value),value:p,placeholder:"Search by member name, email, phone number or role",className:"mb-3 w-full"})})]}),i?e.jsx("p",{children:"Loading..."}):e.jsx(Ve,{data:s.map(o=>({...o,fetchMembers:n})),columns:He(l),searchInputField:"memberName",totalRecord:k,pagination:{pageSize:parseInt(N),pageIndex:parseInt(v)}}),e.jsx(cs,{isOpen:x,onClose:()=>d(!1),chapterSlug:f,fetchMembers:n}),e.jsx(ds,{isAddDialogOpen:S,onClose:()=>b(!1),fetchMembers:n})]})},Ys=()=>{const{chapterSlug:s}=z();return e.jsxs(e.Fragment,{children:[e.jsx(de,{items:[{name:"Dashboard",link:"/admin"},{name:"Chapter ",link:"/admin/chapters"},{name:"Chapter Members",link:`/admin/chapters/${s}/member`}]}),e.jsx(ms,{})]})};export{Ys as default};
