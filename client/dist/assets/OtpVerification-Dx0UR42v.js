import{d as Ve,r as t,j as r,e as ie,u as ze,a as $e,Q as ye,c as Pe,L as je,R as Ge,B as me}from"./index-eKwCJLll.js";import{B as qe}from"./Breadcrumb-kGt-xtkX.js";import{L as Qe}from"./logo-dark-BHjl3cne.js";import{L as Ye}from"./logo-ajku0Xcj.js";import{I as oe}from"./input-BhMSVbBI.js";import{L as le}from"./label-DUERygKs.js";import{n as Ze,p as Je,m as Ke,P as Ue}from"./phone-input-Bd0QS8aj.js";import{E as Ne}from"./eye-off-BG47N8sr.js";import{E as Ce}from"./eye-C1wxz2uY.js";import"./chevron-right-B55Ri9eq.js";import"./index-p0A_8czo.js";import"./index-B9lL--ie.js";import"./command-CwJtseYa.js";import"./index-Jch0bHuG.js";import"./index-D9_AVXgF.js";import"./index-CMxenybS.js";import"./dialog-B-Dd4jtF.js";import"./search-6lUvAzAk.js";import"./popover-SP_ZoDj-.js";import"./index-Irvr_6j-.js";import"./index-DCu9mJZ4.js";import"./scroll-area-C2UZZ45V.js";import"./index-Bn6wwOXp.js";import"./index-BdQq_4o_.js";import"./chevrons-up-down-B9hjxIQB.js";/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=[["path",{d:"M5 12h14",key:"1ays0h"}]],et=Ve("Minus",Xe);function tt(){var n=Ze(arguments),a=n.text,e=n.options,l=n.metadata;return Je(a,e,l)}var rt=Object.defineProperty,nt=Object.defineProperties,at=Object.getOwnPropertyDescriptors,ue=Object.getOwnPropertySymbols,Se=Object.prototype.hasOwnProperty,Oe=Object.prototype.propertyIsEnumerable,Ee=(n,a,e)=>a in n?rt(n,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[a]=e,st=(n,a)=>{for(var e in a||(a={}))Se.call(a,e)&&Ee(n,e,a[e]);if(ue)for(var e of ue(a))Oe.call(a,e)&&Ee(n,e,a[e]);return n},ot=(n,a)=>nt(n,at(a)),lt=(n,a)=>{var e={};for(var l in n)Se.call(n,l)&&a.indexOf(l)<0&&(e[l]=n[l]);if(n!=null&&ue)for(var l of ue(n))a.indexOf(l)<0&&Oe.call(n,l)&&(e[l]=n[l]);return e};function it(n){let a=setTimeout(n,0),e=setTimeout(n,10),l=setTimeout(n,50);return[a,e,l]}function ut(n){let a=t.useRef();return t.useEffect(()=>{a.current=n}),a.current}var ct=18,Te=40,dt=`${Te}px`,pt=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function mt({containerRef:n,inputRef:a,pushPasswordManagerStrategy:e,isFocused:l}){let[C,u]=t.useState(!1),[S,w]=t.useState(!1),[R,D]=t.useState(!1),A=t.useMemo(()=>e==="none"?!1:(e==="increase-width"||e==="experimental-no-flickering")&&C&&S,[C,S,e]),O=t.useCallback(()=>{let g=n.current,E=a.current;if(!g||!E||R||e==="none")return;let x=g,y=x.getBoundingClientRect().left+x.offsetWidth,f=x.getBoundingClientRect().top+x.offsetHeight/2,c=y-ct,W=f;document.querySelectorAll(pt).length===0&&document.elementFromPoint(c,W)===g||(u(!0),D(!0))},[n,a,R,e]);return t.useEffect(()=>{let g=n.current;if(!g||e==="none")return;function E(){let y=window.innerWidth-g.getBoundingClientRect().right;w(y>=Te)}E();let x=setInterval(E,1e3);return()=>{clearInterval(x)}},[n,e]),t.useEffect(()=>{let g=l||document.activeElement===a.current;if(e==="none"||!g)return;let E=setTimeout(O,0),x=setTimeout(O,2e3),y=setTimeout(O,5e3),f=setTimeout(()=>{D(!0)},6e3);return()=>{clearTimeout(E),clearTimeout(x),clearTimeout(y),clearTimeout(f)}},[a,l,e,O]),{hasPWMBadge:C,willPushPWMBadge:A,PWM_BADGE_SPACE_WIDTH:dt}}var Me=t.createContext({}),Ie=t.forwardRef((n,a)=>{var e=n,{value:l,onChange:C,maxLength:u,textAlign:S="left",pattern:w,placeholder:R,inputMode:D="numeric",onComplete:A,pushPasswordManagerStrategy:O="increase-width",pasteTransformer:g,containerClassName:E,noScriptCSSFallback:x=ft,render:y,children:f}=e,c=lt(e,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),W,ee,te,Q,Y;let[re,ce]=t.useState(typeof c.defaultValue=="string"?c.defaultValue:""),p=l??re,M=ut(p),L=t.useCallback(s=>{C==null||C(s),ce(s)},[C]),P=t.useMemo(()=>w?typeof w=="string"?new RegExp(w):w:null,[w]),m=t.useRef(null),Z=t.useRef(null),J=t.useRef({value:p,onChange:L,isIOS:typeof window<"u"&&((ee=(W=window==null?void 0:window.CSS)==null?void 0:W.supports)==null?void 0:ee.call(W,"-webkit-touch-callout","none"))}),$=t.useRef({prev:[(te=m.current)==null?void 0:te.selectionStart,(Q=m.current)==null?void 0:Q.selectionEnd,(Y=m.current)==null?void 0:Y.selectionDirection]});t.useImperativeHandle(a,()=>m.current,[]),t.useEffect(()=>{let s=m.current,o=Z.current;if(!s||!o)return;J.current.value!==s.value&&J.current.onChange(s.value),$.current.prev=[s.selectionStart,s.selectionEnd,s.selectionDirection];function h(){if(document.activeElement!==s){K(null),U(null);return}let d=s.selectionStart,b=s.selectionEnd,se=s.selectionDirection,k=s.maxLength,_=s.value,I=$.current.prev,B=-1,F=-1,H;if(_.length!==0&&d!==null&&b!==null){let We=d===b,_e=d===_.length&&_.length<k;if(We&&!_e){let V=d;if(V===0)B=0,F=1,H="forward";else if(V===k)B=V-1,F=V,H="backward";else if(k>1&&_.length>1){let pe=0;if(I[0]!==null&&I[1]!==null){H=V<I[1]?"backward":"forward";let He=I[0]===I[1]&&I[0]<k;H==="backward"&&!He&&(pe=-1)}B=pe+V,F=pe+V+1}}B!==-1&&F!==-1&&B!==F&&m.current.setSelectionRange(B,F,H)}let be=B!==-1?B:d,we=F!==-1?F:b,De=H??se;K(be),U(we),$.current.prev=[be,we,De]}if(document.addEventListener("selectionchange",h,{capture:!0}),h(),document.activeElement===s&&v(!0),!document.getElementById("input-otp-style")){let d=document.createElement("style");if(d.id="input-otp-style",document.head.appendChild(d),d.sheet){let b="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";X(d.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),X(d.sheet,`[data-input-otp]:autofill { ${b} }`),X(d.sheet,`[data-input-otp]:-webkit-autofill { ${b} }`),X(d.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),X(d.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let j=()=>{o&&o.style.setProperty("--root-height",`${s.clientHeight}px`)};j();let N=new ResizeObserver(j);return N.observe(s),()=>{document.removeEventListener("selectionchange",h,{capture:!0}),N.disconnect()}},[]);let[ne,ae]=t.useState(!1),[i,v]=t.useState(!1),[T,K]=t.useState(null),[G,U]=t.useState(null);t.useEffect(()=>{it(()=>{var s,o,h,j;(s=m.current)==null||s.dispatchEvent(new Event("input"));let N=(o=m.current)==null?void 0:o.selectionStart,d=(h=m.current)==null?void 0:h.selectionEnd,b=(j=m.current)==null?void 0:j.selectionDirection;N!==null&&d!==null&&(K(N),U(d),$.current.prev=[N,d,b])})},[p,i]),t.useEffect(()=>{M!==void 0&&p!==M&&M.length<u&&p.length===u&&(A==null||A(p))},[u,A,M,p]);let q=mt({containerRef:Z,inputRef:m,pushPasswordManagerStrategy:O,isFocused:i}),he=t.useCallback(s=>{let o=s.currentTarget.value.slice(0,u);if(o.length>0&&P&&!P.test(o)){s.preventDefault();return}typeof M=="string"&&o.length<M.length&&document.dispatchEvent(new Event("selectionchange")),L(o)},[u,L,M,P]),ge=t.useCallback(()=>{var s;if(m.current){let o=Math.min(m.current.value.length,u-1),h=m.current.value.length;(s=m.current)==null||s.setSelectionRange(o,h),K(o),U(h)}v(!0)},[u]),ve=t.useCallback(s=>{var o,h;let j=m.current;if(!g&&(!J.current.isIOS||!s.clipboardData||!j))return;let N=s.clipboardData.getData("text/plain"),d=g?g(N):N;s.preventDefault();let b=(o=m.current)==null?void 0:o.selectionStart,se=(h=m.current)==null?void 0:h.selectionEnd,k=(b!==se?p.slice(0,b)+d+p.slice(se):p.slice(0,b)+d+p.slice(b)).slice(0,u);if(k.length>0&&P&&!P.test(k))return;j.value=k,L(k);let _=Math.min(k.length,u-1),I=k.length;j.setSelectionRange(_,I),K(_),U(I)},[u,L,P,p]),Le=t.useMemo(()=>({position:"relative",cursor:c.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[c.disabled]),xe=t.useMemo(()=>({position:"absolute",inset:0,width:q.willPushPWMBadge?`calc(100% + ${q.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:q.willPushPWMBadge?`inset(0 ${q.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:S,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[q.PWM_BADGE_SPACE_WIDTH,q.willPushPWMBadge,S]),Be=t.useMemo(()=>t.createElement("input",ot(st({autoComplete:c.autoComplete||"one-time-code"},c),{"data-input-otp":!0,"data-input-otp-placeholder-shown":p.length===0||void 0,"data-input-otp-mss":T,"data-input-otp-mse":G,inputMode:D,pattern:P==null?void 0:P.source,"aria-placeholder":R,style:xe,maxLength:u,value:p,ref:m,onPaste:s=>{var o;ve(s),(o=c.onPaste)==null||o.call(c,s)},onChange:he,onMouseOver:s=>{var o;ae(!0),(o=c.onMouseOver)==null||o.call(c,s)},onMouseLeave:s=>{var o;ae(!1),(o=c.onMouseLeave)==null||o.call(c,s)},onFocus:s=>{var o;ge(),(o=c.onFocus)==null||o.call(c,s)},onBlur:s=>{var o;v(!1),(o=c.onBlur)==null||o.call(c,s)}})),[he,ge,ve,D,xe,u,G,T,c,P==null?void 0:P.source,p]),de=t.useMemo(()=>({slots:Array.from({length:u}).map((s,o)=>{var h;let j=i&&T!==null&&G!==null&&(T===G&&o===T||o>=T&&o<G),N=p[o]!==void 0?p[o]:null,d=p[0]!==void 0?null:(h=R==null?void 0:R[o])!=null?h:null;return{char:N,placeholderChar:d,isActive:j,hasFakeCaret:j&&N===null}}),isFocused:i,isHovering:!c.disabled&&ne}),[i,ne,u,G,T,c.disabled,p]),Fe=t.useMemo(()=>y?y(de):t.createElement(Me.Provider,{value:de},f),[f,de,y]);return t.createElement(t.Fragment,null,x!==null&&t.createElement("noscript",null,t.createElement("style",null,x)),t.createElement("div",{ref:Z,"data-input-otp-container":!0,style:Le,className:E},Fe,t.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},Be)))});Ie.displayName="Input";function X(n,a){try{n.insertRule(a)}catch{console.error("input-otp could not insert CSS rule:",a)}}var ft=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;const Re=t.forwardRef(({className:n,containerClassName:a,...e},l)=>r.jsx(Ie,{ref:l,containerClassName:ie("flex items-center gap-2 has-[:disabled]:opacity-50",a),className:ie("disabled:cursor-not-allowed",n),...e}));Re.displayName="InputOTP";const fe=t.forwardRef(({className:n,...a},e)=>r.jsx("div",{ref:e,className:ie("flex items-center",n),...a}));fe.displayName="InputOTPGroup";const z=t.forwardRef(({index:n,className:a,...e},l)=>{const C=t.useContext(Me),{char:u,hasFakeCaret:S,isActive:w}=C.slots[n];return r.jsxs("div",{ref:l,className:ie("relative flex h-9 w-9 items-center justify-center border-y border-r border-input text-sm shadow-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",w&&"z-10 ring-1 ring-ring",a),...e,children:[u,S&&r.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:r.jsx("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]})});z.displayName="InputOTPSlot";const Ae=t.forwardRef(({...n},a)=>r.jsx("div",{ref:a,role:"separator",...n,children:r.jsx(et,{})}));Ae.displayName="InputOTPSeparator";function ht(n,a){var e=Array.prototype.slice.call(a);return e.push(Ke),n.apply(this,e)}function ke(){return ht(tt,arguments)}const Ht=()=>{const n=ze(),e=$e().state,[l,C]=t.useState((e==null?void 0:e.identifier)||""),u=e==null?void 0:e.inputType,S=(e==null?void 0:e.selectedCountry)||"IN";console.log({identifier:l,inputType:u,selectedCountry:S});const[w,R]=t.useState(""),[D,A]=t.useState(""),[O,g]=t.useState(""),[E,x]=t.useState(!1),[y,f]=t.useState(""),[c,W]=t.useState(!1),[ee,te]=t.useState(!1),[Q,Y]=t.useState(!1),[re,ce]=t.useState(""),[p,M]=t.useState(!1),L=t.useRef(!1);t.useEffect(()=>{if(!(e!=null&&e.identifier))n("/auth/signin",{state:{from:e==null?void 0:e.from}});else if(e!=null&&e.identifier){if(u==="phone")try{ke(e.identifier)}catch(i){ye.error("Invalid phone number format. Redirecting to sign in."),console.error("Error parsing phone number:",i),f("Invalid phone number format."),n("/auth/signin",{state:{from:e==null?void 0:e.from}});return}}else te(!0)},[e,n,u]),t.useEffect(()=>{l&&(L.current||(P(),L.current=!0))},[l]);const P=async()=>{A("Sending OTP...");try{const i=await Pe.post("/api/auth/send-otp",{identifier:u==="phone"?l.slice(1):l});i.data.success?A(i.data.message):f(i.data.message)}catch(i){console.error("Error sending OTP:",i),i.response&&i.response.data?f(i.response.data.message||"Failed to send OTP."):f("Failed to send OTP. Please try again later.")}},m=async i=>{if(i.preventDefault(),O!==re){f("Passwords do not match.");return}Y(!0),f("");try{const v=await Pe.post("/api/auth/verify-otp",{identifier:u==="phone"?l.slice(1):l,otp:w,password:O});console.log("OTP verification response:",v),v.status===200?(ye.success("OTP verified successfully & password set successfully! Please login with your new password."),f(""),W(!0),n("/auth/signin",{state:{from:e==null?void 0:e.from}})):f(v.data.message)}catch(v){console.error("Error verifying OTP:",v),v.response&&v.response.data?f(v.response.data.message||"Failed to verify OTP."):f("Failed to verify OTP. Please try again later.")}finally{Y(!1)}},Z=i=>{C(i.target.value)},J=i=>{g(i.target.value)},$=i=>{ce(i.target.value)},ne=()=>{x(i=>!i)},ae=()=>{M(i=>!i)};return r.jsxs(r.Fragment,{children:[r.jsx(qe,{items:[{name:"Authentication",link:"/auth"},{name:"OTP Verification"}]}),r.jsxs("div",{className:"flex items-center justify-center flex-col",children:[r.jsx("div",{className:"rounded-sm border border-stroke bg-white shadow-default dark:border-strokedark dark:bg-boxdark p-8 max-w-md mx-auto",children:r.jsxs("div",{className:"flex flex-wrap items-center",children:[r.jsx("div",{className:"w-full text-center mb-6",children:r.jsxs(je,{to:"/",children:[r.jsx("img",{className:"hidden dark:block mx-auto",src:Ye,alt:"Logo"}),r.jsx("img",{className:"dark:hidden mx-auto",src:Qe,alt:"Logo"})]})}),r.jsxs("form",{className:"w-full",onSubmit:m,children:[r.jsxs("div",{className:"mb-4",children:[r.jsx(le,{htmlFor:"identifier",className:"block text-gray-700 dark:text-gray-300 mb-2",children:u==="phone"?"Phone Number":"Email Address"}),u==="phone"?r.jsx(Ue,{defaultCountry:S,value:l,onChange:()=>{},disabled:!0,inputComponent:Ge.forwardRef((i,v)=>{var T;return r.jsx(oe,{...i,ref:v,disabled:!0,value:ee?((T=ke(l))==null?void 0:T.nationalNumber)||l||"":l,autoComplete:"username"})})}):r.jsx(oe,{type:"email",id:"identifier",value:l,onChange:Z,required:!0,disabled:!0,autoComplete:"username"})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx(le,{htmlFor:"otp",className:"block text-gray-700 dark:text-gray-300 mb-2",children:"Enter OTP"}),r.jsx("div",{className:"flex justify-center",children:r.jsxs(Re,{value:w,onChange:i=>R(i),maxLength:6,children:[r.jsxs(fe,{children:[r.jsx(z,{index:0}),r.jsx(z,{index:1}),r.jsx(z,{index:2})]}),r.jsx(Ae,{}),r.jsxs(fe,{children:[r.jsx(z,{index:3}),r.jsx(z,{index:4}),r.jsx(z,{index:5})]})]})}),r.jsx("p",{className:"text-gray-500 mt-1 text-center",children:D})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx(le,{htmlFor:"newPassword",className:"block text-gray-700 dark:text-gray-300 mb-2",children:"New Password"}),r.jsxs("div",{className:"relative",children:[r.jsx(oe,{type:E?"text":"password",id:"newPassword",value:O,onChange:J,className:"pr-10",required:!0,autoComplete:"new-password"}),r.jsx(me,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:ne,tabIndex:-1,children:E?r.jsx(Ne,{className:"h-4 w-4"}):r.jsx(Ce,{className:"h-4 w-4"})})]})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx(le,{htmlFor:"confirmPassword",className:"block text-gray-700 dark:text-gray-300 mb-2",children:"Confirm Password"}),r.jsxs("div",{className:"relative",children:[r.jsx(oe,{type:p?"text":"password",id:"confirmPassword",value:re,onChange:$,className:"pr-10",required:!0,autoComplete:"new-password"}),r.jsx(me,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:ae,tabIndex:-1,children:p?r.jsx(Ne,{className:"h-4 w-4"}):r.jsx(Ce,{className:"h-4 w-4"})})]})]}),y&&r.jsx("div",{className:"mb-4 p-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md dark:text-red-400 dark:bg-red-900/20 dark:border-red-800",children:y}),c&&r.jsx("div",{className:"mb-4 p-3 text-sm text-green-600 bg-green-50 border border-green-200 rounded-md dark:text-green-400 dark:bg-green-900/20 dark:border-green-800",children:"OTP verified successfully! You can now log in with your new password."}),r.jsx(me,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white",disabled:Q,children:Q?"Verifying...":"Verify OTP and Set Password"})]}),r.jsx("div",{className:"mt-4 text-center",children:r.jsx(je,{to:"/auth/signin",className:"text-blue-500 hover:underline",children:"Back to Login"})})]})}),r.jsxs("div",{className:"mt-6 text-center flex text-gray-500 dark:text-gray-400",children:["A Product by",r.jsx("div",{className:"text-blue-500 hover:underline ml-1",children:r.jsx("a",{href:"https://simpliumtechnologies.com",target:"_blank",rel:"noopener noreferrer",children:"Simplium Technologies"})})]})]})]})};export{Ht as default};
