import{j as e,g as re,r as s,B as v,c as k,Q as f}from"./index-6elQxnHd.js";import{u as ve}from"./useWindowDimensions-C81w0-Th.js";import{B as Ne}from"./Breadcrumb-ME0YvNli.js";import{c as ne}from"./CircularProgress-zLMdsnkI.js";import{D as le,f as ke,a as ce,b as ie,c as oe,d as we,g as Ae,e as Ce}from"./dialog-CT_lOUQb.js";import{I as de}from"./input-Dp_r379b.js";import{A as Se,e as Ie,a as De,b as Te,c as Me,d as Pe,g as Re,h as Ee}from"./alert-dialog-BqU3jmle.js";import{T as Be}from"./textarea-CmNayNfB.js";import{T as U,a as X,b as M,c as j,d as G,e as x}from"./table-CMz5QLeZ.js";import{L as W}from"./label-Duevo3Y3.js";import{S as $e,a as _e,b as ze,c as Oe,d as Le}from"./select-BctcFQZm.js";import{C as Fe,a as qe,b as Ye,c as He,e as Qe}from"./command-DbqVVo4r.js";import{I as Ve}from"./IconButton-DdOZkmlf.js";import"./chevron-right-DA45-pzU.js";import"./TransitionGroupContext-DpYB3VE9.js";import"./index-CgP8r1n9.js";import"./index-BGKEPXry.js";import"./index-BLdKwkXj.js";import"./index-CE4AQY6s.js";import"./index-BdQq_4o_.js";import"./index-CWa4kTbH.js";import"./index-BvgCK6ys.js";import"./index-BXCPHgg9.js";import"./index-BIhwVmuG.js";import"./index-DSJunp_n.js";import"./chevron-down-BUZeX_Bt.js";import"./search-C_1baVLY.js";const We=ne(e.jsx("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"Refresh"),Ue=()=>{const{chapterData:c}=re(),[N,i]=s.useState(!1),[I,r]=s.useState([]),[C,p]=s.useState(0),[D,u]=s.useState(""),[T,S]=s.useState(""),[n,w]=s.useState(!1),P=()=>{u(""),S(""),w(!1),i(!1)};s.useEffect(()=>{N&&(async()=>{try{const y=(await k(`/api/chapter-payment/${c.chapterId}/approved-transactions`)).data;r(y.transactions),p(y.totalAmount)}catch(g){console.error("Error fetching transactions:",g)}})()},[N]);const d=async()=>{try{(await k.post(`/api/chapter-payment/${c.chapterId}/pay-to-chapter`,{totalAmount:C,transferredAmount:D,remark:T})).data.success&&(f.success("Amount transferred successfully"),P())}catch(m){console.error("Error transferring amount:",m),f.error("Error transferring amount")}};return e.jsxs("div",{className:"p-4",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-2",children:"Transfer Collected Fees"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Transfer all approved & untransferred transactions to your chapter."}),e.jsxs(le,{open:N,onOpenChange:i,children:[e.jsx(ke,{asChild:!0,children:e.jsx(v,{onClick:()=>i(!0),children:"Transfer Now"})}),e.jsxs(ce,{className:"max-w-xl",children:[e.jsx(ie,{className:"mb-4",children:e.jsx(oe,{children:"Confirm Transfer Details"})}),e.jsxs("div",{className:"mb-4 space-y-4",children:[e.jsx("div",{className:"overflow-y-auto rounded-md border max-h-64",children:e.jsxs(U,{children:[e.jsx(X,{children:e.jsxs(M,{children:[e.jsx(j,{children:"Sr No."}),e.jsx(j,{children:"Member Name"}),e.jsx(j,{children:"Amount"}),e.jsx(j,{children:"Payment Type"})]})}),e.jsx(G,{children:I.map((m,g)=>e.jsxs(M,{children:[e.jsx(x,{children:g+1}),e.jsxs(x,{children:[m.firstName," ",m.lastName]}),e.jsx(x,{children:m.paidAmount}),e.jsx(x,{children:m.paymentType})]},m.id))})]})}),e.jsx("div",{children:e.jsxs("p",{className:"font-medium",children:["Original Total Amount: ",C]})}),e.jsx(de,{type:"number",value:D,onChange:m=>u(m.target.value),placeholder:"Enter amount you are transferring"}),e.jsx(Be,{placeholder:"Add a remark (optional)",value:T,onChange:m=>S(m.target.value)})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(Xe,{showAlert:n,setShowAlert:w,totalAmount:C,amount:D,remark:T,handleTransfer:d})}),e.jsx(we,{className:"mt-4",children:e.jsx(Ae,{asChild:!0,children:e.jsx(v,{variant:"outline",onClick:P,children:"Cancel & Reset"})})})]})]})]})},Xe=({showAlert:c,setShowAlert:N,totalAmount:i,amount:I,remark:r,handleTransfer:C})=>{const p=i-Number(I);return e.jsxs(Se,{open:c,onOpenChange:N,children:[e.jsx(Ie,{asChild:!0,children:e.jsx(v,{variant:"default",onClick:()=>N(!0),children:"Confirm Transfer"})}),e.jsxs(De,{children:[e.jsx(Te,{children:e.jsx(Me,{children:"Are you sure you want to transfer?"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:["Total Collected: â‚¹",i]}),e.jsxs("p",{children:["Transfer Amount: â‚¹",I]}),e.jsx("p",{className:"text-yellow-600",children:p!==0&&`Note: Difference of â‚¹${p>0?p:-p}`}),r&&e.jsxs("p",{children:["Remark: ",r]})]}),e.jsxs(Pe,{children:[e.jsx(Re,{children:"Cancel"}),e.jsx(Ee,{onClick:C,children:"Confirm"})]})]})]})},Ge=({receivedAmount:c,setReceivedAmount:N,selectedReceiver:i,setSelectedReceiver:I,selectedPaymentMode:r,setSelectedPaymentMode:C,receiverList:p,allMembers:D,showAllMembers:u,setShowAllMembers:T,paymentModes:S,selectedFee:n,canChangeReceiver:w,setCanChangeReceiver:P,onCancel:d,onSave:m,onApprove:g,saveDisabled:y,approveDisabled:R})=>{const[z,O]=s.useState(!1),[B,q]=s.useState(null),[Y,L]=s.useState(null);s.useEffect(()=>{if(!n)return;const t=parseFloat(c)||0,$=parseFloat(n.payableAmount)||0,E=parseFloat(n.platformFee)||0,H=parseFloat(n.receiverFee)||0;q(t-$),L(t-E-H)},[c,n]);const F=p.find(t=>t.memberId===i);return e.jsxs("div",{className:"space-y-4 py-4 w-full max-w-md mx-auto sm:max-w-lg md:max-w-xl lg:max-w-2xl px-2 sm:px-4",style:{maxWidth:"100vw",overflowX:"hidden"},children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Member Details:"}),e.jsxs("p",{className:"text-sm",children:[n==null?void 0:n.firstName," ",n==null?void 0:n.lastName]}),e.jsxs("p",{className:"text-sm",children:["Package: ",n==null?void 0:n.packageName]}),e.jsxs("p",{className:"text-sm",children:["Original Payable Amount: â‚¹",n==null?void 0:n.payableAmount]}),e.jsxs("p",{className:"text-sm",children:["Expected Amount: â‚¹",n==null?void 0:n.paidAmount]}),e.jsxs("p",{className:"text-sm",children:["Dues: â‚¹",n==null?void 0:n.balanceAmount]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{htmlFor:"amount",children:"Amount Received"}),e.jsx(de,{id:"amount",type:"number",value:c,onChange:t=>N(t.target.value),placeholder:"Enter amount received",className:"w-full"}),e.jsxs("div",{className:"flex flex-col gap-1 mt-2",children:[e.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:["Live Balance Amount: ",e.jsxs("span",{className:B===0?"text-green-700 dark:text-green-300":B<0?"text-red-700 dark:text-red-300":"text-yellow-700 dark:text-yellow-300",children:["â‚¹",B??"-"]})]}),e.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:["Amount Paid to Chapter: ",e.jsxs("span",{className:"text-blue-700 dark:text-blue-300",children:["â‚¹",Y??"-"]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{htmlFor:"receiver",children:"Receiver"}),!w&&e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-300 mb-2",children:F?e.jsxs(e.Fragment,{children:[F.receiverName," is the receiver for this payment."," ",e.jsx("button",{className:"text-blue-600 underline ml-1",type:"button",onClick:()=>P(!0),children:"Not the receiver? Click here to change"})]}):e.jsxs(e.Fragment,{children:["Receiver not found."," ",e.jsx("button",{className:"text-blue-600 underline ml-1",type:"button",onClick:()=>P(!0),children:"Click here to select"})]})}),w&&e.jsxs("div",{className:"relative",children:[e.jsxs(v,{type:"button",variant:"outline",className:"w-full flex justify-between items-center",onClick:()=>O(t=>!t),children:[(()=>{const t=(u?D:p).find($=>$.memberId===i);return t?t.receiverName||t.firstName+" "+t.lastName:"Select receiver"})(),e.jsx("span",{className:"ml-2",children:"â–¼"})]}),z&&e.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white dark:bg-boxdark border rounded shadow-lg max-h-60 overflow-y-auto",children:e.jsxs(Fe,{className:"w-full border-none shadow-none",children:[e.jsx(qe,{placeholder:"Search receiver..."}),e.jsxs(Ye,{children:[(u?D:p).length===0&&e.jsx(He,{children:"No receivers found."}),(u?D:p).map(t=>e.jsx(Qe,{value:t.memberId,onSelect:()=>{I(t.memberId),O(!1)},className:i===t.memberId?"bg-blue-100 dark:bg-blue-700":"",children:t.receiverName||t.firstName+" "+t.lastName},t.memberId))]})]})}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:()=>T(!u),id:"showAllMembers",className:"mr-2"}),e.jsx("label",{htmlFor:"showAllMembers",className:"text-xs",children:"Show all members"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{htmlFor:"paymentMode",children:"Payment Mode"}),e.jsxs($e,{value:r,onValueChange:C,children:[e.jsx(_e,{className:"w-full",children:e.jsx(ze,{placeholder:"Select payment mode"})}),e.jsx(Oe,{className:"max-h-60 overflow-y-auto",children:S.map(t=>e.jsx(Le,{value:t.value,children:t.label},t.value))})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[d&&e.jsx(v,{variant:"outline",onClick:d,children:"Cancel"}),e.jsx(v,{variant:"secondary",onClick:m,disabled:y,children:"Save Changes"}),e.jsx(v,{onClick:g,disabled:R,children:"Save & Approve"})]})]})},te=ne(e.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit"),Je=[{value:"cash",label:"Cash"},{value:"online",label:"Online/UPI/QR"},{value:"cheque",label:"Cheque"},{value:"other",label:"Other"}],Da=()=>{const[c,N]=s.useState([]),[i,I]=s.useState([]),{chapterData:r}=re(),{width:C}=ve(),[p,D]=s.useState([]),[u,T]=s.useState({allowAllMembersApproval:!1,currentState:"self_approval"}),[S,n]=s.useState("pending"),[w,P]=s.useState({totalCollected:0,pendingAmount:0,approvedAmount:0,totalTransferredToChapter:0,remainingToTransfer:0}),[d,m]=s.useState(null),[g,y]=s.useState({}),[R,z]=s.useState(""),[O,B]=s.useState([]),[q,Y]=s.useState([]),[L,F]=s.useState(!1),[t,$]=s.useState(""),[E,H]=s.useState(""),[Ke,J]=s.useState(!1),[Ze,ea]=s.useState(),[aa,K]=s.useState(!1),[me,Z]=s.useState(!1),[xe,Q]=s.useState(!1);console.log({pendingFees:c}),s.useEffect(()=>{r!=null&&r.chapterId&&(_(),ge())},[r]),s.useEffect(()=>{r!=null&&r.chapterId&&(_(),je())},[u.currentState,S,r]);const pe=a=>{const l=a.getDate().toString().padStart(2,"0"),o=(a.getMonth()+1).toString().padStart(2,"0"),h=a.getFullYear();return`${l}-${o}-${h}`},he=async()=>{if(r!=null&&r.chapterId)try{const a=await k.get(`/api/feeReceiver/current/${r.chapterId}`,{params:{date:pe(new Date)}});B(a.data||[])}catch{B([])}},ue=async()=>{if(r!=null&&r.chapterId)try{const a=await k.get(`/api/member/all?chapterId=${r.chapterId}`);Y(a.data||[])}catch{Y([])}},ge=async()=>{try{const a=await k.get(`/api/rights/anyMemberApprovePayment/${r==null?void 0:r.chapterId}`);console.log({response:a}),T(l=>{var o;return{...l,allowAllMembersApproval:(o=a==null?void 0:a.data)==null?void 0:o.allowed}})}catch(a){console.error("Fetching rights failed:",a)}},_=async(a=S)=>{try{const l=await k.post(`/api/payment/paymentRequests/${r==null?void 0:r.chapterId}`,{status:a,currentState:u.currentState});console.log({response:l}),console.log({got:l.data}),a==="pending"?N(l.data):I(l.data)}catch(l){console.error("Fetching fees failed:",l)}},je=async()=>{try{const a=await k.get(`/api/payment/metaData/${r==null?void 0:r.chapterId}`);console.log({response:a}),P(a.data)}catch(a){console.error("Fetching metadata failed:",a)}};console.log({selectedApprovals:p});const be=async()=>{try{const a=c.filter(l=>p.includes(l.transactionId));console.log({data:a}),await k.put("/api/payment/approvePendingPayment",{transactionDetails:a}),N(l=>l.filter(o=>!p.includes(o.transactionId))),D([]),f.success("Fees confirmed successfully")}catch(a){f.error("Could not confirm fees. Please try again later."),console.error("Confirming fees failed:",a)}},ee=async a=>{var l,o;try{y(A=>({...A,[a]:!0}));const h=c.find(A=>A.transactionId===a),b=await k.put("/api/payment/approvePendingPayment",{transactionDetails:[h]});b.data.success?(N(A=>A.filter(V=>V.transactionId!==a)),f.success("Fee approved successfully")):f.error(b.data.message||"Could not approve fee")}catch(h){console.error("Approving fee failed:",h),f.error(((o=(l=h.response)==null?void 0:l.data)==null?void 0:o.message)||"Could not approve fee. Please try again later.")}finally{y(h=>({...h,[a]:!1}))}},ae=async a=>{var l,o;try{y(A=>({...A,[a]:!0}));const h=i.find(A=>A.transactionId===a),b=await k.put("/api/payment/moveApprovedToPending",{transactionDetails:[h]});b.data.success?(I(A=>A.filter(V=>V.transactionId!==a)),f.success("Fee moved to pending successfully"),_("pending")):f.error(b.data.message||"Could not move fee")}catch(h){console.error("Moving fee to pending failed:",h),f.error(((o=(l=h.response)==null?void 0:l.data)==null?void 0:o.message)||"Could not move fee. Please try again later.")}finally{y(h=>({...h,[a]:!1}))}},se=a=>{m(a),z(a.paidAmount.toString()),$(a.paymentReceivedById||""),H(a.paymentType||""),K(!1),F(!1),Z(!1),he(),Q(!0)};s.useEffect(()=>{L&&ue()},[L]),s.useEffect(()=>{d&&K(R!==d.paidAmount.toString()||t!==(d.paymentReceivedById||"")||E!==(d.paymentType||""))},[R,t,E,d]);const fe=async()=>{var a,l,o,h;if(J(!1),!!d){y(b=>({...b,[d.transactionId]:!0}));try{await k.put("/api/payment/saveEditedFeeDetails",{transactionId:d.transactionId,updateFields:{paidAmount:parseFloat(R),paymentReceivedById:t,paymentType:E,paymentReceivedByName:((a=q.find(b=>b.memberId===t))==null?void 0:a.firstName)||((l=O.find(b=>b.memberId===t))==null?void 0:l.receiverName)||"",payableAmount:d.payableAmount}}),f.success("Details saved successfully"),_(),m(null),Q(!1)}catch(b){f.error(((h=(o=b.response)==null?void 0:o.data)==null?void 0:h.message)||"Could not save changes")}finally{y(b=>({...b,[d.transactionId]:!1}))}}},ye=async()=>{var a,l;if(J(!1),!!d){y(o=>({...o,[d.transactionId]:!0}));try{await k.put("/api/payment/approvePendingPayment",{transactionDetails:[{...d,paidAmount:parseFloat(R),paymentReceivedById:t,paymentType:E,status:"approved"}]}),f.success("Fee approved successfully"),_(),m(null)}catch(o){f.error(((l=(a=o.response)==null?void 0:a.data)==null?void 0:l.message)||"Could not approve fee")}finally{y(o=>({...o,[d.transactionId]:!1}))}}};return e.jsxs(e.Fragment,{children:[e.jsx(Ne,{items:[{name:"Member Fee Approval"}]}),e.jsxs("div",{className:"rounded-sm border border-stroke bg-white p-3 shadow-default dark:border-strokedark dark:bg-boxdark sm:px-7.5 xl:pb-1",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-medium dark:text-white",children:"Member Fee Approvals"}),e.jsx(Ve,{"aria-label":"refresh",onClick:()=>_(),children:e.jsx(We,{className:"dark:text-white"})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-100 dark:bg-meta-4 p-4 rounded-md shadow",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Total Collected"}),e.jsxs("p",{className:"text-lg font-semibold dark:text-white",children:["â‚¹",w.totalCollected]})]}),e.jsxs("div",{className:"bg-yellow-100 dark:bg-yellow-700 p-4 rounded-md shadow",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Pending Approvals"}),e.jsxs("p",{className:"text-lg font-semibold dark:text-white",children:["â‚¹",w.pendingAmount]})]}),e.jsxs("div",{className:"bg-green-100 dark:bg-green-700 p-4 rounded-md shadow",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Approved Fees"}),e.jsxs("p",{className:"text-lg font-semibold dark:text-white",children:["â‚¹",w.approvedAmount]})]}),e.jsxs("div",{className:"bg-blue-100 dark:bg-blue-700 p-4 rounded-md shadow",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Transferred to Chapter"}),e.jsxs("p",{className:"text-lg font-semibold dark:text-white",children:["â‚¹",w.totalTransferredToChapter]})]})]}),w.remainingToTransfer>0?e.jsx(Ue,{}):e.jsx("div",{className:"text-center text-gray-600 dark:text-gray-300 mt-4",children:"ðŸŽ‰ All approved fees have been transferred to the chapter!"}),e.jsxs("div",{className:"flex mb-4",children:[e.jsx("button",{className:`px-4 py-2 rounded-l ${S==="pending"?"bg-blue-600 text-white":"bg-gray-300 text-black dark:bg-gray-700 dark:text-white"}`,onClick:()=>n("pending"),children:"Pending"}),e.jsx("button",{className:`px-4 py-2 rounded-r ${S==="approved"?"bg-blue-600 text-white":"bg-gray-300 text-black dark:bg-gray-700 dark:text-white"}`,onClick:()=>n("approved"),children:"Approved"})]}),u.allowAllMembersApproval&&e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("label",{className:"mr-2 text-black dark:text-white",children:"Approval Mode:"}),e.jsx("button",{className:`px-4 py-2 rounded ${u.currentState==="self_approval"?"bg-blue-600 text-white":"bg-gray-300 text-black dark:bg-gray-700 dark:text-white"}`,onClick:()=>{T(a=>({...a,currentState:a.currentState==="self_approval"?"all_members_approval":"self_approval"}))},children:u.currentState==="self_approval"?"Switch To All Requests":"Switch To My Requests"})]}),S==="pending"?e.jsxs(e.Fragment,{children:[C>700?e.jsx("div",{className:"overflow-x-auto rounded-lg border border-solid",children:e.jsxs(U,{children:[e.jsx(X,{children:e.jsxs(M,{children:[e.jsx(j,{children:"Member Name"}),e.jsx(j,{children:"Package Name"}),e.jsx(j,{children:"Date"}),e.jsx(j,{children:"Amount Paid"}),e.jsx(j,{children:"Balance"}),u.currentState==="all_members_approval"&&e.jsx(j,{children:"Received By"}),e.jsx(j,{children:"Approve"})]})}),e.jsx(G,{children:(c==null?void 0:c.length)===0?e.jsx(M,{children:e.jsx(x,{colSpan:6,className:"text-center",children:"No pending fees to approve."})}):c==null?void 0:c.map(a=>e.jsxs(M,{children:[e.jsxs(x,{children:[a.firstName," ",a.lastName]}),e.jsx(x,{children:a.packageName}),e.jsx(x,{children:new Date(a.transactionDate).toLocaleDateString()}),e.jsx(x,{children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:2}).format(a.paidAmount)}),e.jsx(x,{children:e.jsxs("span",{className:a.balanceAmount<0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400",children:[new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:2}).format(Math.abs(a.balanceAmount)),a.balanceAmount<0?" (Due)":" (Advance)"]})}),u.currentState==="all_members_approval"&&e.jsx(x,{children:a.paymentReceivedByName||"-"}),e.jsx(x,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:()=>ee(a.transactionId),className:"h-8 px-2",disabled:g[a.transactionId],children:g[a.transactionId]?e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent"}):e.jsx("span",{className:"text-xs",children:"Quick Approve"})}),e.jsx(v,{variant:"outline",size:"sm",className:"h-8 px-2",onClick:()=>se(a),disabled:g[a.transactionId],children:e.jsxs("span",{className:"text-xs flex items-center",children:[e.jsx(te,{fontSize:"small",className:"mr-1"}),"Edit"]})})]})})]},a.transactionId))})]})}):e.jsx("div",{className:"flex flex-col space-y-4",children:(c==null?void 0:c.length)===0?e.jsx("p",{className:"text-center text-black dark:text-white",children:"No pending fees to approve."}):c==null?void 0:c.map(a=>e.jsxs("div",{className:"border rounded-lg p-4 shadow-md dark:border-strokedark bg-white dark:bg-boxdark flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-black dark:text-white font-medium text-base",children:[a.firstName," ",a.lastName]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Package:"," ",e.jsx("span",{className:"font-semibold",children:a.packageName})]}),u.currentState==="all_members_approval"&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Received By:"," ",e.jsx("span",{className:"font-semibold",children:a.paymentReceivedByName||"-"})]})]}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(a.transactionDate).toLocaleDateString()})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-2",children:[e.jsxs("div",{className:"flex-1 min-w-[120px]",children:[e.jsx("span",{className:"block text-xs text-gray-500 dark:text-gray-400",children:"Amount Paid"}),e.jsxs("span",{className:"block text-base font-semibold text-green-700 dark:text-green-300",children:["â‚¹",a.paidAmount]})]}),e.jsxs("div",{className:"flex-1 min-w-[120px]",children:[e.jsx("span",{className:"block text-xs text-gray-500 dark:text-gray-400",children:"Balance"}),e.jsxs("span",{className:`block text-base font-semibold ${a.balanceAmount<0?"text-red-700 dark:text-red-300":"text-green-700 dark:text-green-300"}`,children:["â‚¹",Math.abs(a.balanceAmount)," ",a.balanceAmount<0?"(Due)":"(Advance)"]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:()=>ee(a.transactionId),className:"h-8 px-2",disabled:g[a.transactionId],children:g[a.transactionId]?e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent"}):e.jsx("span",{className:"text-xs",children:"Quick Approve"})}),e.jsx(v,{variant:"outline",size:"sm",className:"h-8 px-2",onClick:()=>se(a),disabled:g[a.transactionId],children:e.jsxs("span",{className:"text-xs flex items-center",children:[e.jsx(te,{fontSize:"small",className:"mr-1"}),"Edit"]})})]})]},a.transactionId))}),(p==null?void 0:p.length)>0&&e.jsx("button",{className:"mt-4 bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700",onClick:be,children:"Confirm Selected Approvals"})]}):e.jsx(e.Fragment,{children:C>700?e.jsx("div",{className:"overflow-x-auto rounded-lg",children:e.jsxs(U,{children:[e.jsx(X,{children:e.jsxs(M,{children:[e.jsx(j,{children:"Member Name"}),e.jsx(j,{children:"Package Name"}),e.jsx(j,{children:"Date"}),e.jsx(j,{children:"Amount Paid"}),e.jsx(j,{children:"Balance"}),e.jsx(j,{children:"Actions"})]})}),e.jsx(G,{children:(i==null?void 0:i.length)===0?e.jsx(M,{children:e.jsx(x,{colSpan:5,className:"text-center",children:"No approved fees."})}):i==null?void 0:i.map(a=>e.jsxs(M,{children:[e.jsxs(x,{children:[a.firstName," ",a.lastName]}),e.jsx(x,{children:a.packageName}),e.jsx(x,{children:new Date(a.transactionDate).toLocaleDateString()}),e.jsx(x,{children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:2}).format(a.paidAmount)}),e.jsx(x,{children:e.jsxs("span",{className:a.balanceAmount<0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400",children:[new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:2}).format(Math.abs(a.balanceAmount)),a.balanceAmount<0?" (Due)":" (Advance)"]})}),e.jsx(x,{children:e.jsx(v,{variant:"outline",size:"sm",className:"h-8 px-2",onClick:()=>ae(a.transactionId),disabled:g[a.transactionId],children:g[a.transactionId]?e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent"}):e.jsx("span",{className:"text-xs",children:"Move to Pending"})})})]},a.transactionId))})]})}):e.jsx("div",{className:"flex flex-col space-y-4",children:(i==null?void 0:i.length)===0?e.jsx("p",{className:"text-center text-black dark:text-white",children:"No approved fees."}):i==null?void 0:i.map(a=>e.jsxs("div",{className:"border rounded-lg p-4 shadow-md dark:border-strokedark bg-white dark:bg-boxdark flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-black dark:text-white font-medium text-base",children:[a.firstName," ",a.lastName]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Package:"," ",e.jsx("span",{className:"font-semibold",children:a.packageName})]})]}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(a.transactionDate).toLocaleDateString()})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-2",children:[e.jsxs("div",{className:"flex-1 min-w-[120px]",children:[e.jsx("span",{className:"block text-xs text-gray-500 dark:text-gray-400",children:"Amount Paid"}),e.jsxs("span",{className:"block text-base font-semibold text-green-700 dark:text-green-300",children:["â‚¹",a.paidAmount]})]}),e.jsxs("div",{className:"flex-1 min-w-[120px]",children:[e.jsx("span",{className:"block text-xs text-gray-500 dark:text-gray-400",children:"Balance"}),e.jsxs("span",{className:`block text-base font-semibold ${a.balanceAmount<0?"text-red-700 dark:text-red-300":"text-green-700 dark:text-green-300"}`,children:["â‚¹",Math.abs(a.balanceAmount)," ",a.balanceAmount<0?"(Due)":"(Advance)"]})]})]}),e.jsx("div",{className:"flex gap-2 mt-4",children:e.jsx(v,{variant:"outline",size:"sm",className:"h-8 px-2",onClick:()=>ae(a.transactionId),disabled:g[a.transactionId],children:g[a.transactionId]?e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent"}):e.jsx("span",{className:"text-xs",children:"Move to Pending"})})})]},a.transactionId))})})]}),e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(le,{open:xe,onOpenChange:Q,children:e.jsx(ce,{className:"!p-0",style:{width:"100%",maxHeight:"calc(100vh - 20px)",overflowY:"auto",borderRadius:12,display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs(ie,{children:[e.jsx(oe,{children:"Edit Fee Payment"}),e.jsx(Ce,{children:"Edit details, change receiver, payment mode, or approve/save changes"})]}),e.jsx(Ge,{receivedAmount:R,setReceivedAmount:z,selectedReceiver:t,setSelectedReceiver:$,selectedPaymentMode:E,setSelectedPaymentMode:H,receiverList:O,allMembers:q,showAllMembers:L,setShowAllMembers:F,paymentModes:Je,selectedFee:d,canChangeReceiver:me,setCanChangeReceiver:Z,onCancel:()=>{Q(!1),m(null),z("")},onSave:fe,onApprove:ye})]})})})})]})};export{Da as default};
