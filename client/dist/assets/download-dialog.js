const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web2.js","assets/index.js","assets/index.css","assets/index14.js","assets/table2.js","assets/usePagination.js","assets/select.js","assets/index10.js","assets/index4.js","assets/index11.js","assets/index9.js","assets/index5.js","assets/index7.js","assets/index8.js","assets/index12.js","assets/chevron-down.js","assets/check.js","assets/chevron-up.js","assets/format.js","assets/dialog.js","assets/index3.js","assets/index6.js","assets/circle-check-big.js","assets/share.js","assets/web3.js"])))=>i.map(i=>d[i]);
import{u as B,a as M,r as F,j as t,a0 as E,_,a1 as U,R as $,m as A,Q as S,B as k}from"./index.js";import{u as O,g as H,a as I,f as T}from"./index14.js";import{T as W,a as K,b as D,c as V,d as z,e as P}from"./table2.js";import{u as Y,c as q}from"./usePagination.js";import"./select.js";import{f as Q}from"./format.js";import{D as X,a as G,b as J,c as Z,e as ee,d as ae}from"./dialog.js";import{C as te}from"./circle-check-big.js";import{S as se,F as v}from"./share.js";function fe({columns:s,data:e,searchInputField:a,filterField:o,filterFieldName:r,filterCategoriesList:n,totalRecord:h,children:d}){var g;const i=B(),{rows:l,onPaginationChange:u,page:c,pagination:m}=Y(),x=M(),R=()=>{const p=new URLSearchParams(x.search),w=q({rows:l,page:c},p);i(`?${w}`,{replace:!0})};F.useEffect(()=>{R()},[l,c]);const f=O({data:e,columns:s,getCoreRowModel:I(),manualPagination:!0,onPaginationChange:u,state:{pagination:m},rowCount:h,getSortedRowModel:H()}),b=F.Children.map(d,p=>F.isValidElement(p)?F.cloneElement(p,{table:f,searchInputField:a,filterField:o,filterFieldName:r,filterCategoriesList:n}):p);return t.jsxs("div",{className:"space-y-4",children:[b,t.jsx("div",{className:"overflow-y-auto rounded-md border",children:t.jsxs(W,{children:[t.jsx(K,{children:f.getHeaderGroups().map(p=>t.jsx(D,{children:p.headers.map(w=>t.jsx(V,{className:"px-4 py-2 bg-newprimaryColor text-white font-raleway",colSpan:w.colSpan,children:w.isPlaceholder?null:T(w.column.columnDef.header,w.getContext())},w.id))},p.id))}),t.jsx(z,{className:"bg-adminBreadCrumbsBg font-raleway",children:(g=f.getRowModel().rows)!=null&&g.length?f.getRowModel().rows.map(p=>t.jsx(D,{"data-state":p.getIsSelected()&&"selected",children:p.getVisibleCells().map(w=>t.jsx(P,{className:"px-4 py-2",children:T(w.column.columnDef.cell,w.getContext())},w.id))},p.id)):t.jsx(D,{children:t.jsx(P,{colSpan:s.length,className:"h-24 text-center bg-adminBreadCrumbsBg font-raleway",children:"No results."})})})]})})]})}const ye=[{id:"srno",header:()=>t.jsx("p",{children:"Sr. No."}),cell:s=>t.jsx("p",{children:s.row.index+1}),enableSorting:!1,enableHiding:!1},{accessorKey:"transactionDate",header:()=>t.jsx("p",{children:"Date"}),cell:({row:s})=>t.jsx("p",{className:"text-sm font-medium",children:Q(new Date(s.original.transactionDate),"dd-MM-yyyy")}),enableSorting:!1,enableHiding:!1},{accessorKey:"type",header:()=>t.jsx("p",{children:"Type"}),cell:({row:s})=>t.jsx("p",{className:"text-sm font-medium",children:s.original.type}),enableSorting:!1,enableHiding:!1},{accessorKey:"description",header:()=>t.jsx("p",{children:"Description"}),cell:({row:s})=>t.jsx("p",{className:"text-sm font-medium",children:s.original.description}),enableSorting:!1,enableHiding:!1},{accessorKey:"debit",header:()=>t.jsx("p",{children:"Debit"}),cell:({row:s})=>t.jsx("p",{className:"text-sm font-medium",children:s.original.debit}),enableSorting:!1,enableHiding:!1},{accessorKey:"credit",header:()=>t.jsx("p",{children:"Credit"}),cell:({row:s})=>t.jsx("p",{className:"text-sm font-medium",children:s.original.credit}),enableSorting:!1,enableHiding:!1},{accessorKey:"balance",header:()=>t.jsx("p",{children:"Balance"}),cell:({row:s})=>t.jsx("p",{className:"text-sm font-medium",children:s.original.balance}),enableSorting:!1,enableHiding:!1}];function re(s){s.CapacitorUtils.Synapse=new Proxy({},{get(e,a){return new Proxy({},{get(o,r){return(n,h,d)=>{const i=s.Capacitor.Plugins[a];if(i===void 0){d(new Error(`Capacitor plugin ${a} not found`));return}if(typeof i[r]!="function"){d(new Error(`Method ${r} not found in Capacitor plugin ${a}`));return}(async()=>{try{const l=await i[r](n);h(l)}catch(l){d(l)}})()}}})}})}function oe(s){s.CapacitorUtils.Synapse=new Proxy({},{get(e,a){return s.cordova.plugins[a]}})}function ne(s=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!s?re(window):window.cordova!==void 0&&oe(window))}var y;(function(s){s.Documents="DOCUMENTS",s.Data="DATA",s.Library="LIBRARY",s.Cache="CACHE",s.External="EXTERNAL",s.ExternalStorage="EXTERNAL_STORAGE",s.ExternalCache="EXTERNAL_CACHE",s.LibraryNoCloud="LIBRARY_NO_CLOUD",s.Temporary="TEMPORARY"})(y||(y={}));var N;(function(s){s.UTF8="utf8",s.ASCII="ascii",s.UTF16="utf16"})(N||(N={}));const C=E("Filesystem",{web:()=>_(()=>import("./web2.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])).then(s=>new s.FilesystemWeb)});ne();const j=E("Share",{web:()=>_(()=>import("./web3.js"),__vite__mapDeps([24,1,2])).then(s=>new s.ShareWeb)});class ie extends U{constructor(){super(...arguments),this.ERROR_PICK_FILE_CANCELED="pickFiles canceled."}async checkPermissions(){throw this.unimplemented("Not implemented on web.")}async convertHeicToJpeg(e){throw this.unimplemented("Not implemented on web.")}async copyFile(e){throw this.unimplemented("Not implemented on web.")}async pickFiles(e){const a=await this.openFilePicker(e);if(!a)throw new Error(this.ERROR_PICK_FILE_CANCELED);const o={files:[]};for(const r of a){const n={blob:r,modifiedAt:r.lastModified,mimeType:this.getMimeTypeFromUrl(r),name:this.getNameFromUrl(r),path:void 0,size:this.getSizeFromUrl(r)};e!=null&&e.readData&&(n.data=await this.getDataFromFile(r)),o.files.push(n)}return o}async pickDirectory(){throw this.unimplemented("Not implemented on web.")}async pickImages(e){return this.pickFiles(Object.assign({types:["image/*"]},e))}async pickMedia(e){return this.pickFiles(Object.assign({types:["image/*","video/*"]},e))}async pickVideos(e){return this.pickFiles(Object.assign({types:["video/*"]},e))}async requestPermissions(e){throw this.unimplemented("Not implemented on web.")}async openFilePicker(e){var a;const o=((a=e==null?void 0:e.types)===null||a===void 0?void 0:a.join(","))||"",r=(e==null?void 0:e.limit)===void 0?0:e.limit;return new Promise(n=>{let h=!1;const d=document.createElement("input");d.type="file",d.accept=o,d.multiple=r===0,d.addEventListener("change",()=>{h=!0;const i=Array.from(d.files||[]);n(i)},{once:!0}),window.addEventListener("focus",async()=>{await this.wait(1e3),!h&&n(void 0)},{once:!0}),d.click()})}async getDataFromFile(e){return new Promise((a,o)=>{const r=new FileReader;r.readAsDataURL(e),r.onload=()=>{const d=(typeof r.result=="string"?r.result:"").split("base64,")[1]||"";a(d)},r.onerror=n=>{o(n)}})}getNameFromUrl(e){return e.name}getMimeTypeFromUrl(e){return e.type}getSizeFromUrl(e){return e.size}async wait(e){return new Promise(a=>setTimeout(a,e))}}E("FilePicker",{web:()=>new ie});let le=null;try{le=require("@capacitor/browser").Browser}catch(s){console.warn("Browser plugin not available - will use fallback methods:",s)}class L{static getRecommendedDirectory(){return y.ExternalStorage}static async downloadFile(e,a,o="",r={}){var i,l,u;const{showSuccessToast:n=!0,allowShare:h=!0,directory:d=y.ExternalStorage}=r;try{return A.isNativePlatform()?await this.downloadNative(e,a,o,{showSuccessToast:n,allowShare:h,directory:d}):await this.downloadWeb(e,a,n)}catch(c){console.error("Download failed:",c);let m=c.message;throw(i=c.message)!=null&&i.includes("Missing parent directory")?m="Could not create download directory. Please check your storage permissions.":(l=c.message)!=null&&l.includes("Permission denied")?m="Storage permission denied. Please check your app settings.":(u=c.message)!=null&&u.includes("No available space")&&(m="Not enough storage space available."),S.error(`Failed to download ${a}: ${m}`),c}}static async downloadWeb(e,a,o=!0){try{const r=window.URL.createObjectURL(e),n=document.createElement("a");return n.href=r,n.setAttribute("download",a),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(r),o&&S.success(`File downloaded: ${a}`),{success:!0,path:a}}catch(r){throw new Error(`Web download failed: ${r.message}`)}}static async downloadNative(e,a,o,r={}){var i,l;const{showSuccessToast:n=!0,allowShare:h=!0,directory:d=y.ExternalStorage}=r;try{const u=await this.blobToBase64(e),c=u.split(",")[1]||u;let m=d,x;const f=this.isBinaryFile(o)?void 0:N.UTF8;try{const b="SimpliCollect Downloads";try{await C.mkdir({path:b,directory:m,recursive:!0})}catch(g){(i=g.message)!=null&&i.includes("exists")||console.warn("Could not create download directory:",g)}x=await C.writeFile({path:`${b}/${a}`,data:c,directory:m,encoding:f,recursive:!0})}catch(b){if(m===y.ExternalStorage){console.warn("ExternalStorage not available, falling back to Documents directory"),m=y.Documents;try{await C.mkdir({path:"SimpliCollect Downloads",directory:m,recursive:!0})}catch(g){(l=g.message)!=null&&l.includes("exists")||console.warn("Could not create download directory:",g)}x=await C.writeFile({path:`SimpliCollect Downloads/${a}`,data:c,directory:m,encoding:f,recursive:!0})}else throw b}return n&&S.success(`File saved: ${a}`),h&&await this.canShare()?{success:!0,path:x.uri,showDownloadDialog:!0,filename:a,shareCallback:()=>this.shareFile(x.uri,a,o)}:{success:!0,path:x.uri}}catch(u){if(h&&await this.canShare())try{const c=await this.blobToBase64(e);return await j.share({title:"Download File",text:`Download ${a}`,url:c,dialogTitle:"Save or Share File"}),n&&S.success(`File shared: ${a}`),{success:!0,path:"shared",method:"share"}}catch{throw new Error(`Native download and share failed: ${u.message}`)}else throw new Error(`Native download failed: ${u.message}`)}}static blobToBase64(e){return new Promise((a,o)=>{const r=new FileReader;r.onload=()=>a(r.result),r.onerror=o,r.readAsDataURL(e)})}static async canShare(){try{return(await j.canShare()).value}catch{return!1}}static isBinaryFile(e){return["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","application/pdf","image/","video/","audio/","application/zip","application/x-zip-compressed","application/octet-stream"].some(o=>e.toLowerCase().startsWith(o.toLowerCase()))}static async shareFile(e,a,o){await j.share({title:"Share File",text:`Share ${a}`,url:e,dialogTitle:"Share or Save File"})}static async promptForDownloadAction(e,a,o){return new Promise(r=>{r({showDialog:!0,filename:e,onShare:a,onSaveToLocation:o})})}static async promptForShare(e){return new Promise(a=>{const o=window.confirm(`File saved successfully! Would you like to share "${e}" or save it to another location?`);a(o)})}static async downloadExcel(e,a,o={}){const r=a.endsWith(".xlsx")?a:`${a}.xlsx`;return await this.downloadFile(e,r,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",o)}static async downloadPDF(e,a,o={}){const r=a.endsWith(".pdf")?a:`${a}.pdf`;return await this.downloadFile(e,r,"application/pdf",o)}static async downloadCSV(e,a,o={}){const r=a.endsWith(".csv")?a:`${a}.csv`;return await this.downloadFile(e,r,"text/csv",o)}static async downloadFromResponse(e,a,o={}){if(e.status!==200)throw new Error(`Server returned status ${e.status}`);const r=e.headers["content-type"]||"",n=new Blob([e.data],{type:r});return await this.downloadFile(n,a,r,o)}}const be=()=>{const[s,e]=$.useState({isOpen:!1,filename:"",shareCallback:null}),a=async(i,l,u,c)=>{const m=await L.downloadFile(i,l,u,c);return m.showDownloadDialog&&e({isOpen:!0,filename:m.filename,shareCallback:m.shareCallback}),m};return{downloadFile:a,downloadExcel:async(i,l,u)=>await a(i,l,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",u),downloadPDF:async(i,l,u)=>await a(i,l,"application/pdf",u),downloadCSV:async(i,l,u)=>await a(i,l,"text/csv",u),downloadFromResponse:async(i,l,u)=>{const c=await L.downloadFromResponse(i,l,u);return c.showDownloadDialog&&e({isOpen:!0,filename:c.filename,shareCallback:c.shareCallback}),c},downloadDialogState:s,closeDownloadDialog:()=>{e({isOpen:!1,filename:"",shareCallback:null})}}},ve=({isOpen:s,onClose:e,filename:a,onShare:o})=>{const[r,n]=F.useState(!1),h=async()=>{n(!0);try{await o()}catch(i){console.error("Share failed:",i)}finally{n(!1),e()}},d=()=>{var l;if(!a)return t.jsx(v,{className:"h-8 w-8 text-gray-600"});switch((l=a.split(".").pop())==null?void 0:l.toLowerCase()){case"xlsx":case"xls":return t.jsx(v,{className:"h-8 w-8 text-green-600"});case"pdf":return t.jsx(v,{className:"h-8 w-8 text-red-600"});case"csv":return t.jsx(v,{className:"h-8 w-8 text-blue-600"});default:return t.jsx(v,{className:"h-8 w-8 text-gray-600"})}};return t.jsx(X,{open:s,onOpenChange:e,children:t.jsxs(G,{className:"w-[95vw] max-w-[425px] rounded-2xl sm:rounded-xl p-0 gap-0 max-h-[90vh] overflow-hidden",children:[t.jsxs(J,{className:"text-center p-6 pb-4",children:[t.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-green-100 dark:bg-green-900/20",children:t.jsx(te,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),t.jsx(Z,{className:"text-lg font-semibold",children:"File Saved Successfully!"}),t.jsx(ee,{className:"text-sm text-muted-foreground mt-2",children:"Your file has been saved. What would you like to do next?"})]}),t.jsx("div",{className:"px-6 pb-4",children:t.jsxs("div",{className:"flex items-start gap-3 rounded-xl border p-4 bg-muted/50",children:[t.jsx("div",{className:"flex-shrink-0 mt-0.5",children:d()}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm font-medium break-words",children:a||"File"}),t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"File saved to device storage"})]})]})}),t.jsxs(ae,{className:"p-6 pt-2 flex-col gap-3",children:[t.jsx(k,{variant:"default",onClick:h,disabled:r,className:"w-full h-12 rounded-xl text-base font-medium bg-blue-600 hover:bg-blue-700 text-white transition-colors",children:r?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),"Sharing..."]}):t.jsxs(t.Fragment,{children:[t.jsx(se,{className:"mr-2 h-4 w-4"}),"Share File"]})}),t.jsx(k,{onClick:e,variant:"ghost",className:"w-full h-12 rounded-xl text-base font-medium bg-gray-100 hover:bg-gray-200 dark:bg-gray-800 dark:hover:bg-gray-700 transition-colors",disabled:r,children:"Done"})]})]})})};export{ve as D,N as E,fe as M,ye as a,be as u};
